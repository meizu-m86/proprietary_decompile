/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

void sub_2E68();
// int __fastcall _cxa_finalize(void *);
// int __fastcall _cxa_atexit(void (__fastcall *lpfunc)(void *), void *obj, void *lpdso_handle);
// int __fastcall _register_atfork(_DWORD, _DWORD, _DWORD, _DWORD); weak
// char *strncpy(char *dest, const char *src, size_t n);
int __fastcall ProductFeature::Init(ProductFeature *this, const char *a2);
// int pthread_mutex_lock(pthread_mutex_t *mutex);
// int pthread_attr_init(pthread_attr_t *attr);
// int pthread_attr_setdetachstate(pthread_attr_t *attr, int detachstate);
// int pthread_create(pthread_t *newthread, const pthread_attr_t *attr, void *(*start_routine)(void *), void *arg);
// char *strerror(int errnum);
// int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...); weak
// int pthread_cond_wait(pthread_cond_t *cond, pthread_mutex_t *mutex);
// int pthread_mutex_unlock(pthread_mutex_t *mutex);
_QWORD *ril_event_init(void);
// int pthread_cond_broadcast(pthread_cond_t *cond);
// int pipe(int pipedes[2]);
// int fcntl(int fd, int cmd, ...);
int __fastcall ril_event_set(int a1, int fd, char a3, int a4, int a5);
int __fastcall ril_event_add(int);
int ril_event_loop(void);
// int __fastcall _errno(_DWORD); weak
// int kill(__pid_t pid, int sig);
int __fastcall j_RIL_startEventLoop(int, const char *);
// int __fastcall _strlen_chk(_DWORD, _DWORD); weak
// int __fastcall _strlcat_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...); weak
// char *getenv(const char *name);
// int strtol(const char *nptr, char **endptr, int base);
// int listen(int fd, int n);
// void exit(int status);
// int __fastcall record_stream_get_next(_DWORD, _DWORD, _DWORD); weak
// _DWORD android::Parcel::Parcel(android::Parcel *__hidden this); idb
// _DWORD __fastcall android::Parcel::setData(android::Parcel *__hidden this, const unsigned __int8 *, unsigned int); idb
// _DWORD __fastcall android::Parcel::readInt32(android::Parcel *__hidden this, int *); idb
// _DWORD __fastcall android::Parcel::writeInt32(android::Parcel *__hidden this, int); idb
// _DWORD android::Parcel::data(android::Parcel *__hidden this); idb
// _DWORD android::Parcel::dataSize(android::Parcel *__hidden this); idb
// void __fastcall android::Parcel::~Parcel(android::Parcel *__hidden this); idb
// void *calloc(size_t nmemb, size_t size);
const char *__fastcall j_requestToString(int);
// int close(int fd);
int __fastcall ril_event_del(int);
// int __fastcall record_stream_free(_DWORD); weak
// int __fastcall _strncpy_chk2(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int accept(int fd, struct sockaddr *addr, socklen_t *addr_len);
// int __fastcall _recvfrom_chk(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// int atoi(const char *nptr);
int __fastcall j_RIL_onUnsolicitedResponse(int a1, int a2, int a3, int a4);
// unsigned int sleep(unsigned int seconds);
// _DWORD __fastcall operator new[](unsigned int); idb
// void __fastcall _aeabi_memclr(void *, size_t); idb
// int _sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...); weak
// void free(void *ptr);
// _DWORD android::Parcel::dataPosition(android::Parcel *__hidden this); idb
// _DWORD __fastcall android::Parcel::setDataPosition(android::Parcel *__hidden this, unsigned int); idb
// int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// int __fastcall acquire_wake_lock(_DWORD, _DWORD); weak
// int __fastcall release_wake_lock(_DWORD); weak
int __fastcall android::RIL_onExtUnsolicitedResponse(int, int, int, int);
// _DWORD android::elapsedRealtime(android *__hidden this); idb
// _DWORD __fastcall android::Parcel::writeInt64(android::Parcel *__hidden this, __int64); idb
// void __fastcall _aeabi_memcpy(void *, const void *, size_t); idb
int __fastcall ril_timer_add(int **, _DWORD *);
// int getsockopt(int fd, int level, int optname, void *optval, socklen_t *optlen);
// struct passwd *getpwuid(__uid_t uid);
// int strcmp(const char *s1, const char *s2);
// int __fastcall record_stream_new(_DWORD, _DWORD); weak
// int __fastcall property_set(_DWORD, _DWORD); weak
// int __fastcall _read_chk(_DWORD, _DWORD, _DWORD, _DWORD); weak
// _DWORD __fastcall android::Parcel::readString16Inplace(android::Parcel *__hidden this, unsigned int *); idb
// int __fastcall strndup16to8(_DWORD, _DWORD); weak
// int __fastcall strdup8to16(_DWORD, _DWORD); weak
// int __fastcall android::Parcel::writeString16(_DWORD, _DWORD, _DWORD); weak
// int __fastcall property_get(_DWORD, _DWORD, _DWORD); weak
// _DWORD __fastcall android::Parcel::write(android::Parcel *__hidden this, const void *, unsigned int); idb
// _DWORD __fastcall android::Parcel::readInplace(android::Parcel *__hidden this, unsigned int); idb
// _DWORD android::Parcel::readInt32(android::Parcel *__hidden this); idb
// _DWORD __fastcall android::Parcel::appendFrom(android::Parcel *__hidden this, const android::Parcel *, unsigned int, unsigned int); idb
// _DWORD android::Parcel::readString16(android::Parcel *__hidden this); idb
// _DWORD __fastcall android::Parcel::writeString16(android::Parcel *__hidden this, const android::String16 *); idb
// void __fastcall android::String16::~String16(android::String16 *__hidden this); idb
// void __fastcall _aeabi_memclr8(void *, size_t); idb
// void __fastcall _aeabi_memclr4(void *, size_t); idb
// _DWORD __fastcall android::Parcel::read(android::Parcel *__hidden this, void *, unsigned int); idb
int __fastcall j_RIL_onRequestComplete(int, int, int, int);
// int _android_log_print(_DWORD, _DWORD, const char *, ...); weak
// int __fastcall strnlen16to8(_DWORD, _DWORD); weak
// int __fastcall strncpy16to8(_DWORD, _DWORD); weak
// pthread_t pthread_self(void);
// int pthread_equal(pthread_t thread1, pthread_t thread2);
// int pthread_mutex_init(pthread_mutex_t *mutex, const pthread_mutexattr_t *mutexattr);
// int __fastcall _FD_SET_chk(_DWORD, _DWORD, _DWORD); weak
// int gettimeofday(struct timeval *tv, __timezone_ptr_t tz);
// int __fastcall _FD_CLR_chk(_DWORD, _DWORD, _DWORD); weak
// void __fastcall _aeabi_memcpy8(void *, const void *, size_t); idb
// int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout);
// int __fastcall _FD_ISSET_chk(_DWORD, _DWORD, _DWORD); weak
// void __fastcall operator delete(void *); idb
void *__fastcall ProductFeature::GetInstance(ProductFeature *this);
int __fastcall android::nullParcelReleaseFunction(android *this, const unsigned __int8 *a2, unsigned int a3, const unsigned int *a4, unsigned int a5, void *a6);
void __fastcall ProductFeature::~ProductFeature(ProductFeature *__hidden this); // idb
int __fastcall ProductFeature::Function_GetFastDormancyInfo(ProductFeature *this, unsigned __int8 *a2, unsigned __int8 *a3, unsigned __int8 *a4, unsigned __int8 *a5);
int __fastcall ProductFeature::Custom_SupportOnly5Mode(ProductFeature *this);
int __fastcall ProductFeature::Custom_SupportOnlyBasicPreferredNetworkType(ProductFeature *this);
void __fastcall ProductFeature::ProductFeature(ProductFeature *this);
int __fastcall CustomProductFeature::~CustomProductFeature(CustomProductFeature *this);
void __fastcall CustomProductFeature::~CustomProductFeature(CustomProductFeature *this, const unsigned __int8 *a2, unsigned int a3, const unsigned int *a4);
int __fastcall CustomProductFeature::CustomInit(CustomProductFeature *this, const char *a2);
const char *__fastcall CustomProductFeature::GetProductName(CustomProductFeature *this);
// void abort(void);
// int fprintf(FILE *stream, const char *format, ...);
// int __fastcall dladdr(_DWORD, _DWORD); weak
// int __fastcall _gnu_Unwind_Find_exidx(_DWORD, _DWORD); weak
int sub_3420();
int (*__fastcall sub_3440(int (*result)(void)))(void);
int __fastcall sub_346C(void *a1);
int __fastcall sub_34B8(int a1, int a2, int a3);
char *__fastcall RIL_setRilSocketName(const char *a1);
_DWORD __fastcall android::nullParcelReleaseFunction(android *__hidden this, const unsigned __int8 *, unsigned int, const unsigned int *, unsigned int, void *); // idb
int __fastcall RIL_startEventLoop(int a1, const char *a2);
int sub_35F0();
__int64 *__fastcall RIL_setcallbacks(__int64 *a1);
int __fastcall RIL_register(int *a1);
int __fastcall sub_3B04(int a1, int a2, int *a3);
int __fastcall sub_3DA0(int a1, int a2);
int __fastcall sub_3F20(int a1);
int sub_46B8(); // weak
int __fastcall RIL_onRequestAck(int a1);
int __fastcall sub_4BC4(int a1, int a2);
int __fastcall RIL_onRequestComplete(int a1, int a2, int a3, int a4);
int __fastcall blockingWrite_helper(int a1, void *a2, unsigned int a3);
int sub_4EE8();
int __fastcall RIL_onUnsolicitedResponse(int a1, int a2, int a3, int a4);
int __fastcall android::RIL_onExtUnsolicitedResponse(int a1, int a2, int a3, int a4);
int __fastcall RIL_requestTimedCallback_0(int a1, int a2, __int64 *a3);
const char *__fastcall rilSocketIdToString(int a1);
const char *__fastcall requestToString(int a1);
int sub_6310();
const char *__fastcall failCauseToString(int a1);
const char *__fastcall radioStateToString(unsigned int a1);
const char *__fastcall callStateToString(unsigned int a1);
int __fastcall rilEventAddWakeup_helper(int a1);
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3);
int sub_69FC();
int __fastcall sub_6A70(int a1);
size_t __fastcall sub_6AC0(android::Parcel *this, __int64 *a2);
int sub_6BA8();
int __fastcall sub_6BAC(int a1, int a2);
int __fastcall sub_6BD4(android::Parcel *this, int *a2, unsigned int a3);
int __fastcall sub_6C44(int a1, int a2);
unsigned int __fastcall sub_6C50(android::Parcel *this, __int64 *a2);
int __fastcall sub_6DA4(android::Parcel *this, int *a2, unsigned int a3);
int __fastcall sub_6E30(android::Parcel *this, int *a2, int a3);
unsigned int __fastcall sub_6F08(android::Parcel *this, __int64 *a2);
unsigned int __fastcall sub_71A8(android::Parcel *this, __int64 *a2);
int __fastcall sub_72AC(int a1, int a2);
int __fastcall sub_72F8(android::Parcel *this, int *a2, unsigned int a3);
int __fastcall sub_7410(android::Parcel *this, int **a2, unsigned int a3);
unsigned int __fastcall sub_7530(android::Parcel *this, __int64 *a2);
int __fastcall sub_768C(android::Parcel *this, int *a2, int a3);
int __fastcall sub_76F4(android::Parcel *a1, int *a2, unsigned int a3);
unsigned int __fastcall sub_7834(android::Parcel *a1, int a2);
int __fastcall sub_78A0(android::Parcel *this, int *a2, int a3);
unsigned int __fastcall sub_7904(android::Parcel *this, __int64 *a2);
int __fastcall sub_79D8(android::Parcel *this, int *a2, unsigned int a3);
unsigned int __fastcall sub_7A14(android::Parcel *this, __int64 *a2);
int __fastcall sub_7BAC(android::Parcel *this, int *a2, int a3);
unsigned int __fastcall sub_7C10(android::Parcel *this, __int64 *a2);
int __fastcall sub_7D2C(android::Parcel *this, int **a2, unsigned int a3);
int __fastcall sub_7DC8(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_80A0(android::Parcel *this, __int64 *a2);
int __fastcall sub_8130(android::Parcel *this, const void *a2, unsigned int a3);
unsigned int __fastcall sub_8180(android::Parcel *this, __int64 *a2);
int __fastcall sub_8254(android::Parcel *this, int **a2, unsigned int a3);
int __fastcall sub_82D0(android::Parcel *a1, int *a2);
int __fastcall sub_8358(android::Parcel *this, int *a2);
int __fastcall sub_83F4(android::Parcel *a1, int **a2, unsigned int a3);
int __fastcall sub_844C(android::Parcel *this, __int64 *a2);
int __fastcall sub_85A8(android::Parcel *a1, int **a2, unsigned int a3);
int __fastcall sub_85EC(android::Parcel *this, __int64 *a2);
int __fastcall sub_8728(android::Parcel *a1, int *a2);
int __fastcall sub_8910(int a1, int a2);
int __fastcall sub_89C0(int a1, int a2);
int __fastcall sub_8A70(android::Parcel *this, int a2, unsigned int a3);
unsigned int __fastcall sub_8D24(android::Parcel *this, __int64 *a2);
int __fastcall sub_8E78(android::Parcel *this, __int64 *a2);
unsigned int __fastcall sub_90FC(android::Parcel *this, __int64 *a2);
int __fastcall sub_9218(android::Parcel *a1, int *a2);
unsigned int __fastcall sub_929C(android::Parcel *this, __int64 *a2);
int __fastcall sub_935C(android::Parcel *this, __int64 *a2);
int __fastcall sub_9420(android::Parcel *this, int a2, unsigned int a3);
unsigned int __fastcall sub_94FC(android::Parcel *this, __int64 *a2);
int __fastcall sub_95E8(android::Parcel *this, int a2, int a3);
unsigned int __fastcall sub_9630(android::Parcel *this, __int64 *a2);
int __fastcall sub_9808(android::Parcel *this, int *a2, int a3);
int __fastcall sub_9884(android::Parcel *a1, __int64 *a2);
int __fastcall sub_997C(android::Parcel *this, void *a2, int a3);
int __fastcall sub_99DC(android::Parcel *this, int *a2, int a3);
int __fastcall sub_9A48(android::Parcel *this, int *a2, int a3);
int __fastcall sub_9AC0(android::Parcel *a1, int *a2);
int __fastcall sub_9AFC(android::Parcel *a1, int a2, int a3);
int __fastcall sub_9B5E(android::Parcel *a1, int *a2);
int __fastcall sub_9B9E(android::Parcel *this, _DWORD *a2);
int __fastcall sub_9C0C(android::Parcel *this, int a2, unsigned int a3);
int __fastcall sub_9CF0(android::Parcel *a1, int *a2);
int __fastcall sub_9E78(android::Parcel *this, int a2, unsigned int a3);
void __fastcall sub_A090(int a1, void **a2);
int __fastcall sub_A0B8(int a1, int a2, int a3, int a4);
int sub_A19C();
int __fastcall sub_A1E0(void *a1, unsigned int a2, int a3);
int __fastcall sub_A2B0(int a1, int a2, unsigned int a3);
int __fastcall sub_A354(android::Parcel *this, int *a2, int a3);
int __fastcall sub_A3C8(android::Parcel *this, int *a2, unsigned int a3);
int __fastcall sub_A4B4(android::Parcel *a1, unsigned __int8 *a2, int a3);
int __fastcall sub_A4F4(android::Parcel *a1, int *a2, int a3);
int __fastcall sub_A654(android::Parcel *a1, int a2, unsigned int a3);
int __fastcall sub_A784(android::Parcel *this, unsigned __int8 *a2, int a3);
int __fastcall sub_AA44(android::Parcel *a1, int *a2, int a3);
int __fastcall sub_AC04(android::Parcel *a1, int *a2);
int __fastcall sub_AC24(android::Parcel *a1, unsigned __int8 *a2);
int __fastcall sub_AC4C(android::Parcel *this, int *a2, int a3);
int __fastcall sub_ACC0(android::Parcel *this, int *a2);
void __fastcall sub_AD0C(int a1, int a2, _DWORD *a3);
_QWORD *ril_event_init(void);
int __fastcall ril_event_set(int a1, int fd, char a3, int a4, int a5);
int __fastcall ril_event_add(int a1);
int __fastcall ril_timer_add(int **a1, _DWORD *a2);
int __fastcall ril_event_del(int a1);
int __fastcall sub_AF50(int a1, int a2);
int ril_event_loop(void);
void __fastcall ProductFeature::ProductFeature(ProductFeature *this);
void __fastcall ProductFeature::~ProductFeature(ProductFeature *__hidden this); // idb
int __fastcall ProductFeature::Init(ProductFeature *this, const char *a2);
int __fastcall ProductFeature::Custom_SupportOnly5Mode(ProductFeature *this);
int __fastcall ProductFeature::Custom_SupportOnlyBasicPreferredNetworkType(ProductFeature *this);
int __fastcall ProductFeature::Function_SendDebugTraceOffAtBootup(ProductFeature *this);
int __fastcall ProductFeature::Function_GetFastDormancyInfo(ProductFeature *this, unsigned __int8 *a2, unsigned __int8 *a3, unsigned __int8 *a4, unsigned __int8 *a5);
int __fastcall ProductFeature::Function_RilResetByCrashExitInUserMode(ProductFeature *this);
int __fastcall ProductFeature::Function_DeviceBasedCwInCs(ProductFeature *this);
const char *sub_B300();
const char *sub_B30C();
void *__fastcall ProductFeature::GetInstance(ProductFeature *this);
void __fastcall CustomProductFeature::CustomProductFeature(CustomProductFeature *this);
_DWORD __fastcall CustomProductFeature::~CustomProductFeature(CustomProductFeature *__hidden this); // idb
void __fastcall CustomProductFeature::~CustomProductFeature(CustomProductFeature *this, const unsigned __int8 *a2, unsigned int a3, const unsigned int *a4);
int __fastcall CustomProductFeature::CustomInit(CustomProductFeature *this, const char *a2);
const char *__fastcall CustomProductFeature::GetProductName(CustomProductFeature *this);
int __fastcall CustomProductFeature::Custom_SaveImeiToProperty(CustomProductFeature *this);
int __fastcall CustomProductFeature::Custom_ReturnCurrentPlmn(CustomProductFeature *this);
int __fastcall CustomProductFeature::ModuleAudio_VolumeStartFrom1(CustomProductFeature *this);
const char *sub_B424();
const char *sub_B430();
unsigned int *__fastcall sub_B43C(unsigned int *result, int *a2, int *a3);
int __fastcall sub_B490(int a1, int a2, unsigned int a3, unsigned int a4);
int __fastcall sub_B7D4(int a1, int a2, unsigned int a3, int a4, int *a5);
int __fastcall sub_B870(int a1, int a2, unsigned int a3, int a4);
int __fastcall sub_B9AC(int a1, int a2, int a3);
int __fastcall sub_B9B4(int a1, int a2);
int __fastcall sub_BA10(int a1, int a2, int a3);
int __fastcall sub_BA18(int a1, int a2, int a3);
int __fastcall sub_BA20(int *a1, int a2, int a3, int a4);
int __fastcall sub_BACC(const void *a1, int *a2, char a3);
void __fastcall __noreturn sub_BBB8(int *a1, int a2, int a3, int a4);
void __fastcall __noreturn sub_BBEC(const char *a1, int a2, const char *a3);
int __fastcall sub_BC1C(int a1);
int __fastcall sub_BC58(int a1);
int __fastcall sub_BCA0(int a1, int a2);
int __fastcall sub_BCB4(_DWORD *a1, int a2, int a3, int a4, int a5);
_QWORD *__fastcall sub_BCCC(_QWORD *result);
_QWORD *__fastcall sub_BCD4(_QWORD *result);
_QWORD *__fastcall sub_BCDC(_QWORD *result);
void sub_BCE4();
void sub_BD28();
int __fastcall sub_BD3C(int a1, const void *a2);
int __fastcall sub_BD80(int a1, int a2, _DWORD *a3);
int __fastcall sub_BDAE(int a1, int a2, int a3);
int __fastcall sub_BDF2(int a1, int a2, _QWORD *a3);
int __fastcall sub_BE22(int a1, int a2, int a3, int a4);
int __fastcall sub_BE5A(int a1);
int __fastcall sub_BE60(int a1, int a2);
int __fastcall sub_BE7E(int a1);
int __fastcall sub_BE90(int a1);
int __fastcall sub_BE96(int a1, int a2);
int __fastcall sub_BEB8(int a1, int a2);
int __fastcall sub_BF44(int result, int a2, int a3);
int __fastcall sub_BFD0(int a1, int a2);
__int64 __fastcall sub_BFF4(int a1, int a2);
int __fastcall sub_C098(int a1, int a2, int a3, int a4);
int __fastcall sub_C164(_DWORD *a1);
_DWORD *__fastcall sub_C1B4(int a1, _DWORD *a2);
int __fastcall sub_C1CC(int a1);
int __fastcall sub_C1E2(int a1);
int __fastcall sub_C1E8(int a1, int a2, int a3, _DWORD *a4);
int __fastcall sub_C258(int *a1, int a2);
int __fastcall sub_C2CE(int result);
void __fastcall __noreturn sub_C2D8(const char *a1, const char *a2, int a3, const char *a4);
int __fastcall sub_C304(int a1);
_DWORD *__fastcall sub_C358(int a1);
int __fastcall sub_C3B0(int *a1, int a2, _DWORD *a3);
_DWORD *__fastcall sub_C554(_DWORD *a1, int a2, int a3, _DWORD *a4, int a5, int a6, int a7, _DWORD *a8);
int __fastcall sub_C9E4(int a1);
void sub_C9F8();
void sub_CA00();
void sub_CA08();
_DWORD *__fastcall sub_CA10(int *a1);
_DWORD *__fastcall sub_CA54(int *a1);
char *__fastcall j_strncpy(char *dest, const char *src, size_t n);
int j_acquire_wake_lock();
int __fastcall j_pthread_mutex_unlock(pthread_mutex_t *mutex);
int __fastcall j_android::RIL_onExtUnsolicitedResponse(int a1, int a2, int a3, int a4);
int j_release_wake_lock();
int __fastcall j_j_RIL_onRequestComplete(int a1, int a2, int a3, int a4);
int __fastcall android::Parcel::writeInt32(android::Parcel *this, int a2);
void __fastcall j_free(void *ptr);
void __fastcall operator delete(void *); // idb
int __fastcall j_android::nullParcelReleaseFunction(android *this, const unsigned __int8 *a2, unsigned int a3, const unsigned int *a4, unsigned int a5, void *a6);
int __fastcall j___cxa_atexit(void (__fastcall *lpfunc)(void *), void *obj, void *lpdso_handle);
int __fastcall sub_CB18(int a1);
_DWORD *__fastcall sub_CB28(int *a1);

//-------------------------------------------------------------------------
// Data declarations

char byte_4 = '\x01'; // weak
Elf32_Sym stru_320 = { 1459u, 0u, 0u, 18u, 0u, 0u }; // weak
Elf32_Sym stru_3E0 = { 1686u, 0u, 0u, 18u, 0u, 0u }; // weak
Elf32_Sym stru_3F0 = { 1701u, 0u, 0u, 18u, 0u, 0u }; // weak
void *off_4560 = (void *)0x10000; // weak
void *off_4570 = (void *)0x10000; // weak
_UNKNOWN loc_571C; // weak
__int64 qword_11214 = 858993459200000LL; // weak
_UNKNOWN unk_1121C; // weak
_DWORD dword_11230[8] = { 0, 0, 0, 0, 0, 0, 1, 1 }; // weak
_DWORD dword_11250[8] = { 3, 3, 3, 6, 6, 6, 6, 6 }; // weak
_DWORD dword_11270[8] = { -1, 3, 4, -1, 6, 7, -1, -1 }; // weak
void *off_12920 = (void *)0x3E8; // weak
_UNKNOWN unk_12B48; // weak
char *off_12BB0[11] =
{
  "RADIO_OFF",
  "RADIO_UNAVAILABLE",
  "RADIO_SIM_NOT_READY",
  "RADIO_SIM_LOCKED_OR_ABSENT",
  "RADIO_SIM_READY",
  "RADIO_RUIM_NOT_READY",
  "RADIO_RUIM_READY",
  "RADIO_RUIM_LOCKED_OR_ABSENT",
  "RADIO_NV_NOT_READY",
  "RADIO_NV_READY",
  "RADIO_ON"
}; // weak
char *off_12BE0[6] = { "ACTIVE", "HOLDING", "DIALING", "ALERTING", "INCOMING", "WAITING" }; // weak
void *off_12C00 = (void *)0x3515; // weak
void *off_12C2C = (void *)0xB33D; // weak
void *off_12C58 = (void *)0x3515; // weak
void *off_13000 = &off_13000; // weak
char rild[5] = "rild"; // weak
int android::voiceRadioTech = -1; // weak
int android::cdmaSubscriptionSource = -1; // weak
int android::simRuimStatus = -1; // weak
int dword_13018 = -1; // weak
int dword_1301C = -1; // weak
int dword_13020 = -1; // weak
_UNKNOWN unk_13024; // weak
_UNKNOWN unk_13180; // weak
int android::s_callbacks; // weak
int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD); // weak
int (__fastcall *dword_13800)(_DWORD); // weak
_UNKNOWN unk_13808; // weak
int (*dword_1380C)(void); // weak
int android::s_wakelock_count; // weak
char byte_13814; // weak
_UNKNOWN unk_13818; // weak
int dword_1381C; // weak
_UNKNOWN unk_13820; // weak
char byte_13824; // weak
int dword_13828; // weak
char algn_1382C[4]; // weak
int dword_13830; // weak
int dword_13834; // weak
int dword_13838; // weak
int dword_1383C; // weak
_UNKNOWN unk_13840; // weak
_UNKNOWN unk_13844; // weak
int dword_13848; // weak
_UNKNOWN unk_1384C; // weak
_UNKNOWN unk_13870; // weak
_DWORD dword_13894[2]; // weak
int dword_1389C; // weak
int dword_138A4; // weak
_UNKNOWN unk_138A8; // weak
_UNKNOWN unk_138AC; // weak
_UNKNOWN unk_138B0; // weak
_UNKNOWN unk_138B4; // weak
_UNKNOWN unk_138B8; // weak
_UNKNOWN unk_138DC; // weak
_UNKNOWN unk_13900; // weak
pthread_t dword_13924; // weak
int dword_13928; // weak
int dword_1392C; // weak
int dword_13930; // weak
int dword_13934; // weak
int dword_13938; // weak
_UNKNOWN unk_1393C; // weak
_UNKNOWN unk_13960; // weak
_UNKNOWN unk_13964; // weak
_UNKNOWN unk_13968; // weak
int dword_1396C; // weak
_UNKNOWN unk_13970; // weak
_UNKNOWN unk_13974; // weak
_UNKNOWN unk_13978; // weak
_UNKNOWN unk_13980; // weak
_UNKNOWN unk_13988; // weak
int dword_13A08; // weak
char algn_13A0C[4]; // weak
int dword_13A10; // weak
_UNKNOWN unk_13A18; // weak
_UNKNOWN unk_13A20; // weak
int dword_13A28; // weak
int dword_13A30; // weak
int dword_13A34; // weak
int dword_13A38; // weak
_UNKNOWN unk_13A40; // weak
_UNKNOWN unk_13A48; // weak
int dword_13A50; // weak
_DWORD dword_13A58[2]; // weak
_UNKNOWN unk_13A60; // weak
_QWORD qword_13A68[2]; // weak
int dword_13A78; // weak
_UNKNOWN instance; // weak
_UNKNOWN unk_13A80; // weak
// extern _UNKNOWN _stack_chk_guard; weak
// extern struct _IO_FILE *stderr;


//----- (00002E68) --------------------------------------------------------
void sub_2E68()
{
  JUMPOUT(0);
}
// 2E74: control flows out of bounds to 0

//----- (00002EAC) --------------------------------------------------------
// attributes: thunk
int __fastcall ProductFeature::Init(ProductFeature *this, const char *a2)
{
  return _ZN14ProductFeature4InitEPKc(this, a2);
}

//----- (00002F24) --------------------------------------------------------
// attributes: thunk
_QWORD *ril_event_init(void)
{
  return _Z14ril_event_initv();
}

//----- (00002F54) --------------------------------------------------------
// attributes: thunk
int __fastcall ril_event_set(int a1, int fd, char a3, int a4, int a5)
{
  return _Z13ril_event_setP9ril_eventibPFvisPvES1_(a1, fd, a3, a4, a5);
}

//----- (00002F60) --------------------------------------------------------
// attributes: thunk
int __fastcall ril_event_add(int a1)
{
  return _Z13ril_event_addP9ril_event(a1);
}

//----- (00002F6C) --------------------------------------------------------
// attributes: thunk
int ril_event_loop(void)
{
  return _Z14ril_event_loopv();
}

//----- (00002F90) --------------------------------------------------------
// attributes: thunk
int __fastcall j_RIL_startEventLoop(int a1, const char *a2)
{
  return RIL_startEventLoop(a1, a2);
}

//----- (0000305C) --------------------------------------------------------
// attributes: thunk
const char *__fastcall j_requestToString(int a1)
{
  return requestToString(a1);
}

//----- (00003074) --------------------------------------------------------
// attributes: thunk
int __fastcall ril_event_del(int a1)
{
  return _Z13ril_event_delP9ril_event(a1);
}

//----- (000030BC) --------------------------------------------------------
// attributes: thunk
int __fastcall j_RIL_onUnsolicitedResponse(int a1, int a2, int a3, int a4)
{
  return RIL_onUnsolicitedResponse(a1, a2, a3, a4);
}

//----- (00003140) --------------------------------------------------------
// attributes: thunk
int __fastcall android::RIL_onExtUnsolicitedResponse(int a1, int a2, int a3, int a4)
{
  return _ZN7android28RIL_onExtUnsolicitedResponseEiPKvj13RIL_SOCKET_ID(a1, a2, a3, a4);
}

//----- (00003170) --------------------------------------------------------
// attributes: thunk
int __fastcall ril_timer_add(int **a1, _DWORD *a2)
{
  return _Z13ril_timer_addP9ril_eventP7timeval(a1, a2);
}

//----- (00003278) --------------------------------------------------------
// attributes: thunk
int __fastcall j_RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  return RIL_onRequestComplete(a1, a2, a3, a4);
}

//----- (00003320) --------------------------------------------------------
// attributes: thunk
void *__fastcall ProductFeature::GetInstance(ProductFeature *this)
{
  return _ZN14ProductFeature11GetInstanceEv(this);
}

//----- (0000332C) --------------------------------------------------------
// attributes: thunk
int __fastcall android::nullParcelReleaseFunction(
        android *this,
        const unsigned __int8 *a2,
        unsigned int a3,
        const unsigned int *a4,
        unsigned int a5,
        void *a6)
{
  return _ZN7android25nullParcelReleaseFunctionEPKhjPKjjPv(this, a2, a3, a4, a5, a6);
}

//----- (00003338) --------------------------------------------------------
// attributes: thunk
void __fastcall ProductFeature::~ProductFeature(ProductFeature *this)
{
  _ZN14ProductFeatureD0Ev(this);
}

//----- (00003350) --------------------------------------------------------
// attributes: thunk
int __fastcall ProductFeature::Function_GetFastDormancyInfo(
        ProductFeature *this,
        unsigned __int8 *a2,
        unsigned __int8 *a3,
        unsigned __int8 *a4,
        unsigned __int8 *a5)
{
  return _ZN14ProductFeature28Function_GetFastDormancyInfoERhS0_S0_S0_(this, a2, a3, a4, a5);
}

//----- (0000335C) --------------------------------------------------------
// attributes: thunk
int __fastcall ProductFeature::Custom_SupportOnly5Mode(ProductFeature *this)
{
  return _ZN14ProductFeature23Custom_SupportOnly5ModeEv(this);
}

//----- (00003368) --------------------------------------------------------
// attributes: thunk
int __fastcall ProductFeature::Custom_SupportOnlyBasicPreferredNetworkType(ProductFeature *this)
{
  return _ZN14ProductFeature43Custom_SupportOnlyBasicPreferredNetworkTypeEv(this);
}

//----- (00003374) --------------------------------------------------------
// attributes: thunk
void __fastcall ProductFeature::ProductFeature(ProductFeature *this)
{
  _ZN14ProductFeatureC2Ev(this);
}

//----- (00003380) --------------------------------------------------------
// attributes: thunk
int __fastcall CustomProductFeature::~CustomProductFeature(CustomProductFeature *this)
{
  return _ZN20CustomProductFeatureD2Ev(this);
}

//----- (0000338C) --------------------------------------------------------
// attributes: thunk
void __fastcall CustomProductFeature::~CustomProductFeature(
        CustomProductFeature *this,
        const unsigned __int8 *a2,
        unsigned int a3,
        const unsigned int *a4)
{
  _ZN20CustomProductFeatureD0Ev(this, a2, a3, a4);
}

//----- (00003398) --------------------------------------------------------
// attributes: thunk
int __fastcall CustomProductFeature::CustomInit(CustomProductFeature *this, const char *a2)
{
  return _ZN20CustomProductFeature10CustomInitEPKc(this, a2);
}

//----- (000033A4) --------------------------------------------------------
// attributes: thunk
const char *__fastcall CustomProductFeature::GetProductName(CustomProductFeature *this)
{
  return _ZN20CustomProductFeature14GetProductNameEv(this);
}

//----- (00003420) --------------------------------------------------------
int sub_3420()
{
  return _cxa_finalize(&off_13000);
}
// 13000: using guessed type void *off_13000;

//----- (00003440) --------------------------------------------------------
int (*__fastcall sub_3440(int (*result)(void)))(void)
{
  if ( result )
    return (int (*)(void))result();
  return result;
}

//----- (0000346C) --------------------------------------------------------
int __fastcall sub_346C(void *a1)
{
  return _cxa_atexit((void (__fastcall *)(void *))sub_3440, a1, &off_13000);
}
// 13000: using guessed type void *off_13000;

//----- (000034B8) --------------------------------------------------------
int __fastcall sub_34B8(int a1, int a2, int a3)
{
  return _register_atfork(a1, a2, a3, &off_13000);
}
// 2E94: using guessed type int __fastcall _register_atfork(_DWORD, _DWORD, _DWORD, _DWORD);
// 13000: using guessed type void *off_13000;

//----- (00003500) --------------------------------------------------------
char *__fastcall RIL_setRilSocketName(const char *a1)
{
  return j_strncpy(rild, a1, 6u);
}

//----- (00003518) --------------------------------------------------------
int __fastcall RIL_startEventLoop(int a1, const char *a2)
{
  int v2; // r0
  char *v3; // r0
  pthread_attr_t attr; // [sp+4h] [bp-2Ch] BYREF

  ProductFeature::Init((ProductFeature *)"libril", a2);
  byte_13814 = 0;
  pthread_mutex_lock((pthread_mutex_t *)&unk_13818);
  pthread_attr_init(&attr);
  pthread_attr_setdetachstate(&attr, 1);
  v2 = pthread_create((pthread_t *)&dword_1381C, &attr, (void *(*)(void *))sub_35F0, 0);
  if ( v2 )
  {
    v3 = strerror(v2);
    _android_log_buf_print(1, 6, "RILC", "Failed to create dispatch thread: %s", v3);
  }
  else if ( !byte_13814 )
  {
    do
      pthread_cond_wait((pthread_cond_t *)&unk_13820, (pthread_mutex_t *)&unk_13818);
    while ( byte_13814 != 1 );
  }
  pthread_mutex_unlock((pthread_mutex_t *)&unk_13818);
  return _stack_chk_guard - *(&attr.__align + 6);
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 13814: using guessed type char byte_13814;
// 1381C: using guessed type int dword_1381C;

//----- (000035F0) --------------------------------------------------------
int sub_35F0()
{
  int v0; // r0
  _DWORD *v1; // r0
  _DWORD *v2; // r0
  int pipedes[2]; // [sp+4h] [bp-14h] BYREF

  ril_event_init();
  pthread_mutex_lock((pthread_mutex_t *)&unk_13818);
  byte_13814 = 1;
  pthread_cond_broadcast((pthread_cond_t *)&unk_13820);
  pthread_mutex_unlock((pthread_mutex_t *)&unk_13818);
  if ( pipe(pipedes) <= -1 )
  {
    v2 = (_DWORD *)((int (*)(void))_errno)();
    _android_log_buf_print(1, 6, "RILC", "Error in pipe() errno:%d", *v2);
  }
  else
  {
    dword_13938 = pipedes[1];
    dword_13934 = pipedes[0];
    fcntl(pipedes[0], 4, 2048);
    ril_event_set((int)&unk_1393C, dword_13934, 1, (int)sub_69FC, 0);
    ril_event_add((int)&unk_1393C);
    sub_A19C();
    v0 = ril_event_loop();
    v1 = (_DWORD *)_errno(v0);
    _android_log_buf_print(1, 6, "RILC", "error in event_loop_base errno:%d", *v1);
    kill(0, 9);
  }
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int __fastcall _errno(_DWORD);
// 13814: using guessed type char byte_13814;
// 13934: using guessed type int dword_13934;
// 13938: using guessed type int dword_13938;

//----- (000036F4) --------------------------------------------------------
__int64 *__fastcall RIL_setcallbacks(__int64 *a1)
{
  __int64 *result; // r0
  __int64 v2; // d16
  __int64 v3; // d17
  __int64 v4; // d18

  v2 = *a1;
  v3 = a1[1];
  result = a1 + 2;
  v4 = *result;
  *(_QWORD *)&android::s_callbacks = v2;
  *(_QWORD *)&dword_13800 = v3;
  unk_13808 = v4;
  return result;
}
// 137F8: using guessed type int android::s_callbacks;
// 13800: using guessed type int dword_13800;

//----- (00003710) --------------------------------------------------------
int __fastcall RIL_register(int *a1)
{
  int v2; // r0
  __int64 v3; // d17
  __int64 v4; // r2
  __int64 v5; // d18
  char *v6; // r5
  int *v7; // r4
  int v8; // r0
  int v9; // r0
  int v10; // r5
  char *v11; // r0
  int v12; // r5
  int v13; // r0
  int v14; // r0
  char *v15; // r0
  int v17; // r5
  char *v18; // [sp+4h] [bp-7Ch]
  char *v19; // [sp+4h] [bp-7Ch]
  double v20; // [sp+8h] [bp-78h] BYREF
  int v21; // [sp+10h] [bp-70h]
  char v22[16]; // [sp+18h] [bp-68h] BYREF
  pthread_attr_t attr; // [sp+28h] [bp-58h] BYREF
  int v24; // [sp+68h] [bp-18h]

  if ( !a1 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register: RIL_RadioFunctions * null");
    return _stack_chk_guard - v24;
  }
  v2 = *a1;
  if ( *a1 <= 5 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register: version %d is to old, min version is %d", *a1, 6);
    return _stack_chk_guard - v24;
  }
  if ( v2 >= 13 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register: version %d is too new, max version is %d", *a1, 12);
    return _stack_chk_guard - v24;
  }
  _android_log_buf_print(1, 6, "RILC", "RIL_register: RIL version %d", *a1);
  if ( byte_13824 == 1 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_register has been called more than once. Subsequent call ignored");
    return _stack_chk_guard - v24;
  }
  v3 = *((_QWORD *)a1 + 1);
  LODWORD(v4) = -1;
  HIDWORD(v4) = "radio";
  v5 = *((_QWORD *)a1 + 2);
  *(_QWORD *)&android::s_callbacks = *(_QWORD *)a1;
  *(_QWORD *)&dword_13800 = v3;
  unk_13808 = v5;
  dword_13828 = 0;
  *(_DWORD *)algn_1382C = -1;
  dword_13830 = -1;
  dword_13834 = (int)"radio";
  dword_13838 = (int)&unk_1384C;
  dword_1383C = (int)&unk_13870;
  unk_13840 = sub_3B04;
  unk_13844 = 0;
  dword_13848 = 0;
  dword_13894[0] = 1;
  dword_13894[1] = -1;
  *(_QWORD *)&dword_1389C = v4;
  dword_138A4 = (int)&unk_138B8;
  unk_138A8 = &unk_138DC;
  unk_138AC = sub_3B04;
  unk_138B0 = 0;
  unk_138B4 = 0;
  byte_13824 = 1;
  if ( !byte_13814 )
    j_RIL_startEventLoop((unsigned __int8)byte_13814, 0);
  sub_3DA0(0, (int)&dword_13828);
  sub_3DA0(1, (int)dword_13894);
  v22[11] = 0;
  strcpy(v22, "rild-debug");
  if ( (unsigned int)_strlen_chk(rild, 6) >= 4 )
    _strlcat_chk(v22, &rild[4], 12, 12);
  _snprintf_chk(&attr, 64, 0, 64, "ANDROID_SOCKET_%s", v22);
  v6 = getenv(attr.__size);
  v7 = (int *)_errno(v6);
  if ( !v6 || (*v7 = 0, v8 = strtol(v6, 0, 10), *v7) )
  {
    dword_13018 = -1;
    goto LABEL_27;
  }
  dword_13018 = v8;
  if ( v8 <= -1 )
  {
LABEL_27:
    _android_log_buf_print(1, 6, "RILC", "Failed to get socket : %s errno:%d", v22, *v7);
    goto LABEL_30;
  }
  v9 = listen(v8, 4);
  v10 = dword_13018;
  if ( v9 <= -1 )
  {
    v18 = strerror(*v7);
    _android_log_buf_print(1, 6, "RILC", "Failed to listen on ril debug socket '%d': %s", v10, v18);
    goto LABEL_30;
  }
  ril_event_set((int)&unk_13900, dword_13018, 1, (int)sub_3F20, 0);
  ril_event_add((int)&unk_13900);
  sub_A19C();
  v21 = 109;
  v20 = *(double *)"rild-vsim";
  _snprintf_chk(&attr, 64, 0, 64, "ANDROID_SOCKET_%s", (const char *)&v20);
  v11 = getenv(attr.__size);
  v12 = -1;
  if ( v11 )
  {
    *v7 = 0;
    v13 = strtol(v11, 0, 10);
    if ( !*v7 )
      v12 = v13;
  }
  dword_1301C = v12;
  _android_log_buf_print(1, 3, "RILC", "create vsim socket, fd = %d", v12);
  if ( dword_1301C <= -1 )
  {
    _android_log_buf_print(1, 6, "RILC", "Failed to get socket : %s errno:%d", &v20, *v7);
    return _stack_chk_guard - v24;
  }
  if ( listen(dword_1301C, 4) <= -1 )
  {
    v17 = dword_1301C;
    v19 = strerror(*v7);
    _android_log_buf_print(1, 6, "RILC", "Failed to listen on ril VSIM socket '%d': %s", v17, v19);
LABEL_30:
    exit(-1);
  }
  pthread_attr_init(&attr);
  pthread_attr_setdetachstate(&attr, 1);
  v14 = pthread_create(&dword_13924, &attr, (void *(*)(void *))sub_46B8, 0);
  if ( v14 )
  {
    v15 = strerror(v14);
    _android_log_buf_print(1, 6, "RILC", "Failed to create dispatch thread: %s", v15);
  }
  return _stack_chk_guard - v24;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int __fastcall _errno(_DWORD);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 2FA8: using guessed type int __fastcall _strlcat_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 2FB4: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);
// 3B04: using guessed type int sub_3B04();
// 3F20: using guessed type int sub_3F20();
// 46B8: using guessed type int sub_46B8();
// 13018: using guessed type int dword_13018;
// 1301C: using guessed type int dword_1301C;
// 137F8: using guessed type int android::s_callbacks;
// 13800: using guessed type int dword_13800;
// 13814: using guessed type char byte_13814;
// 13824: using guessed type char byte_13824;
// 13828: using guessed type int dword_13828;
// 13830: using guessed type int dword_13830;
// 13834: using guessed type int dword_13834;
// 13838: using guessed type int dword_13838;
// 1383C: using guessed type int dword_1383C;
// 13848: using guessed type int dword_13848;
// 13894: using guessed type _DWORD dword_13894[2];
// 1389C: using guessed type int dword_1389C;
// 138A4: using guessed type int dword_138A4;
// 13924: using guessed type pthread_t dword_13924;

//----- (00003B04) --------------------------------------------------------
int __fastcall sub_3B04(int a1, int a2, int *a3)
{
  int v3; // r6
  int next; // r0
  const unsigned __int8 *v5; // r9
  int v6; // r2
  _BOOL4 v7; // r1
  int v8; // r0
  char *v9; // r1
  int v10; // r0
  unsigned int v11; // r4
  int v12; // r11
  int *v13; // r4
  pthread_mutex_t *v14; // r6
  int v15; // r5
  unsigned int v16; // r7
  bool v17; // cf
  void *v18; // r4
  unsigned int v19; // r0
  _DWORD *v20; // r0
  _DWORD *v21; // r9
  const char *v22; // r0
  _DWORD *v23; // r0
  int v26; // [sp+10h] [bp-A8h]
  unsigned int v28; // [sp+18h] [bp-A0h] BYREF
  const unsigned __int8 *v29; // [sp+1Ch] [bp-9Ch] BYREF
  char v30[52]; // [sp+20h] [bp-98h] BYREF
  int v31; // [sp+54h] [bp-64h] BYREF
  int v32; // [sp+58h] [bp-60h] BYREF
  char v33[52]; // [sp+5Ch] [bp-5Ch] BYREF
  int v34; // [sp+90h] [bp-28h]

  v3 = a3[7];
  v26 = v3;
  next = record_stream_get_next(v3, &v29, &v28);
  v5 = v29;
  v6 = 0;
  v7 = next == 0;
  if ( !(next | (unsigned int)v29) )
    v6 = 1;
  if ( next >= 0 && !v6 )
  {
    do
    {
      if ( v7 )
      {
        v11 = v28;
        v12 = *a3;
        android::Parcel::Parcel((android::Parcel *)v33);
        android::Parcel::setData((android::Parcel *)v33, v5, v11);
        android::Parcel::readInt32((android::Parcel *)v33, &v32);
        v13 = (int *)&unk_13964;
        if ( v12 == 1 )
          v13 = &dword_1396C;
        v14 = (pthread_mutex_t *)&unk_13960;
        if ( v12 == 1 )
          v14 = (pthread_mutex_t *)&unk_13968;
        if ( android::Parcel::readInt32((android::Parcel *)v33, &v31) )
        {
          _android_log_buf_print(1, 6, "RILC", "invalid request block");
        }
        else
        {
          v15 = v32;
          if ( v32 == 800 )
          {
            sub_6310();
          }
          else
          {
            v16 = v32 - 5000;
            v17 = (unsigned int)(v32 - 1) >= 0x89;
            if ( (unsigned int)(v32 - 1) >= 0x89 )
              v17 = v16 >= 0x1D;
            if ( v17 )
            {
              android::Parcel::Parcel((android::Parcel *)v30);
              _android_log_buf_print(1, 6, "RILC", "unsupported request code %d token %d", v32, v31);
              android::Parcel::writeInt32((android::Parcel *)v30, 0);
              android::Parcel::writeInt32((android::Parcel *)v30, v31);
              android::Parcel::writeInt32((android::Parcel *)v30, 2);
              v18 = (void *)android::Parcel::data((android::Parcel *)v30);
              v19 = android::Parcel::dataSize((android::Parcel *)v30);
              sub_A1E0(v18, v19, v12);
              android::Parcel::~Parcel((android::Parcel *)v30);
            }
            else
            {
              v20 = calloc(1u, 0x18u);
              v21 = v20;
              if ( v20 )
              {
                *v20 = v31;
                if ( v15 < 5000 )
                {
                  v8 = 3 * v15;
                  v9 = (char *)&unk_13180;
                }
                else
                {
                  v8 = 3 * v16;
                  v9 = (char *)&unk_13024;
                }
                v21[1] = &v9[4 * v8];
                v21[4] = v12;
                pthread_mutex_lock(v14);
                v10 = *v13;
                *v13 = (int)v21;
                v21[2] = v10;
                pthread_mutex_unlock(v14);
                (*(void (__fastcall **)(char *, _DWORD *))(v21[1] + 4))(v33, v21);
              }
              else
              {
                v22 = j_requestToString(v15);
                _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v22);
              }
            }
          }
        }
        v3 = v26;
        android::Parcel::~Parcel((android::Parcel *)v33);
      }
      next = record_stream_get_next(v3, &v29, &v28);
      v5 = v29;
      v7 = next == 0;
    }
    while ( next >= 0 && (next | (unsigned int)v29) != 0 );
  }
  if ( v7 )
  {
    _android_log_buf_print(1, 5, "RILC", "EOS.  Closing command socket.");
LABEL_35:
    close(a1);
    a3[2] = -1;
    ril_event_del(a3[4]);
    record_stream_free(v3);
    ril_event_add(a3[5]);
    sub_A19C();
    sub_6A70(*a3);
    return _stack_chk_guard - v34;
  }
  v23 = (_DWORD *)_errno(next);
  if ( *v23 != 11 && *v23 != 4 )
  {
    _android_log_buf_print(1, 6, "RILC", "error on reading command socket errno:%d\n", *v23);
    goto LABEL_35;
  }
  return _stack_chk_guard - v34;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int __fastcall _errno(_DWORD);
// 2FF0: using guessed type int __fastcall record_stream_get_next(_DWORD, _DWORD, _DWORD);
// 3080: using guessed type int __fastcall record_stream_free(_DWORD);
// 1396C: using guessed type int dword_1396C;

//----- (00003DA0) --------------------------------------------------------
int __fastcall sub_3DA0(int a1, int a2)
{
  const char *v4; // r1
  const char *v5; // r0
  char *v6; // r0
  const char *v7; // r5
  int *v8; // r6
  int v9; // r5
  char *v11; // [sp+4h] [bp-6Ch]
  _DWORD v12[2]; // [sp+8h] [bp-68h] BYREF
  __int16 v13; // [sp+10h] [bp-60h]
  char v14[64]; // [sp+14h] [bp-5Ch] BYREF
  int v15; // [sp+54h] [bp-1Ch]

  v13 = 0;
  v12[0] = 0;
  v12[1] = 0;
  if ( a1 == 1 )
  {
    ((void (__fastcall *)(_DWORD *, const char *, int, int, int))_strncpy_chk2)(v12, "rild2", 9, 10, 6);
  }
  else
  {
    if ( a1 )
    {
      _android_log_buf_print(1, 6, "RILC", "Socket id is wrong!!");
      return _stack_chk_guard - v15;
    }
    ((void (__fastcall *)(_DWORD *, char *, int, int, int))_strncpy_chk2)(v12, rild, 9, 10, 6);
  }
  v4 = "not a valid RIL";
  if ( a1 == 1 )
    v4 = "RIL_SOCKET_2";
  v5 = "RIL_SOCKET_1";
  if ( a1 )
    v5 = v4;
  _android_log_buf_print(1, 4, "RILC", "Start to listen %s", v5);
  _snprintf_chk(v14, 64, 0, 64, "ANDROID_SOCKET_%s", (const char *)v12);
  v6 = getenv(v14);
  v7 = v6;
  if ( !v6 || (v8 = (int *)_errno(v6), *v8 = 0, v9 = strtol(v7, 0, 10), *v8) || v9 <= -1 )
  {
    _android_log_buf_print(1, 6, "RILC", "Failed to get socket %s", v12);
    goto LABEL_18;
  }
  if ( listen(v9, 4) <= -1 )
  {
    v11 = strerror(*v8);
    _android_log_buf_print(1, 6, "RILC", "Failed to listen on control socket '%d': %s", v9, v11);
LABEL_18:
    exit(-1);
  }
  *(_DWORD *)(a2 + 4) = v9;
  ril_event_set(*(_DWORD *)(a2 + 20), v9, 0, (int)listenCallback_helper, a2);
  ril_event_add(*(_DWORD *)(a2 + 20));
  sub_A19C();
  return _stack_chk_guard - v15;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int __fastcall _errno(_DWORD);
// 2FB4: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);
// 308C: using guessed type int __fastcall _strncpy_chk2(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (00003F20) --------------------------------------------------------
int __fastcall sub_3F20(int a1)
{
  int v2; // r0
  int v3; // r11
  signed int v4; // r4
  const char *v5; // r5
  int v6; // r9
  int v7; // r7
  int v8; // r4
  const char *v9; // r6
  int v10; // r0
  signed int v11; // r4
  int v12; // r0
  _DWORD *v13; // r0
  int v14; // r0
  int v15; // r0
  int v16; // r0
  int v17; // r0
  int *v18; // r1
  int v19; // r2
  int *v20; // r0
  int *v21; // r1
  void **v22; // r0
  __int64 v23; // d17
  int v24; // r2
  const char *v25; // r4
  int v26; // r4
  int v27; // r8
  int v28; // r5
  int v29; // r7
  char v30; // r1
  unsigned __int8 *v31; // r5
  int v32; // r4
  const char *v33; // r3
  const char *v34; // r4
  unsigned __int8 *v36; // r4
  int v37; // r5
  int v38; // r1
  int v39; // r8
  int v40; // r6
  int v41; // r7
  int v42; // r4
  int v43; // r0
  __int16 v44; // r1
  int v45; // [sp+0h] [bp-118h]
  int v46; // [sp+0h] [bp-118h]
  void *v47; // [sp+1Ch] [bp-FCh]
  int v48; // [sp+20h] [bp-F8h] BYREF
  int v49; // [sp+24h] [bp-F4h] BYREF
  int v50; // [sp+28h] [bp-F0h]
  int v51; // [sp+2Ch] [bp-ECh]
  int v52; // [sp+30h] [bp-E8h]
  int v53; // [sp+34h] [bp-E4h]
  int v54; // [sp+38h] [bp-E0h]
  const char *v55; // [sp+3Ch] [bp-DCh]
  size_t nmemb; // [sp+40h] [bp-D8h] BYREF
  int v57[4]; // [sp+44h] [bp-D4h] BYREF
  int v58; // [sp+54h] [bp-C4h] BYREF
  socklen_t addr_len; // [sp+58h] [bp-C0h] BYREF
  int v60; // [sp+5Ch] [bp-BCh] BYREF
  const char *v61; // [sp+60h] [bp-B8h] BYREF
  const char *v62; // [sp+64h] [bp-B4h] BYREF
  _QWORD v63[2]; // [sp+68h] [bp-B0h] BYREF
  int v64; // [sp+78h] [bp-A0h]
  int v65; // [sp+7Ch] [bp-9Ch]
  struct sockaddr addr; // [sp+80h] [bp-98h] BYREF
  int v67; // [sp+F0h] [bp-28h]

  addr_len = 110;
  v62 = "1";
  v60 = 1;
  _android_log_buf_print(1, 4, "RILC", "debugCallback for socket %s", "RIL_SOCKET_1");
  v2 = accept(a1, &addr, &addr_len);
  v3 = v2;
  if ( v2 > -1 )
  {
    if ( _recvfrom_chk(v2, &nmemb, 4, 4, 0, 0, 0) == 4 )
    {
      v4 = nmemb;
      if ( (int)nmemb > -1 )
      {
        v47 = calloc(nmemb, 4u);
        if ( !v47 )
        {
          _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for debug args");
          goto LABEL_63;
        }
        v5 = 0;
        if ( v4 >= 1 )
        {
          v6 = 0;
          v7 = 0;
          while ( 1 )
          {
            if ( _recvfrom_chk(v3, &v49, 4, 4, 0, 0, 0) != 4 )
            {
              _android_log_buf_print(1, 6, "RILC", "error reading on socket: Len of Args: \n", v46);
              goto LABEL_32;
            }
            v8 = v49;
            if ( v49 == 0x7FFFFFFF || v49 <= -1 )
            {
              _android_log_buf_print(1, 6, "RILC", "Invalid value of len: \n", v46);
              goto LABEL_32;
            }
            v9 = (const char *)calloc(v49 + 1, 1u);
            *((_DWORD *)v47 + v7) = v9;
            if ( !v9 )
            {
              _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for debug args");
              goto LABEL_32;
            }
            v10 = _recvfrom_chk(v3, v9, v8, -1, 0, 0, 0);
            if ( v10 != v49 )
              break;
            v11 = nmemb;
            ++v7;
            v9[v10] = 0;
            if ( v7 == v11 )
            {
              v12 = atoi(v9);
              v6 = v12;
              if ( v12 != 1 )
                v6 = 0;
              if ( !v12 )
                v6 = 0;
            }
            if ( v7 >= v11 )
            {
              v5 = *(const char **)v47;
              goto LABEL_25;
            }
          }
          _android_log_buf_print(1, 6, "RILC", "error reading on socket: Args[%d] \n", v7);
LABEL_32:
          v16 = v7;
          goto LABEL_62;
        }
        v6 = 0;
LABEL_25:
        v14 = atoi(v5);
        if ( v14 <= 89 )
        {
          switch ( v14 )
          {
            case 0:
              _android_log_buf_print(1, 4, "RILC", "Connection on debug port: issuing reset.");
              v15 = 58;
              goto LABEL_55;
            case 1:
              _android_log_buf_print(1, 4, "RILC", "Connection on debug port: issuing radio power off.");
              v58 = 0;
              sub_A0B8(23, (int)&v58, 4, v6);
              if ( !v6 && dword_13830 >= 1 )
              {
                close(dword_13830);
                v20 = &dword_13828;
LABEL_73:
                v20[2] = -1;
                break;
              }
              if ( v6 == 1 && dword_1389C >= 1 )
              {
                close(dword_1389C);
                v20 = dword_13894;
                goto LABEL_73;
              }
              break;
            case 2:
              _android_log_buf_print(1, 4, "RILC", "Debug port: issuing unsolicited voice network change.");
              j_RIL_onUnsolicitedResponse(1002, 0, 0, v6);
              break;
            case 3:
              _android_log_buf_print(1, 4, "RILC", "Debug port: QXDM log enable.");
              v21 = (int *)v63;
              v22 = &off_4570;
              goto LABEL_43;
            case 4:
              _android_log_buf_print(1, 4, "RILC", "Debug port: QXDM log disable.");
              v21 = (int *)v63;
              v22 = &off_4560;
LABEL_43:
              v23 = *((_QWORD *)v22 + 1);
              v63[0] = *(_QWORD *)v22;
              v63[1] = v23;
              v64 = 0;
              v65 = 8;
              v15 = 59;
              v24 = 24;
              goto LABEL_60;
            case 5:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Radio On");
              v58 = 1;
              sub_A0B8(23, (int)&v58, 4, v6);
              sleep(2u);
              v15 = 46;
              goto LABEL_55;
            case 6:
              v34 = (const char *)*((_DWORD *)v47 + 1);
              _android_log_buf_print(1, 4, "RILC", "Debug port: Setup Data Call, Apn :%s\n", v34);
              v61 = v34;
              v21 = (int *)&v61;
              v15 = 27;
              goto LABEL_59;
            case 7:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Deactivate Data Call");
              v21 = (int *)&v62;
              v15 = 41;
              goto LABEL_59;
            case 8:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Dial Call");
              v21 = v57;
              v57[1] = 0;
              v24 = 16;
              v57[0] = *((_DWORD *)v47 + 1);
              v15 = 10;
              v57[3] = 1;
              goto LABEL_60;
            case 9:
              _android_log_buf_print(1, 4, "RILC", "Debug port: Answer Call");
              v15 = 40;
LABEL_55:
              v21 = 0;
              v24 = 0;
              goto LABEL_60;
            case 10:
              _android_log_buf_print(1, 4, "RILC", "Debug port: End Call");
              v21 = &v60;
              v15 = 12;
              goto LABEL_59;
            case 11:
              v25 = (const char *)*((_DWORD *)v47 + 1);
              _android_log_buf_print(1, 4, "RILC", "Debug port: Open Channel %s\n", v25);
              v15 = 115;
              v21 = (int *)v25;
LABEL_59:
              v24 = 4;
              goto LABEL_60;
            case 12:
              v48 = 0;
              _android_log_buf_print(1, 4, "RILC", "Debug port: Transmit Channel");
              v49 = 2;
              v26 = *((_DWORD *)v47 + 1);
              LOWORD(v48) = *(_WORD *)v26;
              _android_log_buf_print(1, 4, "RILC", "1. tmp : %s", (const char *)&v48);
              v27 = atoi((const char *)&v48);
              v50 = v27;
              LOWORD(v48) = *(_WORD *)(v26 + 2);
              _android_log_buf_print(1, 4, "RILC", "2. tmp : %s", (const char *)&v48);
              v28 = atoi((const char *)&v48);
              v51 = v28;
              LOWORD(v48) = *(_WORD *)(v26 + 4);
              _android_log_buf_print(1, 4, "RILC", "3. tmp : %s", (const char *)&v48);
              v29 = atoi((const char *)&v48);
              v52 = v29;
              LOWORD(v48) = *(_WORD *)(v26 + 6);
              _android_log_buf_print(1, 4, "RILC", "4. tmp : %s", (const char *)&v48);
              v53 = atoi((const char *)&v48);
              LOBYTE(v48) = *(_BYTE *)(v26 + 8);
              v30 = *(_BYTE *)(v26 + 9);
              v54 = 4;
              BYTE1(v48) = v30;
              v55 = "55555555";
              _android_log_buf_print(
                1,
                4,
                "RILC",
                "cla : %d, ins : %d, p1 : %d, p2 : %d, p3 : %d, data : %s",
                v27,
                v28,
                v29,
                v53,
                4,
                "55555555");
              v21 = &v49;
              v15 = 117;
              v24 = 28;
              goto LABEL_60;
            case 13:
              v36 = (unsigned __int8 *)*((_DWORD *)v47 + 1);
              v37 = _strlen_chk(v36, -1);
              _android_log_buf_print(1, 4, "RILC", "Debug port: Vsim Notification");
              if ( v37 <= 2 )
              {
                v33 = "Debug port: Vsim Notification - too short param (at least 3)";
                goto LABEL_67;
              }
              v49 = *v36 - 48;
              v50 = v36[1] - 48;
              v51 = v36[2] - 48;
              _android_log_buf_print(
                1,
                4,
                "RILC",
                "Debug port: Vsim Notification (tid:%d, eventid:%d, simtype:%d)",
                v49,
                v50,
                v51);
              v21 = &v49;
              v15 = 5022;
              v24 = 12;
              goto LABEL_60;
            case 14:
              v31 = (unsigned __int8 *)*((_DWORD *)v47 + 1);
              v32 = _strlen_chk(v31, -1);
              _android_log_buf_print(1, 4, "RILC", "Debug port: Vsim Operation");
              if ( v32 <= 9 )
              {
                v33 = "Debug port: Vsim Operation - too short param (at least 10)";
LABEL_67:
                v38 = 4;
                goto LABEL_69;
              }
              v49 = *v31 - 48;
              v39 = v49;
              v50 = v31[1] - 48;
              v40 = v50;
              v51 = v31[2] - 48;
              v41 = v51;
              v52 = v31[3] - 48;
              v42 = v52;
              v43 = operator new[](8u);
              v53 = v43;
              *(_DWORD *)(v43 + 4) = 0;
              *(_DWORD *)v43 = 0;
              v44 = *((_WORD *)v31 + 4);
              *(_DWORD *)v43 = *((_DWORD *)v31 + 1);
              *(_WORD *)(v43 + 4) = v44;
              _android_log_buf_print(
                1,
                4,
                "RILC",
                "Debug port: Vsim Notification (tid:%d, eventid:%d, result:%d, datalen:%d, data:%s)",
                v39,
                v40,
                v41,
                v42,
                (const char *)v43);
              v21 = &v49;
              v15 = 5023;
              v24 = 20;
LABEL_60:
              sub_A0B8(v15, (int)v21, v24, v6);
              break;
            default:
              goto LABEL_68;
          }
LABEL_61:
          v16 = nmemb;
LABEL_62:
          sub_A090(v16, (void **)v47);
          goto LABEL_63;
        }
        switch ( v14 )
        {
          case 'Z':
            _android_log_buf_print(1, 4, "RILC", "Debug port: Set Call Confirm as Disabled");
            v58 = 0;
            break;
          case '[':
            _android_log_buf_print(1, 4, "RILC", "Debug port: Set Call Confirm as Enabled");
            v58 = 1;
            break;
          case '\\':
            _android_log_buf_print(1, 4, "RILC", "Debug port: Send Call Confirm");
            v17 = 5016;
            v18 = 0;
            v19 = 0;
            goto LABEL_53;
          default:
LABEL_68:
            v38 = 6;
            v45 = v14;
            v33 = "Invalid request : %d";
LABEL_69:
            _android_log_buf_print(1, v38, "RILC", v33, v45);
            goto LABEL_61;
        }
        v18 = &v58;
        v17 = 5015;
        v19 = 4;
LABEL_53:
        sub_A0B8(v17, (int)v18, v19, v6);
        sleep(2u);
        goto LABEL_61;
      }
      _android_log_buf_print(1, 6, "RILC", "Invalid number of arguments: \n");
    }
    else
    {
      _android_log_buf_print(1, 6, "RILC", "error reading on socket: number of Args: \n");
    }
LABEL_63:
    close(v3);
    return _stack_chk_guard - v67;
  }
  v13 = (_DWORD *)_errno(v2);
  _android_log_buf_print(1, 6, "RILC", "error accepting on debug port: %d\n", *v13);
  return _stack_chk_guard - v67;
}
// 40E2: variable 'v46' is possibly undefined
// 44AA: variable 'v45' is possibly undefined
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int __fastcall _errno(_DWORD);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 30A4: using guessed type int __fastcall _recvfrom_chk(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 4560: using guessed type void *off_4560;
// 4570: using guessed type void *off_4570;
// 13828: using guessed type int dword_13828;
// 13830: using guessed type int dword_13830;
// 13894: using guessed type _DWORD dword_13894[2];
// 1389C: using guessed type int dword_1389C;
// 3F20: using guessed type _QWORD var_B0[2];

//----- (000046B8) --------------------------------------------------------
int sub_46B8()
{
  int v0; // r0
  int v1; // r4
  int v2; // r0
  const char *v3; // r11
  int v4; // r5
  void *v5; // r10
  __int64 v6; // r0
  int v7; // r0
  int v8; // r0
  int v9; // r0
  int v10; // r0
  int v11; // r0
  size_t v12; // r6
  unsigned __int8 *v13; // r7
  int v14; // r0
  int v15; // r5
  const char *v16; // r4
  void *v17; // r11
  int v18; // r6
  int v19; // r5
  _DWORD *v20; // r0
  _DWORD *v21; // r0
  _DWORD *v22; // r0
  int v24; // [sp+0h] [bp-F0h]
  int v25; // [sp+0h] [bp-F0h]
  int v26; // [sp+0h] [bp-F0h]
  int v27; // [sp+0h] [bp-F0h]
  int v28; // [sp+20h] [bp-D0h]
  socklen_t addr_len; // [sp+24h] [bp-CCh] BYREF
  int v30; // [sp+28h] [bp-C8h] BYREF
  int v31; // [sp+2Ch] [bp-C4h] BYREF
  int v32; // [sp+30h] [bp-C0h] BYREF
  int v33; // [sp+34h] [bp-BCh] BYREF
  int v34; // [sp+38h] [bp-B8h]
  int v35; // [sp+3Ch] [bp-B4h]
  int v36; // [sp+40h] [bp-B0h]
  struct sockaddr addr; // [sp+44h] [bp-ACh] BYREF

  addr_len = 110;
  _android_log_buf_print(1, 4, "RILC", "[vsimCallback] enter, fd = %d", dword_1301C);
  v0 = accept(dword_1301C, &addr, &addr_len);
  v1 = v0;
  v28 = v0;
  if ( v0 <= -1 )
  {
    v24 = *(_DWORD *)_errno(v0);
    _android_log_buf_print(1, 6, "RILC", "[vsimCallback] error accepting on oem port: %d\n", v24);
    return 0;
  }
  dword_13020 = v0;
  v2 = sub_A2B0(v0, (int)&v33, 0x10u);
  if ( v2 >= 0 )
  {
    v3 = "RILC";
    do
    {
      _android_log_buf_print(
        1,
        4,
        v3,
        "[processVsimCommandsCallback] id: %d, msg_id:%d, slot_id:%d, data_len:%d",
        v33,
        v34,
        v35 >> 1,
        v36);
      v4 = v34;
      if ( (unsigned int)(v34 - 4) >= 2 )
      {
        if ( v34 == 3 )
        {
          v30 = v33;
          v10 = sub_A2B0(v1, (int)&v31, 4u);
          if ( v10 <= -1 )
          {
            v26 = *(_DWORD *)_errno(v10);
            _android_log_buf_print(
              1,
              6,
              "RILC",
              "[processVsimCommandsCallback] error reading on socket: eventId, errno:%d.\n",
              v26);
            return 0;
          }
          v11 = sub_A2B0(v1, (int)&v32, 4u);
          if ( v11 <= -1 )
          {
            v27 = *(_DWORD *)_errno(v11);
            _android_log_buf_print(
              1,
              6,
              "RILC",
              "[processVsimCommandsCallback] error reading on socket: sim_type, errno:%d.\n",
              v27);
            return 0;
          }
          switch ( v31 )
          {
            case 1:
              _android_log_buf_print(
                1,
                4,
                v3,
                "[processVsimCommandsCallback] MSG_ID_EVENT_REQUEST, eventId:%d REQUEST_TYPE_ENABLE_EXTERNAL_SIM, sim_type:%d",
                1,
                v32);
              break;
            case 2:
              _android_log_buf_print(
                1,
                4,
                v3,
                "[processVsimCommandsCallback] MSG_ID_EVENT_REQUEST, eventId:%d REQUEST_TYPE_DISABLE_EXTERNAL_SIM, sim_type:%d",
                2,
                v32);
              break;
            case 3:
              _android_log_buf_print(
                1,
                4,
                v3,
                "[processVsimCommandsCallback] MSG_ID_EVENT_REQUEST, eventId:%d REQUEST_TYPE_PLUG_OUT, sim_type:%d",
                3,
                v32);
              break;
            case 4:
              _android_log_buf_print(
                1,
                4,
                v3,
                "[processVsimCommandsCallback] MSG_ID_EVENT_REQUEST, eventId:%d REQUEST_TYPE_PLUG_IN, sim_type:%d",
                4,
                v32);
              break;
            default:
              break;
          }
          sub_A0B8(5022, (int)&v30, 12, *(_DWORD *)((char *)&unk_1121C + ((2 * v35) & 0xFFFFFFFC)));
        }
      }
      else
      {
        v5 = calloc(1u, 0x14u);
        *(_QWORD *)v5 = 0LL;
        *((_QWORD *)v5 + 1) = 0LL;
        *((_DWORD *)v5 + 4) = 0;
        v6 = (unsigned int)v33 | 0x200000000LL;
        if ( v4 == 4 )
          HIDWORD(v6) = 1;
        *(_QWORD *)v5 = v6;
        v7 = sub_A2B0(v1, (int)v5 + 8, 4u);
        if ( v7 <= -1 )
        {
          v21 = (_DWORD *)_errno(v7);
          _android_log_buf_print(
            1,
            6,
            "RILC",
            "[processVsimCommandsCallback] error reading on socket: response.result, errno:%d.\n",
            *v21);
LABEL_36:
          free(v5);
          return 0;
        }
        v8 = sub_A2B0(v1, (int)v5 + 12, 4u);
        if ( v8 <= -1 )
        {
          v25 = *(_DWORD *)_errno(v8);
          _android_log_buf_print(
            1,
            6,
            "RILC",
            "[processVsimCommandsCallback] error reading on socket: response.data_length, errno:%d.\n",
            v25);
          goto LABEL_36;
        }
        v9 = *((_DWORD *)v5 + 1);
        if ( v9 == 2 )
        {
          _android_log_buf_print(
            1,
            4,
            v3,
            "[processVsimCommandsCallback] MSG_ID_UICC_APDU_RESPONSE, eventId:%d REQUEST_TYPE_APDU_EVENT",
            2);
        }
        else if ( v9 == 1 )
        {
          _android_log_buf_print(
            1,
            4,
            v3,
            "[processVsimCommandsCallback] MSG_ID_UICC_RESET_RESPONSE, eventId:%d REQUEST_TYPE_ATR_EVENT",
            1);
        }
        _android_log_buf_print(
          1,
          4,
          v3,
          "[processVsimCommandsCallback] UICC_RESPONSE, result:%d, data_length:%d",
          *((_DWORD *)v5 + 2),
          *((_DWORD *)v5 + 3));
        v12 = *((_DWORD *)v5 + 3) + 1;
        v13 = (unsigned __int8 *)calloc(1u, v12);
        memset(v13, 0, v12);
        _android_log_buf_print(
          1,
          4,
          v3,
          "[processVsimCommandsCallback] UICC_RESPONSE, data:%s, (before)",
          *((const char **)v5 + 4));
        v14 = sub_A2B0(v1, (int)v13, *((_DWORD *)v5 + 3));
        if ( v14 <= -1 )
        {
          v22 = (_DWORD *)_errno(v14);
          _android_log_buf_print(
            1,
            6,
            "RILC",
            "[processVsimCommandsCallback] error reading on socket: response.data_length, errno:%d.\n",
            *v22);
          free(v13);
          goto LABEL_36;
        }
        v15 = *((_DWORD *)v5 + 3);
        v16 = v3;
        v17 = calloc(1u, (2 * v15) | 1);
        *((_DWORD *)v5 + 4) = v17;
        memset(v17, 0, (2 * v15) | 1);
        if ( v15 >= 1 )
        {
          _sprintf_chk(v17, 0, -1, "%02X", *v13);
          if ( *((int *)v5 + 3) >= 2 )
          {
            v18 = 1;
            v19 = 2;
            do
            {
              _sprintf_chk(*((_DWORD *)v5 + 4) + v19, 0, -1, "%02X", v13[v18++]);
              v19 += 2;
            }
            while ( v18 < *((_DWORD *)v5 + 3) );
          }
        }
        free(v13);
        v3 = v16;
        _android_log_buf_print(
          1,
          4,
          v16,
          "[processVsimCommandsCallback] UICC_RESPONSE, data:%s, response_addr:%p",
          *((const char **)v5 + 4),
          v5);
        sub_A0B8(5023, (int)v5, 20, *(_DWORD *)((char *)&unk_1121C + ((2 * v35) & 0xFFFFFFFC)));
        free(*((void **)v5 + 4));
        free(v5);
        v1 = v28;
      }
      v2 = sub_A2B0(v1, (int)&v33, 0x10u);
    }
    while ( v2 >= 0 );
  }
  v20 = (_DWORD *)_errno(v2);
  _android_log_buf_print(
    1,
    6,
    "RILC",
    "[processVsimCommandsCallback] error reading on socket: msg_id, errno:%d\n",
    *v20);
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int __fastcall _errno(_DWORD);
// 30EC: using guessed type int _sprintf_chk(_DWORD, _DWORD, _DWORD, const char *, ...);
// 46B8: using guessed type int sub_46B8();
// 1301C: using guessed type int dword_1301C;
// 13020: using guessed type int dword_13020;

//----- (00004AF0) --------------------------------------------------------
int __fastcall RIL_onRequestAck(int a1)
{
  int v2; // r4
  int *v3; // r1
  int v4; // r7
  void *v5; // r6
  unsigned int v6; // r0
  char v8[52]; // [sp+4h] [bp-4Ch] BYREF
  int v9; // [sp+38h] [bp-18h]

  if ( sub_4BC4(a1, 1) )
  {
    if ( !*(_BYTE *)(a1 + 12) )
    {
      v2 = *(_DWORD *)(a1 + 16);
      v3 = &dword_13830;
      if ( v2 == 1 )
        v3 = &dword_1389C;
      v4 = *v3;
      android::Parcel::Parcel((android::Parcel *)v8);
      android::Parcel::writeInt32((android::Parcel *)v8, 2);
      android::Parcel::writeInt32((android::Parcel *)v8, *(_DWORD *)a1);
      if ( v4 <= -1 )
        _android_log_buf_print(1, 3, "RILC", "RIL onRequestComplete: Command channel closed");
      v5 = (void *)android::Parcel::data((android::Parcel *)v8);
      v6 = android::Parcel::dataSize((android::Parcel *)v8);
      sub_A1E0(v5, v6, v2);
      android::Parcel::~Parcel((android::Parcel *)v8);
    }
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_onRequestAck: invalid RIL_Token");
  }
  return _stack_chk_guard - v9;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 13830: using guessed type int dword_13830;
// 1389C: using guessed type int dword_1389C;

//----- (00004BC4) --------------------------------------------------------
int __fastcall sub_4BC4(int a1, int a2)
{
  int v4; // r7
  pthread_mutex_t *v5; // r4
  int *v6; // r0
  int i; // r1
  const char *v8; // r0
  int v9; // r6

  if ( !a1 )
    return 0;
  v4 = *(_DWORD *)(a1 + 16);
  v5 = (pthread_mutex_t *)&unk_13960;
  if ( v4 == 1 )
    v5 = (pthread_mutex_t *)&unk_13968;
  pthread_mutex_lock(v5);
  v6 = (int *)&unk_13964;
  if ( v4 == 1 )
    v6 = &dword_1396C;
  for ( i = *v6; ; i = *(_DWORD *)(i + 8) )
  {
    if ( !i )
    {
      v9 = 0;
      goto LABEL_17;
    }
    if ( i == a1 )
      break;
    v6 = (int *)(i + 8);
  }
  if ( a2 == 1 )
  {
    if ( *(_DWORD *)(a1 + 20) == 1 )
    {
      v8 = j_requestToString(**(_DWORD **)(a1 + 4));
      v9 = 1;
      _android_log_buf_print(1, 3, "RILC", "Ack was already sent for %s", v8);
    }
    else
    {
      v9 = 1;
      *(_DWORD *)(a1 + 20) = 1;
    }
  }
  else
  {
    v9 = 1;
    *v6 = *(_DWORD *)(a1 + 8);
  }
LABEL_17:
  pthread_mutex_unlock(v5);
  return v9;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 1396C: using guessed type int dword_1396C;

//----- (00004C64) --------------------------------------------------------
int __fastcall RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  int v8; // r0
  int v9; // r8
  unsigned int v10; // r9
  int v11; // r5
  void *v12; // r6
  unsigned int v13; // r0
  int v15; // [sp+0h] [bp-60h]
  int v16[13]; // [sp+4h] [bp-5Ch] BYREF
  int v17[10]; // [sp+38h] [bp-28h] BYREF

  if ( sub_4BC4(a1, 0) )
  {
    if ( !*(_BYTE *)(a1 + 13) )
    {
      v8 = **(_DWORD **)(a1 + 4);
      if ( v8 == 5023 )
      {
        _android_log_buf_print(
          1,
          3,
          "RILC",
          "[VSIM] local request fRIL_LOCAL_REQUEST_VSIM_OPERATION returned, fd: %d",
          dword_13020);
      }
      else
      {
        v9 = *(_DWORD *)(a1 + 16);
        if ( v8 == 5022 )
        {
          _android_log_buf_print(
            1,
            3,
            "RILC",
            "[VSIM] local request RIL_LOCAL_REQUEST_VSIM_NOTIFICATION returned, fd: %d",
            dword_13020);
          v16[0] = 0;
          v16[1] = 1003;
          v16[2] = 1 << v9;
          v16[3] = 4;
          if ( blockingWrite_helper(dword_13020, v16, 0x10u) <= -1 )
          {
            _android_log_buf_print(1, 3, "RILC", "[VSIM] local request fail to write msg back. ");
          }
          else
          {
            if ( a2 )
              a2 = -1;
            v17[0] = a2;
            if ( blockingWrite_helper(dword_13020, v17, 4u) <= -1 )
              _android_log_buf_print(1, 3, "RILC", "[VSIM] local request fail to write data back. ", v15);
          }
        }
        else if ( !*(_BYTE *)(a1 + 12) )
        {
          android::Parcel::Parcel((android::Parcel *)v16);
          if ( android::s_callbacks >= 13 && *(_DWORD *)(a1 + 20) == 1 )
          {
            android::Parcel::writeInt32((android::Parcel *)v16, 3);
            sub_4EE8();
          }
          else
          {
            android::Parcel::writeInt32((android::Parcel *)v16, 0);
          }
          android::Parcel::writeInt32((android::Parcel *)v16, *(_DWORD *)a1);
          v10 = android::Parcel::dataPosition((android::Parcel *)v16);
          android::Parcel::writeInt32((android::Parcel *)v16, a2);
          if ( a3 )
          {
            v11 = (*(int (__fastcall **)(int *, int, int))(*(_DWORD *)(a1 + 4) + 8))(v16, a3, a4);
            if ( v11 )
            {
              _android_log_buf_print(1, 6, "RILC", "responseFunction error, ret %d", v11);
              android::Parcel::setDataPosition((android::Parcel *)v16, v10);
              android::Parcel::writeInt32((android::Parcel *)v16, v11);
            }
          }
          v12 = (void *)android::Parcel::data((android::Parcel *)v16);
          v13 = android::Parcel::dataSize((android::Parcel *)v16);
          sub_A1E0(v12, v13, v9);
          android::Parcel::~Parcel((android::Parcel *)v16);
        }
      }
    }
    free((void *)a1);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "RIL_onRequestComplete: invalid RIL_Token");
  }
  return _stack_chk_guard - v17[1];
}
// 4D0C: variable 'v15' is possibly undefined
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 13020: using guessed type int dword_13020;
// 137F8: using guessed type int android::s_callbacks;

//----- (00004E58) --------------------------------------------------------
int __fastcall blockingWrite_helper(int a1, void *a2, unsigned int a3)
{
  unsigned int v6; // r10
  int v7; // r0
  _DWORD *v8; // r5

  v6 = 0;
  if ( a3 )
  {
    while ( 1 )
    {
      v7 = _write_chk(a1, (char *)a2 + v6, a3 - v6, -1);
      if ( v7 <= -1 )
        break;
LABEL_7:
      v6 += v7;
      if ( v6 >= a3 )
        return 0;
    }
    v8 = (_DWORD *)_errno();
    while ( *v8 == 4 || *v8 == 11 )
    {
      v7 = _write_chk(a1, (char *)a2 + v6, a3 - v6, -1);
      if ( v7 >= 0 )
        goto LABEL_7;
    }
    _android_log_buf_print(1, 6, "RILC", "RIL Response: unexpected error on write errno:%d", *v8);
    close(a1);
    return -1;
  }
  return v6;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int _errno(void);
// 311C: using guessed type int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (00004EE8) --------------------------------------------------------
int sub_4EE8()
{
  int v0; // r0

  if ( android::s_callbacks < 13 )
    return j_acquire_wake_lock();
  pthread_mutex_lock((pthread_mutex_t *)&unk_13978);
  acquire_wake_lock(1, "radio-interface");
  v0 = RIL_requestTimedCallback_0((int)&loc_571C + 1, 0, &qword_11214);
  if ( v0 )
  {
    ++android::s_wakelock_count;
    if ( dword_13928 )
      *(_DWORD *)(dword_13928 + 4) = 1;
    dword_13928 = v0;
  }
  else
  {
    release_wake_lock("radio-interface");
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_13978);
}
// 3128: using guessed type int __fastcall acquire_wake_lock(_DWORD, _DWORD);
// 3134: using guessed type int __fastcall release_wake_lock(_DWORD);
// 11214: using guessed type __int64 qword_11214;
// 137F8: using guessed type int android::s_callbacks;
// 13810: using guessed type int android::s_wakelock_count;
// 13928: using guessed type int dword_13928;

//----- (00004F84) --------------------------------------------------------
int __fastcall RIL_onUnsolicitedResponse(int a1, int a2, int a3, int a4)
{
  int v9; // r1
  android *v10; // r0
  bool v11; // zf
  int v12; // r1
  __int64 v13; // r8
  bool v14; // zf
  int v15; // r1
  int v16; // r1
  int v17; // r5
  int v18; // r6
  int v19; // r0
  const char *v20; // r1
  const char *v21; // r0
  void *v22; // r5
  unsigned int v23; // r0
  int v24; // r0
  size_t v25; // r0
  void *v26; // r5
  const void *v27; // r6
  const char *v28; // [sp+4h] [bp-6Ch]
  int v29; // [sp+8h] [bp-68h]
  int v30; // [sp+10h] [bp-60h]
  char v31[52]; // [sp+14h] [bp-5Ch] BYREF
  int v32; // [sp+48h] [bp-28h]

  if ( byte_13824 )
  {
    if ( a1 >= 6000 )
      return j_android::RIL_onExtUnsolicitedResponse(a1, a2, a3, a4);
    if ( a1 >= 1000 && a1 - 1000 < 46 )
    {
      v9 = 0;
      v10 = (android *)(&stru_3E0 + 15);
      v11 = a1 == 1007;
      if ( a1 != 1007 )
      {
        v10 = (android *)(&stru_3F0 + 1);
        v11 = a1 == 1009;
      }
      if ( !v11 )
      {
        v10 = (android *)sub_4EE8();
        v9 = 1;
      }
      v30 = v9;
      if ( a1 == 1008 )
      {
        LODWORD(v13) = android::elapsedRealtime(v10);
        HIDWORD(v13) = v12;
      }
      else
      {
        v13 = 0LL;
      }
      android::Parcel::Parcel((android::Parcel *)v31);
      if ( android::s_callbacks < 13 )
        goto LABEL_20;
      v14 = a1 == 1007;
      if ( a1 != 1007 )
        v14 = a1 == 1009;
      if ( v14 )
LABEL_20:
        v15 = 1;
      else
        v15 = 4;
      android::Parcel::writeInt32((android::Parcel *)v31, v15);
      android::Parcel::writeInt32((android::Parcel *)v31, a1);
      if ( ((int (__fastcall *)(char *, int, int))*(&off_12920 + 3 * a1 - 2999))(v31, a2, a3) )
        goto LABEL_53;
      if ( a1 == 1008 )
      {
        android::Parcel::writeInt64((android::Parcel *)v31, v13);
      }
      else if ( a1 == 1000 )
      {
        v16 = dword_13800(a4);
        v17 = v16 - 2;
        if ( (unsigned int)(v16 - 2) <= 7 )
        {
          v18 = dword_11250[v17];
          if ( v18 != android::voiceRadioTech )
          {
            android::voiceRadioTech = dword_11250[v17];
            j_RIL_onUnsolicitedResponse(1035, &android::voiceRadioTech, 4, a4);
          }
          if ( (unsigned int)(v18 - 4) <= 9
            && ((0x31Fu >> (v18 - 4)) & 1) != 0
            && dword_11230[v17] != android::cdmaSubscriptionSource )
          {
            android::cdmaSubscriptionSource = dword_11230[v17];
            j_RIL_onUnsolicitedResponse(1031, &android::cdmaSubscriptionSource, 4, a4);
          }
          if ( dword_11270[v17] != android::simRuimStatus )
          {
            android::simRuimStatus = dword_11270[v17];
            j_RIL_onUnsolicitedResponse(1019, 0, 0, a4);
          }
          v16 = 10;
        }
        android::Parcel::writeInt32((android::Parcel *)v31, v16);
      }
      if ( android::s_callbacks <= 12 && v30 == 1 )
      {
        v19 = RIL_requestTimedCallback_0((int)&loc_571C + 1, 0, &qword_11214);
        if ( !v19 )
          goto LABEL_53;
        if ( dword_13928 )
          *(_DWORD *)(dword_13928 + 4) = 1;
        dword_13928 = v19;
      }
      v28 = j_requestToString(a1);
      v29 = android::Parcel::dataSize((android::Parcel *)v31);
      v20 = "not a valid RIL";
      if ( a4 == 1 )
        v20 = "RIL_SOCKET_2";
      v21 = "RIL_SOCKET_1";
      if ( a4 )
        v21 = v20;
      _android_log_buf_print(1, 4, "RILC", "%s UNSOLICITED: %s length:%d", v21, v28, v29);
      v22 = (void *)android::Parcel::data((android::Parcel *)v31);
      v23 = android::Parcel::dataSize((android::Parcel *)v31);
      v24 = sub_A1E0(v22, v23, a4);
      if ( a1 != 1008 || !v24 )
        goto LABEL_55;
      if ( dword_1392C )
      {
        free((void *)dword_1392C);
        dword_1392C = 0;
      }
      v25 = android::Parcel::dataSize((android::Parcel *)v31);
      dword_1392C = (int)calloc(v25, 1u);
      if ( dword_1392C )
      {
        dword_13930 = android::Parcel::dataSize((android::Parcel *)v31);
        v26 = (void *)dword_1392C;
        v27 = (const void *)android::Parcel::data((android::Parcel *)v31);
        qmemcpy(v26, v27, android::Parcel::dataSize((android::Parcel *)v31));
LABEL_55:
        android::Parcel::~Parcel((android::Parcel *)v31);
        return _stack_chk_guard - v32;
      }
      _android_log_buf_print(1, 6, "RILC", "Memory allocation failed in RIL_onUnsolicitedResponse");
LABEL_53:
      if ( v30 == 1 )
        sub_6310();
      goto LABEL_55;
    }
    _android_log_buf_print(1, 6, "RILC", "unsupported unsolicited response code %d", a1);
  }
  else
  {
    _android_log_buf_print(1, 5, "RILC", "RIL_onUnsolicitedResponse called before RIL_register");
  }
  return _stack_chk_guard - v32;
}
// 13800: invalid function type has been ignored
// 501E: variable 'v12' is possibly undefined
// 3E0: using guessed type Elf32_Sym stru_3E0;
// 3F0: using guessed type Elf32_Sym stru_3F0;
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 30BC: using guessed type int __fastcall j_RIL_onUnsolicitedResponse(_DWORD, _DWORD, _DWORD, _DWORD);
// 11214: using guessed type __int64 qword_11214;
// 11230: using guessed type _DWORD dword_11230[8];
// 11250: using guessed type _DWORD dword_11250[8];
// 11270: using guessed type _DWORD dword_11270[8];
// 12920: using guessed type void *off_12920;
// 1300C: using guessed type int android::voiceRadioTech;
// 13010: using guessed type int android::cdmaSubscriptionSource;
// 13014: using guessed type int android::simRuimStatus;
// 137F8: using guessed type int android::s_callbacks;
// 13800: using guessed type int (__fastcall *dword_13800)(_DWORD);
// 13824: using guessed type char byte_13824;
// 13928: using guessed type int dword_13928;
// 1392C: using guessed type int dword_1392C;
// 13930: using guessed type int dword_13930;

//----- (00005328) --------------------------------------------------------
int __fastcall android::RIL_onExtUnsolicitedResponse(int a1, int a2, int a3, int a4)
{
  int v8; // r0
  bool v9; // zf
  const char *v10; // r1
  const char *v11; // r4
  const char *v12; // r0
  int v13; // r0
  int (__fastcall **v14)(int *, int, int); // r9
  const char *v15; // r1
  const char *v16; // r0
  void *v17; // r6
  unsigned int v18; // r0
  int v19; // r0
  const char *v21; // [sp+4h] [bp-5Ch]
  int v22; // [sp+8h] [bp-58h]
  int v23; // [sp+Ch] [bp-54h] BYREF
  int v24; // [sp+10h] [bp-50h]
  int v25; // [sp+14h] [bp-4Ch]
  int v26; // [sp+18h] [bp-48h]
  int v27; // [sp+40h] [bp-20h]

  if ( a1 < 6000 || (v8 = a1 - 6000, a1 - 6000 >= 8) )
  {
    _android_log_buf_print(1, 6, "RILC", "unsupported unsolicited response code(extension) %d", a1);
  }
  else if ( v8 )
  {
    v9 = a1 == 6005;
    if ( a1 == 6005 )
      v9 = dword_13020 == -1;
    if ( v9 )
    {
      v10 = "not a valid RIL";
      if ( a4 == 1 )
        v10 = "RIL_SOCKET_2";
      v11 = "RIL_SOCKET_1";
      if ( a4 )
        v11 = v10;
      v12 = j_requestToString(6005);
      _android_log_buf_print(
        1,
        3,
        "RILC",
        "Can't send URC because there is no vsim connection yet. Do not Try to cache request:%s in Samsung RIL%s",
        v12,
        v11);
    }
    else
    {
      if ( a1 == 6005 && dword_13020 >= 1 )
      {
        v13 = *(_DWORD *)(a2 + 4);
        if ( v13 == 2 )
        {
          _android_log_buf_print(
            1,
            3,
            "RILC",
            "[VSIM] URC RIL_UNSOL_VSIM_OPERATION_INDICATION, eventId = %d REQUEST_TYPE_APDU_EVENT",
            2);
        }
        else if ( v13 == 1 )
        {
          _android_log_buf_print(
            1,
            3,
            "RILC",
            "[VSIM] URC RIL_UNSOL_VSIM_OPERATION_INDICATION, eventId = %d REQUEST_TYPE_ATR_EVENT",
            1);
        }
        v23 = *(_DWORD *)a2;
        v25 = 1 << a4;
        v19 = *(_DWORD *)(a2 + 4);
        if ( v19 == 3 )
        {
          v24 = 1006;
          v26 = 4;
          if ( blockingWrite_helper(dword_13020, &v23, 0x10u) <= -1 )
            _android_log_buf_print(1, 3, "RILC", "[VSIM] local request fail to write msg back. ");
          if ( blockingWrite_helper(dword_13020, (void *)(a2 + 8), 4u) > -1 )
            goto LABEL_44;
        }
        else
        {
          if ( v19 != 2 )
          {
            if ( v19 == 1 )
            {
              v24 = 1004;
              v26 = 0;
              if ( blockingWrite_helper(dword_13020, &v23, 0x10u) <= -1 )
                _android_log_buf_print(1, 3, "RILC", "[VSIM] local request fail to write msg back. ");
            }
            goto LABEL_44;
          }
          v24 = 1005;
          v26 = *(_DWORD *)(a2 + 12) + 4;
          if ( blockingWrite_helper(dword_13020, &v23, 0x10u) <= -1 )
            _android_log_buf_print(1, 3, "RILC", "[VSIM] local request fail to write msg back. ");
          if ( blockingWrite_helper(dword_13020, (void *)(a2 + 12), 4u) <= -1 )
            _android_log_buf_print(1, 3, "RILC", "[VSIM] local request fail to write data_length back. ");
          if ( blockingWrite_helper(dword_13020, *(void **)(a2 + 16), *(_DWORD *)(a2 + 12)) > -1 )
            goto LABEL_44;
        }
        _android_log_buf_print(1, 3, "RILC", "[VSIM] local request fail to write data back. ");
LABEL_44:
        _android_log_buf_print(1, 3, "RILC", "[VSIM] URC RIL_UNSOL_VSIM_OPERATION_INDICATION send");
        return _stack_chk_guard - v27;
      }
      v14 = (int (__fastcall **)(int *, int, int))((char *)&unk_12B48 + 12 * v8 + 4);
      sub_4EE8();
      android::Parcel::Parcel((android::Parcel *)&v23);
      android::Parcel::writeInt32((android::Parcel *)&v23, 1);
      android::Parcel::writeInt32((android::Parcel *)&v23, a1);
      if ( (*v14)(&v23, a2, a3) )
      {
        sub_6310();
      }
      else
      {
        v21 = j_requestToString(a1);
        v22 = android::Parcel::dataSize((android::Parcel *)&v23);
        v15 = "not a valid RIL";
        if ( a4 == 1 )
          v15 = "RIL_SOCKET_2";
        v16 = "RIL_SOCKET_1";
        if ( a4 )
          v16 = v15;
        _android_log_buf_print(1, 4, "RILC", "%s UNSOLICITED: %s length:%d", v16, v21, v22);
        v17 = (void *)android::Parcel::data((android::Parcel *)&v23);
        v18 = android::Parcel::dataSize((android::Parcel *)&v23);
        sub_A1E0(v17, v18, a4);
      }
      android::Parcel::~Parcel((android::Parcel *)&v23);
    }
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "NULL function pointer for unsolicited response (extension) %d", a1);
  }
  return _stack_chk_guard - v27;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 13020: using guessed type int dword_13020;

//----- (00005688) --------------------------------------------------------
int __fastcall RIL_requestTimedCallback_0(int a1, int a2, __int64 *a3)
{
  _DWORD *v6; // r0
  int v7; // r4
  __int64 v8; // r0
  __int64 v10; // [sp+8h] [bp-20h] BYREF

  v6 = calloc(1u, 0x30u);
  v7 = (int)v6;
  if ( v6 )
  {
    *v6 = a1;
    v6[1] = a2;
    if ( a3 )
      v8 = *a3;
    else
      v8 = 0LL;
    v10 = v8;
    ril_event_set(v7 + 8, -1, 0, (int)sub_AD0C, v7);
    ril_timer_add((int **)(v7 + 8), &v10);
    sub_A19C();
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed in internalRequestTimedCallback");
  }
  return v7;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// AD0C: using guessed type int sub_AD0C();

//----- (0000576C) --------------------------------------------------------
const char *__fastcall rilSocketIdToString(int a1)
{
  const char *v1; // r2
  const char *v2; // r1

  v1 = "not a valid RIL";
  if ( a1 == 1 )
    v1 = "RIL_SOCKET_2";
  v2 = "RIL_SOCKET_1";
  if ( a1 )
    return v1;
  return v2;
}

//----- (00005794) --------------------------------------------------------
const char *__fastcall requestToString(int a1)
{
  int v1; // r1
  const char *result; // r0

  if ( a1 >= 1000 )
  {
    switch ( a1 )
    {
      case 1000:
        result = "UNSOL_RESPONSE_RADIO_STATE_CHANGED";
        break;
      case 1001:
        result = "UNSOL_RESPONSE_CALL_STATE_CHANGED";
        break;
      case 1002:
        result = "UNSOL_RESPONSE_VOICE_NETWORK_STATE_CHANGED";
        break;
      case 1003:
        result = "UNSOL_RESPONSE_NEW_SMS";
        break;
      case 1004:
        result = "UNSOL_RESPONSE_NEW_SMS_STATUS_REPORT";
        break;
      case 1005:
        result = "UNSOL_RESPONSE_NEW_SMS_ON_SIM";
        break;
      case 1006:
        result = "UNSOL_ON_USSD";
        break;
      case 1007:
        result = "UNSOL_ON_USSD_REQUEST(obsolete)";
        break;
      case 1008:
        result = "UNSOL_NITZ_TIME_RECEIVED";
        break;
      case 1009:
        result = "UNSOL_SIGNAL_STRENGTH";
        break;
      case 1010:
        result = "UNSOL_DATA_CALL_LIST_CHANGED";
        break;
      case 1011:
        result = "UNSOL_SUPP_SVC_NOTIFICATION";
        break;
      case 1012:
        result = "UNSOL_STK_SESSION_END";
        break;
      case 1013:
        result = "UNSOL_STK_PROACTIVE_COMMAND";
        break;
      case 1014:
        result = "UNSOL_STK_EVENT_NOTIFY";
        break;
      case 1015:
        result = "UNSOL_STK_CALL_SETUP";
        break;
      case 1016:
        result = "UNSOL_SIM_SMS_STORAGE_FUL";
        break;
      case 1017:
        result = "UNSOL_SIM_REFRESH";
        break;
      case 1018:
        result = "UNSOL_CALL_RING";
        break;
      case 1019:
        result = "UNSOL_RESPONSE_SIM_STATUS_CHANGED";
        break;
      case 1020:
        result = "UNSOL_NEW_CDMA_SMS";
        break;
      case 1021:
        result = "UNSOL_NEW_BROADCAST_SMS";
        break;
      case 1022:
        result = "UNSOL_CDMA_RUIM_SMS_STORAGE_FULL";
        break;
      case 1023:
        result = "UNSOL_RESTRICTED_STATE_CHANGED";
        break;
      case 1024:
        result = "UNSOL_ENTER_EMERGENCY_CALLBACK_MODE";
        break;
      case 1025:
        result = "UNSOL_CDMA_CALL_WAITING";
        break;
      case 1026:
        result = "UNSOL_CDMA_OTA_PROVISION_STATUS";
        break;
      case 1027:
        result = "UNSOL_CDMA_INFO_REC";
        break;
      case 1028:
        result = "UNSOL_OEM_HOOK_RAW";
        break;
      case 1029:
        result = "UNSOL_RINGBACK_TONE";
        break;
      case 1030:
        result = "UNSOL_RESEND_INCALL_MUTE";
        break;
      case 1031:
        result = "UNSOL_CDMA_SUBSCRIPTION_SOURCE_CHANGED";
        break;
      case 1032:
        result = "UNSOL_CDMA_PRL_CHANGED";
        break;
      case 1033:
        result = "UNSOL_EXIT_EMERGENCY_CALLBACK_MODE";
        break;
      case 1034:
        result = "UNSOL_RIL_CONNECTED";
        break;
      case 1035:
        result = "UNSOL_VOICE_RADIO_TECH_CHANGED";
        break;
      case 1036:
        result = "UNSOL_CELL_INFO_LIST";
        break;
      case 1037:
        result = "RESPONSE_IMS_NETWORK_STATE_CHANGED";
        break;
      case 1038:
        result = "UNSOL_UICC_SUBSCRIPTION_STATUS_CHANGED";
        break;
      case 1039:
        result = "UNSOL_SRVCC_STATE_NOTIFY";
        break;
      case 1040:
        result = "HARDWARE_CONFIG_CHANGED";
        break;
      case 1041:
        result = "UNSOL_DC_RT_INFO_CHANGED";
        break;
      case 1042:
        result = "UNSOL_RADIO_CAPABILITY";
        break;
      case 1043:
        result = "UNSOL_ON_SS";
        break;
      case 1044:
        result = "UNSOL_STK_CC_ALPHA_NOTIFY";
        break;
      case 1045:
        result = "UNSOL_LCEDATA_RECV";
        break;
      default:
        switch ( a1 )
        {
          case 5001:
            result = "RIL_REQUEST_SWITCH_VOICE_CALL";
            break;
          case 5002:
            result = "RIL_REQUEST_QUERY_COLP";
            break;
          case 5003:
            result = "RIL_REQUEST_QUERY_COLR";
            break;
          case 5004:
            result = "RIL_REQUEST_GET_ALLOW_DATA_STATE";
            break;
          case 5005:
            result = "RIL_REQUEST_SIM_GET_ATR";
            break;
          case 5006:
            result = "RIL_REQUEST_SEND_ENCODED_USSD";
            break;
          case 5007:
            result = "RIL_REQUEST_SET_UPLMN";
            break;
          case 5008:
            result = "RIL_REQUEST_GET_UPLMN";
            break;
          case 5009:
            result = "RIL_REQUEST_READ_PB_ENTRY";
            break;
          case 5010:
            result = "RIL_REQUEST_UPDATE_PB_ENTRY";
            break;
          case 5011:
            result = "RIL_REQUEST_GET_PB_STORAGE_INFO";
            break;
          case 5012:
LABEL_222:
            result = "<unknown request>";
            break;
          case 5013:
            result = "RIL_REQUEST_GET_PB_ENTRY_INFO";
            break;
          case 5014:
            result = "RIL_REQUEST_GET_3G_PB_CAPA";
            break;
          case 5015:
            result = "RIL_REQUEST_SET_CALL_CONFIRM";
            break;
          case 5016:
            result = "RIL_REQUEST_SEND_CALL_CONFIRM";
            break;
          case 5017:
            result = "RIL_REQUEST_SET_DS_NETWORK_TYPE";
            break;
          case 5018:
            result = "RIL_REQUEST_SET_WBAMR_CAPABILITY";
            break;
          case 5019:
            result = "RIL_REQUEST_GET_WBAMR_CAPABILITY";
            break;
          case 5020:
            result = "RIL_REQUEST_GET_DUPLEX_MODE";
            break;
          case 5021:
            result = "RIL_REQUEST_SET_DUPLEX_MODE";
            break;
          case 5022:
            result = "RIL_LOCAL_REQUEST_VSIM_NOTIFICATION";
            break;
          case 5023:
            result = "RIL_LOCAL_REQUEST_VSIM_OPERATION";
            break;
          case 5024:
            result = "RIL_REQUEST_QUERY_AVAILABLE_EMERGENCY_CALL_STATUS";
            break;
          case 5025:
            result = "RIL_REQUEST_SET_EMERGENCY_CALL_STATUS";
            break;
          case 5026:
            result = "RIL_REQUEST_SET_FEMTO_CELL_SRCH";
            break;
          case 5027:
            result = "RIL_REQUEST_SET_CDMA_HYBRID_MODE";
            break;
          case 5028:
            result = "RIL_REQUEST_GET_CDMA_HYBRID_MODE";
            break;
          default:
            switch ( a1 )
            {
              case 6001:
                result = "RIL_UNSOL_SUPP_SVC_RETURN_RESULT";
                break;
              case 6002:
                result = "UNSOL_PB_READY";
                break;
              case 6003:
                result = "UNSOL_CALL_PRESENT_IND";
                break;
              case 6004:
                result = "RIL_UNSOL_WB_AMR_REPORT_IND";
                break;
              case 6005:
                result = "RIL_UNSOL_VSIM_OPERATION_INDICATION";
                break;
              case 6006:
                result = "RIL_UNSOL_NAS_TIMER_STATUS_IND";
                break;
              case 6007:
                result = "RIL_UNSOL_EMERGENCY_ACT_INFO";
                break;
              default:
                goto LABEL_222;
            }
            break;
        }
        break;
    }
  }
  else
  {
    v1 = a1 - 1;
    result = "GET_SIM_STATUS";
    switch ( v1 )
    {
      case 0:
        return result;
      case 1:
        result = "ENTER_SIM_PIN";
        break;
      case 2:
        result = "ENTER_SIM_PUK";
        break;
      case 3:
        result = "ENTER_SIM_PIN2";
        break;
      case 4:
        result = "ENTER_SIM_PUK2";
        break;
      case 5:
        result = "CHANGE_SIM_PIN";
        break;
      case 6:
        result = "CHANGE_SIM_PIN2";
        break;
      case 7:
        result = "ENTER_NETWORK_DEPERSONALIZATION";
        break;
      case 8:
        result = "GET_CURRENT_CALLS";
        break;
      case 9:
        result = "DIAL";
        break;
      case 10:
        result = "GET_IMSI";
        break;
      case 11:
        result = "HANGUP";
        break;
      case 12:
        result = "HANGUP_WAITING_OR_BACKGROUND";
        break;
      case 13:
        result = "HANGUP_FOREGROUND_RESUME_BACKGROUND";
        break;
      case 14:
        result = "SWITCH_WAITING_OR_HOLDING_AND_ACTIVE";
        break;
      case 15:
        result = "CONFERENCE";
        break;
      case 16:
        result = "UDUB";
        break;
      case 17:
        result = "LAST_CALL_FAIL_CAUSE";
        break;
      case 18:
        result = "SIGNAL_STRENGTH";
        break;
      case 19:
        result = "VOICE_REGISTRATION_STATE";
        break;
      case 20:
        result = "DATA_REGISTRATION_STATE";
        break;
      case 21:
        result = "OPERATOR";
        break;
      case 22:
        result = "RADIO_POWER";
        break;
      case 23:
        result = "DTMF";
        break;
      case 24:
        result = "SEND_SMS";
        break;
      case 25:
        result = "SEND_SMS_EXPECT_MORE";
        break;
      case 26:
        result = "SETUP_DATA_CALL";
        break;
      case 27:
        result = "SIM_IO";
        break;
      case 28:
        result = "SEND_USSD";
        break;
      case 29:
        result = "CANCEL_USSD";
        break;
      case 30:
        result = "GET_CLIR";
        break;
      case 31:
        result = "SET_CLIR";
        break;
      case 32:
        result = "QUERY_CALL_FORWARD_STATUS";
        break;
      case 33:
        result = "SET_CALL_FORWARD";
        break;
      case 34:
        result = "QUERY_CALL_WAITING";
        break;
      case 35:
        result = "SET_CALL_WAITING";
        break;
      case 36:
        result = "SMS_ACKNOWLEDGE";
        break;
      case 37:
        result = "GET_IMEI";
        break;
      case 38:
        result = "GET_IMEISV";
        break;
      case 39:
        result = "ANSWER";
        break;
      case 40:
        result = "DEACTIVATE_DATA_CALL";
        break;
      case 41:
        result = "QUERY_FACILITY_LOCK";
        break;
      case 42:
        result = "SET_FACILITY_LOCK";
        break;
      case 43:
        result = "CHANGE_BARRING_PASSWORD";
        break;
      case 44:
        result = "QUERY_NETWORK_SELECTION_MODE";
        break;
      case 45:
        result = "SET_NETWORK_SELECTION_AUTOMATIC";
        break;
      case 46:
        result = "SET_NETWORK_SELECTION_MANUAL";
        break;
      case 47:
        result = "QUERY_AVAILABLE_NETWORKS ";
        break;
      case 48:
        result = "DTMF_START";
        break;
      case 49:
        result = "DTMF_STOP";
        break;
      case 50:
        result = "BASEBAND_VERSION";
        break;
      case 51:
        result = "SEPARATE_CONNECTION";
        break;
      case 52:
        result = "SET_MUTE";
        break;
      case 53:
        result = "GET_MUTE";
        break;
      case 54:
        result = "QUERY_CLIP";
        break;
      case 55:
        result = "LAST_DATA_CALL_FAIL_CAUSE";
        break;
      case 56:
        result = "DATA_CALL_LIST";
        break;
      case 57:
        result = "RESET_RADIO";
        break;
      case 58:
        result = "OEM_HOOK_RAW";
        break;
      case 59:
        result = "OEM_HOOK_STRINGS";
        break;
      case 60:
        result = "SCREEN_STATE";
        break;
      case 61:
        result = "SET_SUPP_SVC_NOTIFICATION";
        break;
      case 62:
        result = "WRITE_SMS_TO_SIM";
        break;
      case 63:
        result = "DELETE_SMS_ON_SIM";
        break;
      case 64:
        result = "SET_BAND_MODE";
        break;
      case 65:
        result = "QUERY_AVAILABLE_BAND_MODE";
        break;
      case 66:
        result = "STK_GET_PROFILE";
        break;
      case 67:
        result = "STK_SET_PROFILE";
        break;
      case 68:
        result = "STK_SEND_ENVELOPE_COMMAND";
        break;
      case 69:
        result = "STK_SEND_TERMINAL_RESPONSE";
        break;
      case 70:
        result = "STK_HANDLE_CALL_SETUP_REQUESTED_FROM_SIM";
        break;
      case 71:
        result = "EXPLICIT_CALL_TRANSFER";
        break;
      case 72:
        result = "SET_PREFERRED_NETWORK_TYPE";
        break;
      case 73:
        result = "GET_PREFERRED_NETWORK_TYPE";
        break;
      case 74:
        result = "GET_NEIGHBORING_CELL_IDS";
        break;
      case 75:
        result = "SET_LOCATION_UPDATES";
        break;
      case 76:
        result = "CDMA_SET_SUBSCRIPTION_SOURCE";
        break;
      case 77:
        result = "CDMA_SET_ROAMING_PREFERENCE";
        break;
      case 78:
        result = "CDMA_QUERY_ROAMING_PREFERENCE";
        break;
      case 79:
        result = "SET_TTY_MODE";
        break;
      case 80:
        result = "QUERY_TTY_MODE";
        break;
      case 81:
        result = "CDMA_SET_PREFERRED_VOICE_PRIVACY_MODE";
        break;
      case 82:
        result = "CDMA_QUERY_PREFERRED_VOICE_PRIVACY_MODE";
        break;
      case 83:
        result = "CDMA_FLASH";
        break;
      case 84:
        result = "CDMA_BURST_DTMF";
        break;
      case 85:
        result = "CDMA_VALIDATE_AND_WRITE_AKEY";
        break;
      case 86:
        result = "CDMA_SEND_SMS";
        break;
      case 87:
        result = "CDMA_SMS_ACKNOWLEDGE";
        break;
      case 88:
        result = "GSM_GET_BROADCAST_SMS_CONFIG";
        break;
      case 89:
        result = "GSM_SET_BROADCAST_SMS_CONFIG";
        break;
      case 90:
        result = "GSM_SMS_BROADCAST_ACTIVATION";
        break;
      case 91:
        result = "CDMA_GET_BROADCAST_SMS_CONFIG";
        break;
      case 92:
        result = "CDMA_SET_BROADCAST_SMS_CONFIG";
        break;
      case 93:
        result = "CDMA_SMS_BROADCAST_ACTIVATION";
        break;
      case 94:
        result = "CDMA_SUBSCRIPTION";
        break;
      case 95:
        result = "CDMA_WRITE_SMS_TO_RUIM";
        break;
      case 96:
        result = "CDMA_DELETE_SMS_ON_RUIM";
        break;
      case 97:
        result = "DEVICE_IDENTITY";
        break;
      case 98:
        result = "EXIT_EMERGENCY_CALLBACK_MODE";
        break;
      case 99:
        result = "GET_SMSC_ADDRESS";
        break;
      case 100:
        result = "SET_SMSC_ADDRESS";
        break;
      case 101:
        result = "REPORT_SMS_MEMORY_STATUS";
        break;
      case 102:
        result = "REPORT_STK_SERVICE_IS_RUNNING";
        break;
      case 103:
        result = "CDMA_GET_SUBSCRIPTION_SOURCE";
        break;
      case 104:
        result = "ISIM_AUTHENTICATION";
        break;
      case 105:
        result = "RIL_REQUEST_ACKNOWLEDGE_INCOMING_GSM_SMS_WITH_PDU";
        break;
      case 106:
        result = "RIL_REQUEST_STK_SEND_ENVELOPE_WITH_STATUS";
        break;
      case 107:
        result = "VOICE_RADIO_TECH";
        break;
      case 108:
        result = "GET_CELL_INFO_LIST";
        break;
      case 109:
        result = "SET_UNSOL_CELL_INFO_LIST_RATE";
        break;
      case 110:
        result = "RIL_REQUEST_SET_INITIAL_ATTACH_APN";
        break;
      case 111:
        result = "IMS_REGISTRATION_STATE";
        break;
      case 112:
        result = "IMS_SEND_SMS";
        break;
      case 113:
        result = "SIM_TRANSMIT_APDU_BASIC";
        break;
      case 114:
        result = "SIM_OPEN_CHANNEL";
        break;
      case 115:
        result = "SIM_CLOSE_CHANNEL";
        break;
      case 116:
        result = "SIM_TRANSMIT_APDU_CHANNEL";
        break;
      case 117:
        result = "NV_READ_ITEM";
        break;
      case 118:
        result = "NV_WRITE_ITEM";
        break;
      case 119:
        result = "NV_WRITE_CDMA_PRL";
        break;
      case 120:
        result = "NV_RESET_CONFIG";
        break;
      case 121:
        result = "SET_UICC_SUBSCRIPTION";
        break;
      case 122:
        result = "ALLOW_DATA";
        break;
      case 123:
        result = "GET_HARDWARE_CONFIG";
        break;
      case 124:
        result = "SIM_AUTHENTICATION";
        break;
      case 125:
        result = "GET_DC_RT_INFO";
        break;
      case 126:
        result = "SET_DC_RT_INFO_RATE";
        break;
      case 127:
        result = "SET_DATA_PROFILE";
        break;
      case 128:
        result = "SHUTDOWN";
        break;
      case 129:
        result = "RIL_REQUEST_GET_RADIO_CAPABILITY";
        break;
      case 130:
        result = "RIL_REQUEST_SET_RADIO_CAPABILITY";
        break;
      case 131:
        result = "RIL_REQUEST_START_LCE";
        break;
      case 132:
        result = "RIL_REQUEST_STOP_LCE";
        break;
      case 133:
        result = "RIL_REQUEST_PULL_LCEDATA";
        break;
      case 134:
        result = "RIL_REQUEST_GET_ACTIVITY_INFO";
        break;
      default:
        if ( "GET_SIM_STATUS" != (char *)&stru_320 )
          goto LABEL_222;
        result = "RIL_RESPONSE_ACKNOWLEDGEMENT";
        break;
    }
  }
  return result;
}
// 320: using guessed type Elf32_Sym;

//----- (00006310) --------------------------------------------------------
int sub_6310()
{
  if ( android::s_callbacks < 13 )
    return j_release_wake_lock();
  pthread_mutex_lock((pthread_mutex_t *)&unk_13978);
  if ( android::s_wakelock_count < 2 )
  {
    android::s_wakelock_count = 0;
    release_wake_lock("radio-interface");
    if ( dword_13928 )
      *(_DWORD *)(dword_13928 + 4) = 1;
  }
  else
  {
    --android::s_wakelock_count;
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_13978);
}
// 3134: using guessed type int __fastcall release_wake_lock(_DWORD);
// 137F8: using guessed type int android::s_callbacks;
// 13810: using guessed type int android::s_wakelock_count;
// 13928: using guessed type int dword_13928;

//----- (00006398) --------------------------------------------------------
const char *__fastcall failCauseToString(int a1)
{
  const char *result; // r0

  result = "E_SUCCESS";
  switch ( a1 )
  {
    case 0:
      return result;
    case 1:
      result = "E_RADIO_NOT_AVAILABLE";
      break;
    case 2:
      result = "E_GENERIC_FAILURE";
      break;
    case 3:
      result = "E_PASSWORD_INCORRECT";
      break;
    case 4:
      result = "E_SIM_PIN2";
      break;
    case 5:
      result = "E_SIM_PUK2";
      break;
    case 6:
      result = "E_REQUEST_NOT_SUPPORTED";
      break;
    case 7:
      result = "E_CANCELLED";
      break;
    case 8:
      result = "E_OP_NOT_ALLOWED_DURING_VOICE_CALL";
      break;
    case 9:
      result = "E_OP_NOT_ALLOWED_BEFORE_REG_TO_NW";
      break;
    case 10:
      result = "E_SMS_SEND_FAIL_RETRY";
      break;
    case 11:
      result = "E_SIM_ABSENT";
      break;
    case 12:
    case 13:
    case 28:
    case 29:
    case 30:
    case 31:
    case 32:
    case 33:
    case 34:
    case 35:
LABEL_5:
      result = "<unknown error>";
      break;
    case 14:
      result = "E_FDN_CHECK_FAILURE";
      break;
    case 15:
      result = "E_ILLEGAL_SIM_OR_ME";
      break;
    case 16:
      result = "E_MISSING_RESOURCE";
      break;
    case 17:
      result = "E_NO_SUCH_ELEMENT";
      break;
    case 18:
      result = "E_DIAL_MODIFIED_TO_USSD";
      break;
    case 19:
      result = "E_DIAL_MODIFIED_TO_SS";
      break;
    case 20:
      result = "E_DIAL_MODIFIED_TO_DIAL";
      break;
    case 21:
      result = "E_USSD_MODIFIED_TO_DIAL";
      break;
    case 22:
      result = "E_USSD_MODIFIED_TO_SS";
      break;
    case 23:
      result = "E_USSD_MODIFIED_TO_USSD";
      break;
    case 24:
      result = "E_SS_MODIFIED_TO_DIAL";
      break;
    case 25:
      result = "E_SS_MODIFIED_TO_USSD";
      break;
    case 26:
      result = "E_SUBSCRIPTION_NOT_SUPPORTED";
      break;
    case 27:
      result = "E_SS_MODIFIED_TO_SS";
      break;
    case 36:
      result = "E_LCE_NOT_SUPPORTED";
      break;
    case 37:
      result = "E_NO_MEMORY";
      break;
    case 38:
      result = "E_INTERNAL_ERR";
      break;
    case 39:
      result = "E_SYSTEM_ERR";
      break;
    case 40:
      result = "E_MODEM_ERR";
      break;
    case 41:
      result = "E_INVALID_STATE";
      break;
    case 42:
      result = "E_NO_RESOURCES";
      break;
    case 43:
      result = "E_SIM_ERR";
      break;
    case 44:
      result = "E_INVALID_ARGUMENTS";
      break;
    case 45:
      result = "E_INVALID_SIM_STATE";
      break;
    case 46:
      result = "E_INVALID_MODEM_STATE";
      break;
    case 47:
      result = "E_INVALID_CALL_ID";
      break;
    case 48:
      result = "E_NO_SMS_TO_ACK";
      break;
    case 49:
      result = "E_NETWORK_ERR";
      break;
    case 50:
      result = "E_REQUEST_RATE_LIMITED";
      break;
    case 51:
      result = "E_SIM_BUSY";
      break;
    case 52:
      result = "E_SIM_FULL";
      break;
    case 53:
      result = "E_NETWORK_REJECT";
      break;
    case 54:
      result = "E_OPERATION_NOT_ALLOWED";
      break;
    case 55:
    case 56:
      result = "E_INVALID_SMS_FORMAT";
      break;
    case 57:
      result = "E_ENCODING_ERR";
      break;
    case 58:
      result = "E_INVALID_SMSC_ADDRESS";
      break;
    case 59:
      result = "E_NO_SUCH_ENTRY";
      break;
    case 60:
      result = "E_NETWORK_NOT_READY";
      break;
    case 61:
      result = "E_NOT_PROVISIONED";
      break;
    case 62:
      result = "E_NO_SUBSCRIPTION";
      break;
    case 63:
      result = "E_NO_NETWORK_FOUND";
      break;
    case 64:
      result = "E_DEVICE_IN_USE";
      break;
    case 65:
      result = "E_ABORTED";
      break;
    default:
      switch ( a1 )
      {
        case 501:
          result = "E_OEM_ERROR_1";
          break;
        case 502:
          result = "E_OEM_ERROR_2";
          break;
        case 503:
          result = "E_OEM_ERROR_3";
          break;
        case 504:
          result = "E_OEM_ERROR_4";
          break;
        case 505:
          result = "E_OEM_ERROR_5";
          break;
        case 506:
          result = "E_OEM_ERROR_6";
          break;
        case 507:
          result = "E_OEM_ERROR_7";
          break;
        case 508:
          result = "E_OEM_ERROR_8";
          break;
        case 509:
          result = "E_OEM_ERROR_9";
          break;
        case 510:
          result = "E_OEM_ERROR_10";
          break;
        case 511:
          result = "E_OEM_ERROR_11";
          break;
        case 512:
          result = "E_OEM_ERROR_12";
          break;
        case 513:
          result = "E_OEM_ERROR_13";
          break;
        case 514:
          result = "E_OEM_ERROR_14";
          break;
        case 515:
          result = "E_OEM_ERROR_15";
          break;
        case 516:
          result = "E_OEM_ERROR_16";
          break;
        case 517:
          result = "E_OEM_ERROR_17";
          break;
        case 518:
          result = "E_OEM_ERROR_18";
          break;
        case 519:
          result = "E_OEM_ERROR_19";
          break;
        case 520:
          result = "E_OEM_ERROR_20";
          break;
        case 521:
          result = "E_OEM_ERROR_21";
          break;
        case 522:
          result = "E_OEM_ERROR_22";
          break;
        case 523:
          result = "E_OEM_ERROR_23";
          break;
        case 524:
          result = "E_OEM_ERROR_24";
          break;
        case 525:
          result = "E_OEM_ERROR_25";
          break;
        default:
          goto LABEL_5;
      }
      break;
  }
  return result;
}

//----- (00006790) --------------------------------------------------------
const char *__fastcall radioStateToString(unsigned int a1)
{
  if ( a1 > 0xA )
    return "<unknown state>";
  else
    return off_12BB0[a1];
}
// 12BB0: using guessed type char *off_12BB0[11];

//----- (000067AC) --------------------------------------------------------
const char *__fastcall callStateToString(unsigned int a1)
{
  if ( a1 > 5 )
    return "<unknown state>";
  else
    return off_12BE0[a1];
}
// 12BE0: using guessed type char *off_12BE0[6];

//----- (000067C8) --------------------------------------------------------
int __fastcall rilEventAddWakeup_helper(int a1)
{
  ril_event_add(a1);
  return sub_A19C();
}

//----- (000067DC) --------------------------------------------------------
int __fastcall listenCallback_helper(int a1, __int16 a2, void *a3)
{
  int v4; // r5
  _DWORD *v5; // r0
  _DWORD *v6; // r6
  struct passwd *v7; // r0
  const char *pw_name; // r7
  int v10; // r4
  const char *v11; // r1
  socklen_t optlen; // [sp+8h] [bp-A0h] BYREF
  char optval[4]; // [sp+Ch] [bp-9Ch] BYREF
  __uid_t uid; // [sp+10h] [bp-98h]
  socklen_t addr_len; // [sp+18h] [bp-90h] BYREF
  int v16; // [sp+1Ch] [bp-8Ch] BYREF
  struct sockaddr addr; // [sp+20h] [bp-88h] BYREF
  int v18; // [sp+90h] [bp-18h]

  addr_len = 110;
  optlen = 12;
  v4 = accept(a1, &addr, &addr_len);
  v5 = (_DWORD *)_errno(v4);
  v6 = v5;
  if ( v4 <= -1 )
  {
    _android_log_buf_print(1, 6, "RILC", "Error on accept() errno:%d", *v5);
LABEL_11:
    ril_event_add(*((_DWORD *)a3 + 5));
    sub_A19C();
    return _stack_chk_guard - v18;
  }
  *v5 = 0;
  if ( getsockopt(v4, 1, 17, optval, &optlen) || (int)optlen < 1 )
  {
    _android_log_buf_print(1, 6, "RILC", "Error on getsockopt() errno: %d", *v6);
    goto LABEL_10;
  }
  *v6 = 0;
  v7 = getpwuid(uid);
  if ( !v7 )
  {
    _android_log_buf_print(1, 6, "RILC", "Error on getpwuid() errno: %d", *v6);
    goto LABEL_10;
  }
  pw_name = v7->pw_name;
  if ( strcmp(v7->pw_name, "radio") )
  {
    _android_log_buf_print(1, 6, "RILC", "RILD can't accept socket from process %s", pw_name);
LABEL_10:
    _android_log_buf_print(1, 6, "RILC", "RILD must accept socket from %s", "radio");
    close(v4);
    sub_6A70(*(_DWORD *)a3);
    goto LABEL_11;
  }
  if ( fcntl(v4, 4, 2048) <= -1 )
    _android_log_buf_print(1, 6, "RILC", "Error setting O_NONBLOCK errno:%d", *v6);
  *((_DWORD *)a3 + 2) = v4;
  *((_DWORD *)a3 + 7) = record_stream_new(v4, 0x2000);
  ril_event_set(*((_DWORD *)a3 + 4), *((_DWORD *)a3 + 2), 1, *((_DWORD *)a3 + 6), (int)a3);
  ril_event_add(*((_DWORD *)a3 + 4));
  sub_A19C();
  v10 = *(_DWORD *)a3;
  v16 = android::s_callbacks;
  j_RIL_onUnsolicitedResponse(1034, (int)&v16, 4, v10);
  j_RIL_onUnsolicitedResponse(1000, 0, 0, v10);
  if ( dword_1392C )
  {
    sub_A1E0((void *)dword_1392C, dword_13930, v10);
    free((void *)dword_1392C);
    dword_1392C = 0;
  }
  if ( dword_1380C )
  {
    v11 = (const char *)dword_1380C();
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "RIL Daemon version: unavailable\n");
    v11 = "unavailable";
  }
  property_set("gsm.version.ril-impl", v11);
  return _stack_chk_guard - v18;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int __fastcall _errno(_DWORD);
// 31A0: using guessed type int __fastcall record_stream_new(_DWORD, _DWORD);
// 31AC: using guessed type int __fastcall property_set(_DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;
// 1380C: using guessed type int (*dword_1380C)(void);
// 1392C: using guessed type int dword_1392C;
// 13930: using guessed type int dword_13930;
// 67DC: using guessed type char optval[4];

//----- (000069FC) --------------------------------------------------------
int sub_69FC()
{
  int chk; // r0
  char v2[16]; // [sp+4h] [bp-24h] BYREF
  int v3; // [sp+14h] [bp-14h]

  _android_log_buf_print(1, 4, "RILC", "processWakeupCallback");
  do
  {
    do
      chk = _read_chk(dword_13934, v2, 16, 16);
    while ( chk > 0 );
  }
  while ( chk <= -1 && *(_DWORD *)_errno() == 4 );
  return _stack_chk_guard - v3;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int _errno(void);
// 31B8: using guessed type int __fastcall _read_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 13934: using guessed type int dword_13934;
// 69FC: using guessed type char var_24[16];

//----- (00006A70) --------------------------------------------------------
int __fastcall sub_6A70(int a1)
{
  pthread_mutex_t *v2; // r4
  int *v3; // r1
  int i; // r0

  v2 = (pthread_mutex_t *)&unk_13960;
  if ( a1 == 1 )
    v2 = (pthread_mutex_t *)&unk_13968;
  pthread_mutex_lock(v2);
  v3 = (int *)&unk_13964;
  if ( a1 == 1 )
    v3 = &dword_1396C;
  for ( i = *v3; i; i = *(_DWORD *)(i + 8) )
    *(_BYTE *)(i + 12) = 1;
  return j_pthread_mutex_unlock(v2);
}
// 1396C: using guessed type int dword_1396C;

//----- (00006AC0) --------------------------------------------------------
size_t __fastcall sub_6AC0(android::Parcel *this, __int64 *a2)
{
  int v4; // r7
  _DWORD *v5; // r6
  int v6; // r4
  int v7; // r0
  __int64 v8; // kr00_8
  const char *v9; // r0
  const char *v11; // [sp+0h] [bp-30h]
  int v12; // [sp+8h] [bp-28h] BYREF
  size_t nmemb[9]; // [sp+Ch] [bp-24h] BYREF

  if ( android::Parcel::readInt32(this, (int *)nmemb) || (v4 = nmemb[0], (int)nmemb[0] < 1) )
  {
LABEL_11:
    v8 = *a2;
    v9 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v8, v9);
    return _stack_chk_guard - nmemb[1];
  }
  v5 = calloc(nmemb[0], 4u);
  if ( v5 )
  {
    if ( v4 >= 1 )
    {
      v6 = 0;
      while ( 1 )
      {
        v7 = android::Parcel::readInt32(this, &v12);
        v5[v6] = v12;
        if ( v7 )
          break;
        if ( ++v6 >= (int)nmemb[0] )
          goto LABEL_8;
      }
      free(v5);
      goto LABEL_11;
    }
LABEL_8:
    dword_137FC(**((_DWORD **)a2 + 1), v5, 4 * v4);
    free(v5);
  }
  else
  {
    v11 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v11);
  }
  return _stack_chk_guard - nmemb[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00006BA8) --------------------------------------------------------
int sub_6BA8()
{
  return 0;
}

//----- (00006BAC) --------------------------------------------------------
int __fastcall sub_6BAC(int a1, int a2)
{
  return dword_137FC(**(_DWORD **)(a2 + 4), 0, 0);
}
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00006BD4) --------------------------------------------------------
int __fastcall sub_6BD4(android::Parcel *this, int *a2, unsigned int a3)
{
  int *v3; // r4
  int result; // r0
  unsigned int v7; // r6
  int v8; // t1

  v3 = a2;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( (a3 & 3) != 0 )
  {
    _android_log_buf_print(1, 6, "RILC", "responseInts: invalid response length %d expected multiple of %d\n", a3, 4);
    return -1;
  }
  v7 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  result = 0;
  if ( a3 >> 2 )
  {
    do
    {
      v8 = *v3++;
      android::Parcel::writeInt32(this, v8);
      --v7;
    }
    while ( v7 );
    return 0;
  }
  return result;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00006C44) --------------------------------------------------------
int __fastcall sub_6C44(int a1, int a2)
{
  sub_72AC(a1, a2);
  return 0;
}

//----- (00006C50) --------------------------------------------------------
unsigned int __fastcall sub_6C50(android::Parcel *this, __int64 *a2)
{
  __int64 v4; // kr00_8
  const char *v5; // r0
  size_t v6; // r7
  _DWORD *v7; // r4
  int v8; // r8
  signed int v9; // r5
  int String16Inplace; // r0
  signed int i; // r6
  void *v12; // r5
  void *v13; // r0
  const char *v15; // [sp+0h] [bp-30h]
  size_t nmemb; // [sp+8h] [bp-28h] BYREF
  unsigned int v17[9]; // [sp+Ch] [bp-24h] BYREF

  if ( android::Parcel::readInt32(this, (int *)&nmemb) )
  {
    v4 = *a2;
    v5 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v4, v5);
    return _stack_chk_guard - v17[1];
  }
  v6 = nmemb;
  if ( !nmemb )
  {
    v7 = calloc(1u, 4u);
    if ( v7 )
    {
      v8 = 0;
      goto LABEL_12;
    }
    goto LABEL_21;
  }
  if ( (nmemb & 0x80000000) != 0 )
  {
    v8 = 0;
    v7 = 0;
    goto LABEL_12;
  }
  v7 = calloc(nmemb, 4u);
  if ( !v7 )
  {
LABEL_21:
    v15 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v15);
    return _stack_chk_guard - v17[1];
  }
  v8 = 4 * v6;
  v9 = 0;
  do
  {
    String16Inplace = android::Parcel::readString16Inplace(this, v17);
    v7[v9++] = strndup16to8(String16Inplace, v17[0]);
  }
  while ( v9 < (int)nmemb );
LABEL_12:
  dword_137FC(**((_DWORD **)a2 + 1), v7, v8);
  if ( v7 )
  {
    if ( (int)nmemb > 0 )
    {
      for ( i = 0; i < (int)nmemb; ++i )
      {
        v12 = (void *)v7[i];
        if ( v12 )
        {
          memset(v12, 0, _strlen_chk(v7[i], -1));
          v13 = (void *)v7[i];
        }
        else
        {
          v13 = 0;
        }
        free(v13);
      }
    }
    free(v7);
  }
  return _stack_chk_guard - v17[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00006DA4) --------------------------------------------------------
int __fastcall sub_6DA4(android::Parcel *this, int *a2, unsigned int a3)
{
  int *v3; // r5
  int v6; // r8
  unsigned int v8; // r7
  int v9; // t1

  v3 = a2;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( (a3 & 3) != 0 )
  {
    _android_log_buf_print(1, 6, "RILC", "responseStrings: invalid response length %d expected multiple of %d\n", a3, 4);
    return -1;
  }
  if ( a2 )
  {
    v8 = a3 >> 2;
    android::Parcel::writeInt32(this, a3 >> 2);
    v6 = 0;
    if ( a3 >> 2 )
    {
      do
      {
        v9 = *v3++;
        sub_72AC((int)this, v9);
        --v8;
      }
      while ( v8 );
      return 0;
    }
  }
  else
  {
    v6 = 0;
    android::Parcel::writeInt32(this, 0);
  }
  return v6;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00006E30) --------------------------------------------------------
int __fastcall sub_6E30(android::Parcel *this, int *a2, int a3)
{
  int v6; // r1
  int result; // r0
  int v8; // r1
  unsigned int v9; // r6
  int *v10; // r5
  int v11; // r0

  if ( !a2 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  android::Parcel::writeInt32(this, *a2);
  android::Parcel::writeInt32(this, a2[1]);
  v6 = *a2;
  result = 0;
  if ( (unsigned int)*a2 <= 0xB )
  {
    if ( ((1 << v6) & 0x137) != 0 )
    {
      android::Parcel::writeInt32(this, a2[2]);
      android::Parcel::writeInt32(this, a2[3]);
      sub_72AC((int)this, a2[4]);
      android::Parcel::writeInt32(this, a2[5]);
      android::Parcel::writeInt32(this, a2[6]);
      v8 = a2[7];
LABEL_8:
      sub_72AC((int)this, v8);
      return 0;
    }
    if ( ((1 << v6) & 0xC00) != 0 )
    {
      android::Parcel::writeInt32(this, a2[2]);
      android::Parcel::writeInt32(this, a2[3]);
      v8 = a2[4];
      goto LABEL_8;
    }
    if ( v6 == 9 )
    {
      v9 = a3 - 8;
      if ( v9 < 9 )
        return 0;
      v10 = (int *)a2[2];
      do
      {
        android::Parcel::writeInt32(this, *v10);
        android::Parcel::writeInt32(this, v10[1]);
        android::Parcel::writeInt32(this, v10[2]);
        sub_72AC((int)this, v10[3]);
        v11 = v10[1];
        v10 += 4;
        v9 = v9 - 12 - v11;
        result = 0;
      }
      while ( v9 > 8 );
    }
  }
  return result;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00006F08) --------------------------------------------------------
unsigned int __fastcall sub_6F08(android::Parcel *this, __int64 *a2)
{
  unsigned int v4; // r7
  int v5; // r0
  int v6; // r4
  int v7; // r6
  int String16Inplace; // r0
  int v9; // r4
  int v10; // r0
  int v11; // r4
  int v12; // r0
  void *v13; // r0
  int *v14; // r10
  int v15; // r0
  int v16; // r0
  __int64 v17; // kr00_8
  const char *v18; // r0
  void *v20; // r4
  __int64 v21; // [sp+8h] [bp-70h] BYREF
  __int64 v22; // [sp+10h] [bp-68h]
  __int64 v23; // [sp+18h] [bp-60h]
  __int64 v24; // [sp+20h] [bp-58h]
  int v25; // [sp+28h] [bp-50h]
  void *ptr; // [sp+2Ch] [bp-4Ch]
  int v27; // [sp+34h] [bp-44h] BYREF
  unsigned int v28[16]; // [sp+38h] [bp-40h] BYREF

  v23 = 0LL;
  v24 = 0LL;
  v25 = 0;
  ptr = 0;
  android::Parcel::readInt32(this, &v27);
  LODWORD(v21) = v27;
  android::Parcel::readInt32(this, &v27);
  v4 = v27;
  HIDWORD(v21) = v27;
  android::Parcel::readInt32(this, &v27);
  LODWORD(v22) = v27;
  v5 = android::Parcel::readInt32(this, &v27);
  v6 = v27;
  v7 = v5;
  HIDWORD(v22) = v27;
  if ( v4 > 0xB )
    goto LABEL_15;
  if ( ((1 << v4) & 0x137) != 0 )
  {
    android::Parcel::readInt32(this, &v27);
    LODWORD(v23) = v27;
    android::Parcel::readInt32(this, &v27);
    HIDWORD(v23) = v27;
    String16Inplace = android::Parcel::readString16Inplace(this, v28);
    LODWORD(v24) = strndup16to8(String16Inplace, v28[0]);
    android::Parcel::readInt32(this, &v27);
    HIDWORD(v24) = v27;
    v9 = android::Parcel::readInt32(this, &v27);
    v25 = v27;
    v10 = android::Parcel::readString16Inplace(this, v28);
    ptr = (void *)strndup16to8(v10, v28[0]);
    if ( !v9 )
    {
      dword_137FC(**((_DWORD **)a2 + 1), &v21, 40);
      if ( ptr )
        memset(ptr, 0, _strlen_chk(ptr, -1));
      if ( (_DWORD)v24 )
        memset((void *)v24, 0, _strlen_chk(v24, -1));
      free(ptr);
      goto LABEL_13;
    }
LABEL_21:
    v17 = *a2;
    v18 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v17, v18);
    return _stack_chk_guard - v28[1];
  }
  if ( ((1 << v4) & 0xC00) == 0 )
  {
    if ( v4 != 9 )
      goto LABEL_15;
    if ( v27 >= 1 )
    {
      v14 = 0;
      do
      {
        android::Parcel::readInt32(this, &v27);
        *v14 = v27;
        android::Parcel::readInt32(this, &v27);
        v14[1] = v27;
        v7 = android::Parcel::readInt32(this, &v27);
        v14[2] = v27;
        v15 = android::Parcel::readString16Inplace(this, v28);
        v14[3] = strndup16to8(v15, v28[0]);
        v16 = v14[1] + 12;
        v6 -= v16;
        v14 = (int *)((char *)v14 + v16);
      }
      while ( v6 > 0 );
    }
    if ( v7 )
      goto LABEL_21;
    dword_137FC(**((_DWORD **)a2 + 1), &v21, 40);
    v20 = *(void **)(v23 + 12);
    if ( v20 )
    {
      memset(v20, 0, _strlen_chk(*(_DWORD *)(v23 + 12), -1));
      v13 = *(void **)(v23 + 12);
      goto LABEL_14;
    }
LABEL_25:
    v13 = 0;
    goto LABEL_14;
  }
  android::Parcel::readInt32(this, &v27);
  LODWORD(v23) = v27;
  v11 = android::Parcel::readInt32(this, &v27);
  HIDWORD(v23) = v27;
  v12 = android::Parcel::readString16Inplace(this, v28);
  LODWORD(v24) = strndup16to8(v12, v28[0]);
  if ( v11 )
    goto LABEL_21;
  dword_137FC(**((_DWORD **)a2 + 1), &v21, 40);
  if ( !(_DWORD)v24 )
    goto LABEL_25;
  memset((void *)v24, 0, _strlen_chk(v24, -1));
LABEL_13:
  v13 = (void *)v24;
LABEL_14:
  free(v13);
LABEL_15:
  v21 = 0LL;
  v22 = 0LL;
  v23 = 0LL;
  v24 = 0LL;
  v25 = 0;
  ptr = 0;
  return _stack_chk_guard - v28[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (000071A8) --------------------------------------------------------
unsigned int __fastcall sub_71A8(android::Parcel *this, __int64 *a2)
{
  int v4; // r0
  int v5; // r0
  int v6; // r0
  int v7; // r0
  __int64 v8; // kr00_8
  const char *v9; // r0
  int String16Inplace; // r0
  void *v12; // r0
  int v13; // [sp+Ch] [bp-44h] BYREF
  __int64 v14; // [sp+10h] [bp-40h] BYREF
  __int64 v15; // [sp+18h] [bp-38h]
  void *ptr; // [sp+20h] [bp-30h]
  unsigned int v17[10]; // [sp+28h] [bp-28h] BYREF

  v14 = 0LL;
  v15 = 0LL;
  ptr = 0;
  v4 = android::Parcel::readInt32(this, &v13);
  LODWORD(v14) = v13;
  if ( v4
    || (v5 = android::Parcel::readInt32(this, &v13), HIDWORD(v14) = v13, v5)
    || (v6 = android::Parcel::readInt32(this, &v13), LODWORD(v15) = v13, v6)
    || (v7 = android::Parcel::readInt32(this, &v13), HIDWORD(v15) = v13, v7) )
  {
    v8 = *a2;
    v9 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v8, v9);
  }
  else
  {
    String16Inplace = android::Parcel::readString16Inplace(this, v17);
    ptr = (void *)strndup16to8(String16Inplace, v17[0]);
    dword_137FC(**((_DWORD **)a2 + 1), &v14, 20);
    v12 = 0;
    if ( ptr )
    {
      memset(ptr, 0, _strlen_chk(ptr, -1));
      v12 = ptr;
    }
    free(v12);
    v14 = 0LL;
    v15 = 0LL;
    ptr = 0;
  }
  return _stack_chk_guard - v17[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (000072AC) --------------------------------------------------------
int __fastcall sub_72AC(int a1, int a2)
{
  void *v3; // r5
  int v5[6]; // [sp+0h] [bp-18h] BYREF

  v3 = (void *)strdup8to16(a2, v5);
  android::Parcel::writeString16(a1, v3, v5[0]);
  free(v3);
  return _stack_chk_guard - v5[1];
}
// 31DC: using guessed type int __fastcall strdup8to16(_DWORD, _DWORD);
// 31E8: using guessed type int __fastcall android::Parcel::writeString16(_DWORD, _DWORD, _DWORD);

//----- (000072F8) --------------------------------------------------------
int __fastcall sub_72F8(android::Parcel *this, int *a2, unsigned int a3)
{
  char v6[92]; // [sp+0h] [bp-70h] BYREF

  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( android::s_callbacks > 12 )
  {
    if ( a3 % 0x118 )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CardStatus_v6");
      property_get("ro.debuggable", v6, "0");
      if ( strcmp(v6, "1") )
        return -1;
    }
  }
  else
  {
    if ( a3 == 276 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(this, a2[1]);
      android::Parcel::writeInt32(this, a2[2]);
      android::Parcel::writeInt32(this, a2[3]);
      sub_9AFC(this, a2[4], (int)(a2 + 5));
      return 0;
    }
    if ( a3 != 280 )
    {
      _android_log_buf_print(1, 6, "RILC", "responseSimStatus: A RilCardStatus_v6 or _v5 expected\n");
      return -1;
    }
  }
  sub_9AC0(this, a2);
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 31F4: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;

//----- (00007410) --------------------------------------------------------
int __fastcall sub_7410(android::Parcel *this, int **a2, unsigned int a3)
{
  int **v3; // r4
  int result; // r0
  unsigned int v7; // r6
  int *v8; // r7
  int v9; // r7

  v3 = a2;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( (a3 & 3) != 0 )
  {
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "responseCallList: invalid response length %d expected multiple of %d\n",
      a3,
      4);
    return -1;
  }
  v7 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  result = 0;
  if ( a3 >> 2 )
  {
    do
    {
      v8 = *v3;
      android::Parcel::writeInt32(this, **v3);
      android::Parcel::writeInt32(this, v8[1]);
      android::Parcel::writeInt32(this, v8[2]);
      android::Parcel::writeInt32(this, *((unsigned __int8 *)v8 + 12));
      android::Parcel::writeInt32(this, *((unsigned __int8 *)v8 + 13));
      android::Parcel::writeInt32(this, *((unsigned __int8 *)v8 + 14));
      android::Parcel::writeInt32(this, *((unsigned __int8 *)v8 + 15));
      android::Parcel::writeInt32(this, *((unsigned __int8 *)v8 + 16));
      sub_72AC((int)this, v8[5]);
      android::Parcel::writeInt32(this, v8[6]);
      sub_72AC((int)this, v8[7]);
      android::Parcel::writeInt32(this, v8[8]);
      if ( android::s_callbacks >= 3 && (v9 = v8[9]) != 0 && *(_DWORD *)(v9 + 12) )
      {
        android::Parcel::writeInt32(this, 1);
        android::Parcel::writeInt32(this, *(_DWORD *)v9);
        android::Parcel::writeInt32(this, *(_DWORD *)(v9 + 4));
        android::Parcel::writeInt32(this, *(_DWORD *)(v9 + 8));
        android::Parcel::write(this, *(const void **)(v9 + 12), *(_DWORD *)(v9 + 8));
      }
      else
      {
        android::Parcel::writeInt32(this, 0);
      }
      --v7;
      ++v3;
    }
    while ( v7 );
    return 0;
  }
  return result;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137F8: using guessed type int android::s_callbacks;

//----- (00007530) --------------------------------------------------------
unsigned int __fastcall sub_7530(android::Parcel *this, __int64 *a2)
{
  int String16Inplace; // r0
  int v5; // r6
  int v6; // r0
  int v7; // r6
  __int64 v8; // kr00_8
  const char *v9; // r0
  unsigned int Inplace; // r0
  unsigned int v11; // r1
  void *v12; // r0
  int v14; // [sp+Ch] [bp-5Ch] BYREF
  int v15; // [sp+10h] [bp-58h] BYREF
  int v16; // [sp+14h] [bp-54h] BYREF
  __int64 v17; // [sp+18h] [bp-50h] BYREF
  unsigned __int64 v18; // [sp+20h] [bp-48h]
  __int64 v19; // [sp+28h] [bp-40h] BYREF
  __int64 v20; // [sp+30h] [bp-38h]
  unsigned int v21[12]; // [sp+38h] [bp-30h] BYREF

  v20 = 0LL;
  String16Inplace = android::Parcel::readString16Inplace(this, v21);
  v5 = strndup16to8(String16Inplace, v21[0]);
  v19 = (unsigned int)v5;
  v6 = android::Parcel::readInt32(this, &v16);
  HIDWORD(v19) = v16;
  if ( v6 || !v5 )
    goto LABEL_8;
  if ( android::s_callbacks > 2 )
  {
    if ( !android::Parcel::readInt32(this, &v15) )
    {
      if ( v15 )
      {
        v17 = 0LL;
        v18 = 0LL;
        android::Parcel::readInt32(this, &v16);
        LODWORD(v17) = v16;
        android::Parcel::readInt32(this, &v16);
        HIDWORD(v17) = v16;
        if ( android::Parcel::readInt32(this, (int *)v21) )
          goto LABEL_8;
        if ( v21[0] == -1 )
        {
          v11 = 0;
          Inplace = 0;
          v21[0] = 0;
        }
        else
        {
          Inplace = android::Parcel::readInplace(this, v21[0]);
          v11 = v21[0];
        }
        v18 = __PAIR64__(Inplace, v11);
        LODWORD(v20) = &v17;
      }
      else
      {
        LODWORD(v20) = 0;
      }
      v7 = 16;
      goto LABEL_15;
    }
LABEL_8:
    v8 = *a2;
    v9 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v8, v9);
    return _stack_chk_guard - v21[1];
  }
  v7 = 12;
  v15 = 0;
LABEL_15:
  android::Parcel::readInt32(this, &v14);
  HIDWORD(v20) = v14;
  dword_137FC(**((_DWORD **)a2 + 1), &v19, v7);
  if ( (_DWORD)v19 )
  {
    memset((void *)v19, 0, _strlen_chk(v19, -1));
    v12 = (void *)v19;
  }
  else
  {
    v12 = 0;
  }
  free(v12);
  v19 = 0LL;
  v20 = 0LL;
  v17 = 0LL;
  v18 = 0LL;
  return _stack_chk_guard - v21[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (0000768C) --------------------------------------------------------
int __fastcall sub_768C(android::Parcel *this, int *a2, int a3)
{
  if ( a2 || !a3 )
  {
    if ( a3 == 8 )
    {
      android::Parcel::writeInt32(this, *a2);
      sub_72AC((int)this, a2[1]);
      return 0;
    }
    if ( a3 == 4 )
    {
      android::Parcel::writeInt32(this, *a2);
      return 0;
    }
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "responseFailCause: invalid response length %d expected an int or RIL_LastCallFailCauseInfo",
      a3);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
  }
  return -1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000076F4) --------------------------------------------------------
int __fastcall sub_76F4(android::Parcel *a1, int *a2, unsigned int a3)
{
  int v6; // r1
  android::Parcel *v7; // r0
  char v9[92]; // [sp+0h] [bp-70h] BYREF

  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( android::s_callbacks > 12 )
  {
    if ( a3 % 0x3C )
    {
      _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_SignalStrength_v10");
      property_get("ro.debuggable", v9, "0");
      if ( strcmp(v9, "1") )
        return -1;
    }
    sub_9B5E(a1, a2);
    sub_9B9E(a1, a2);
  }
  else
  {
    if ( a3 < 0x20 )
    {
      _android_log_buf_print(1, 6, "RILC", "invalid response length");
      return -1;
    }
    sub_9B5E(a1, a2);
    if ( a3 < 0x34 )
    {
      android::Parcel::writeInt32(a1, 99);
      android::Parcel::writeInt32(a1, 0x7FFFFFFF);
      android::Parcel::writeInt32(a1, 0x7FFFFFFF);
      android::Parcel::writeInt32(a1, 0x7FFFFFFF);
      android::Parcel::writeInt32(a1, 0x7FFFFFFF);
LABEL_16:
      v7 = a1;
      v6 = 0x7FFFFFFF;
      goto LABEL_17;
    }
    sub_9B9E(a1, a2);
    if ( a3 < 0x3C )
      goto LABEL_16;
  }
  v6 = a2[14];
  v7 = a1;
LABEL_17:
  android::Parcel::writeInt32(v7, v6);
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 31F4: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;

//----- (00007834) --------------------------------------------------------
unsigned int __fastcall sub_7834(android::Parcel *a1, int a2)
{
  int String16Inplace; // r0
  void *v4; // r5
  unsigned int v6[6]; // [sp+8h] [bp-18h] BYREF

  String16Inplace = android::Parcel::readString16Inplace(a1, v6);
  v4 = (void *)strndup16to8(String16Inplace, v6[0]);
  dword_137FC(**(_DWORD **)(a2 + 4), v4, 4);
  if ( v4 )
    _strlen_chk(v4, -1);
  free(v4);
  return _stack_chk_guard - v6[1];
}
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (000078A0) --------------------------------------------------------
int __fastcall sub_78A0(android::Parcel *this, int *a2, int a3)
{
  if ( a2 )
  {
    if ( a3 == 12 )
    {
      android::Parcel::writeInt32(this, *a2);
      sub_72AC((int)this, a2[1]);
      android::Parcel::writeInt32(this, a2[2]);
      return 0;
    }
    _android_log_buf_print(1, 6, "RILC", "invalid response length %d expected %d", a3, 12);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
  }
  return -1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007904) --------------------------------------------------------
unsigned int __fastcall sub_7904(android::Parcel *this, __int64 *a2)
{
  unsigned int v4; // r9
  int v5; // r6
  int v7; // [sp+0h] [bp-58h] BYREF
  char v8[52]; // [sp+4h] [bp-54h] BYREF
  int v9; // [sp+38h] [bp-20h]

  v4 = android::Parcel::dataPosition(this);
  if ( (int)android::Parcel::readInt32(this) < 7 || android::s_callbacks > 3 )
  {
    android::Parcel::setDataPosition(this, v4);
    return sub_6C50(this, a2);
  }
  else
  {
    android::Parcel::Parcel((android::Parcel *)v8);
    android::Parcel::appendFrom((android::Parcel *)v8, this, 0, v4);
    v5 = 6;
    android::Parcel::writeInt32((android::Parcel *)v8, 6);
    do
    {
      android::Parcel::readString16((android::Parcel *)&v7);
      android::Parcel::writeString16((android::Parcel *)v8, (const android::String16 *)&v7);
      android::String16::~String16((android::String16 *)&v7);
      --v5;
    }
    while ( v5 );
    android::Parcel::setDataPosition((android::Parcel *)v8, v4);
    sub_6C50((android::Parcel *)v8, a2);
    android::Parcel::~Parcel((android::Parcel *)v8);
    return _stack_chk_guard - v9;
  }
}
// 137F8: using guessed type int android::s_callbacks;

//----- (000079D8) --------------------------------------------------------
int __fastcall sub_79D8(android::Parcel *this, int *a2, unsigned int a3)
{
  if ( android::s_callbacks > 4 )
    return sub_7DC8(this, (int)a2, a3);
  android::Parcel::writeInt32(this, android::s_callbacks);
  return sub_6DA4(this, a2, a3);
}
// 137F8: using guessed type int android::s_callbacks;

//----- (00007A14) --------------------------------------------------------
unsigned int __fastcall sub_7A14(android::Parcel *this, __int64 *a2)
{
  int String16Inplace; // r0
  int v5; // r6
  int v6; // r0
  int v7; // r0
  int v8; // r0
  __int64 v9; // kr00_8
  const char *v10; // r0
  int v11; // r2
  int v13; // [sp+Ch] [bp-4h] BYREF
  __int64 v14; // [sp+10h] [bp+0h] BYREF
  __int64 ptr; // [sp+18h] [bp+8h]
  __int64 v16; // [sp+20h] [bp+10h]
  __int64 v17; // [sp+28h] [bp+18h]
  void *v18; // [sp+30h] [bp+20h]
  unsigned int v19[7]; // [sp+38h] [bp+28h] BYREF

  v14 = 0LL;
  ptr = 0LL;
  v16 = 0LL;
  v17 = 0LL;
  android::Parcel::readInt32(this, &v13);
  LODWORD(v14) = v13;
  android::Parcel::readInt32(this, &v13);
  HIDWORD(v14) = v13;
  String16Inplace = android::Parcel::readString16Inplace(this, v19);
  LODWORD(ptr) = strndup16to8(String16Inplace, v19[0]);
  android::Parcel::readInt32(this, &v13);
  HIDWORD(ptr) = v13;
  android::Parcel::readInt32(this, &v13);
  LODWORD(v16) = v13;
  v5 = android::Parcel::readInt32(this, &v13);
  HIDWORD(v16) = v13;
  v6 = android::Parcel::readString16Inplace(this, v19);
  LODWORD(v17) = strndup16to8(v6, v19[0]);
  v7 = android::Parcel::readString16Inplace(this, v19);
  HIDWORD(v17) = strndup16to8(v7, v19[0]);
  v8 = android::Parcel::readString16Inplace(this, v19);
  v18 = (void *)strndup16to8(v8, v19[0]);
  if ( v5 )
  {
    v9 = *a2;
    v10 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v9, v10);
  }
  else
  {
    v11 = 36;
    if ( android::s_callbacks < 6 )
      v11 = 32;
    dword_137FC(**((_DWORD **)a2 + 1), &v14, v11);
    if ( (_DWORD)ptr )
      memset((void *)ptr, 0, _strlen_chk(ptr, -1));
    if ( (_DWORD)v17 )
      memset((void *)v17, 0, _strlen_chk(v17, -1));
    if ( HIDWORD(v17) )
      memset((void *)HIDWORD(v17), 0, _strlen_chk(HIDWORD(v17), -1));
    if ( v18 )
      memset(v18, 0, _strlen_chk(v18, -1));
    free((void *)ptr);
    free((void *)v17);
    free((void *)HIDWORD(v17));
    free(v18);
    v14 = 0LL;
    ptr = 0LL;
    v16 = 0LL;
    v17 = 0LL;
    v18 = 0;
  }
  return _stack_chk_guard - v19[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00007BAC) --------------------------------------------------------
int __fastcall sub_7BAC(android::Parcel *this, int *a2, int a3)
{
  if ( a2 )
  {
    if ( a3 == 12 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(this, a2[1]);
      sub_72AC((int)this, a2[2]);
      return 0;
    }
    _android_log_buf_print(1, 6, "RILC", "invalid response length was %d expected %d", a3, 12);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
  }
  return -1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007C10) --------------------------------------------------------
unsigned int __fastcall sub_7C10(android::Parcel *this, __int64 *a2)
{
  int String16Inplace; // r0
  _BYTE *v5; // r7
  int v6; // r0
  __int64 v7; // kr00_8
  const char *v8; // r0
  void *v9; // r0
  int v11; // [sp+Ch] [bp-4Ch] BYREF
  __int64 v12; // [sp+10h] [bp-48h] BYREF
  __int64 v13; // [sp+18h] [bp-40h]
  void *ptr; // [sp+20h] [bp-38h]
  int v15; // [sp+24h] [bp-34h]
  unsigned int v16[12]; // [sp+28h] [bp-30h] BYREF

  v12 = 0LL;
  v13 = 0LL;
  ptr = 0;
  android::Parcel::readInt32(this, &v11);
  LODWORD(v12) = v11;
  android::Parcel::readInt32(this, &v11);
  HIDWORD(v12) = v11;
  android::Parcel::readInt32(this, &v11);
  LODWORD(v13) = v11;
  android::Parcel::readInt32(this, &v11);
  HIDWORD(v13) = v11;
  String16Inplace = android::Parcel::readString16Inplace(this, v16);
  v5 = (_BYTE *)strndup16to8(String16Inplace, v16[0]);
  ptr = v5;
  v6 = android::Parcel::readInt32(this, &v11);
  v15 = v11;
  if ( v6 )
  {
    v7 = *a2;
    v8 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v7, v8);
  }
  else
  {
    if ( v5 && !*v5 )
      ptr = 0;
    dword_137FC(**((_DWORD **)a2 + 1), &v12, 24);
    v9 = 0;
    if ( ptr )
    {
      memset(ptr, 0, _strlen_chk(ptr, -1));
      v9 = ptr;
    }
    free(v9);
    v12 = 0LL;
    v13 = 0LL;
    ptr = 0;
    v15 = 0;
  }
  return _stack_chk_guard - v16[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00007D2C) --------------------------------------------------------
int __fastcall sub_7D2C(android::Parcel *this, int **a2, unsigned int a3)
{
  int **v3; // r4
  int result; // r0
  unsigned int v7; // r6
  int *v8; // t1

  v3 = a2;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( (a3 & 3) != 0 )
  {
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "responseCallForwards: invalid response length %d expected multiple of %d",
      a3,
      4);
    return -1;
  }
  v7 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  result = 0;
  if ( a3 >> 2 )
  {
    do
    {
      v8 = *v3++;
      android::Parcel::writeInt32(this, *v8);
      android::Parcel::writeInt32(this, v8[1]);
      android::Parcel::writeInt32(this, v8[2]);
      android::Parcel::writeInt32(this, v8[3]);
      sub_72AC((int)this, v8[4]);
      android::Parcel::writeInt32(this, v8[5]);
      --v7;
    }
    while ( v7 );
    return 0;
  }
  return result;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00007DC8) --------------------------------------------------------
int __fastcall sub_7DC8(android::Parcel *this, int a2, unsigned int a3)
{
  int result; // r0
  signed int v7; // r7
  signed int v8; // r7
  signed int v9; // r7
  int *v10; // r5
  signed int v11; // r6
  int *v12; // r5
  signed int v13; // r6
  int *v14; // r5
  signed int v15; // r6
  char v16[92]; // [sp+Ch] [bp-74h] BYREF

  if ( android::s_callbacks > 12 )
  {
    if ( !(a3 % 0x2C) )
      return sub_9C0C(this, a2, a3);
    _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_Data_Call_Response_v11");
    property_get("ro.debuggable", v16, "0");
    if ( !strcmp(v16, "1") )
      return sub_9C0C(this, a2, a3);
    return -1;
  }
  if ( android::s_callbacks <= 4 )
  {
    if ( !a2 && a3 )
    {
LABEL_19:
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
      return -1;
    }
    v9 = a3 / 0x14;
    if ( a3 % 0x14 )
    {
      _android_log_buf_print(
        1,
        6,
        "RILC",
        "responseDataCallListV4: invalid response length %d expected multiple of %d",
        a3,
        20);
      return -1;
    }
    android::Parcel::writeInt32(this, 4);
    android::Parcel::writeInt32(this, a3 / 0x14);
    if ( a3 >= 0x14 )
    {
      v10 = (int *)(a2 + 8);
      v11 = 0;
      do
      {
        android::Parcel::writeInt32(this, *(v10 - 2));
        android::Parcel::writeInt32(this, *(v10 - 1));
        sub_72AC((int)this, *v10);
        sub_72AC((int)this, v10[2]);
        ++v11;
        v10 += 5;
        result = 0;
      }
      while ( v11 < v9 );
      return result;
    }
    return 0;
  }
  v7 = a3 / 0x24;
  if ( a3 % 0x24 )
  {
    v8 = a3 / 0x28;
    if ( a3 % 0x28 )
      return sub_9C0C(this, a2, a3);
    if ( !a2 && a3 )
      goto LABEL_19;
    android::Parcel::writeInt32(this, 10);
    android::Parcel::writeInt32(this, a3 / 0x28);
    if ( a3 < 0x28 )
      return 0;
    v14 = (int *)(a2 + 36);
    v15 = 0;
    do
    {
      android::Parcel::writeInt32(this, *(v14 - 9));
      android::Parcel::writeInt32(this, *(v14 - 8));
      android::Parcel::writeInt32(this, *(v14 - 7));
      android::Parcel::writeInt32(this, *(v14 - 6));
      sub_72AC((int)this, *(v14 - 5));
      sub_72AC((int)this, *(v14 - 4));
      sub_72AC((int)this, *(v14 - 3));
      sub_72AC((int)this, *(v14 - 2));
      sub_72AC((int)this, *(v14 - 1));
      sub_72AC((int)this, *v14);
      ++v15;
      v14 += 10;
      result = 0;
    }
    while ( v15 < v8 );
  }
  else
  {
    if ( !a2 && a3 )
      goto LABEL_19;
    android::Parcel::writeInt32(this, 6);
    android::Parcel::writeInt32(this, a3 / 0x24);
    if ( a3 < 0x24 )
      return 0;
    v12 = (int *)(a2 + 32);
    v13 = 0;
    do
    {
      android::Parcel::writeInt32(this, *(v12 - 8));
      android::Parcel::writeInt32(this, *(v12 - 7));
      android::Parcel::writeInt32(this, *(v12 - 6));
      android::Parcel::writeInt32(this, *(v12 - 5));
      sub_72AC((int)this, *(v12 - 4));
      sub_72AC((int)this, *(v12 - 3));
      sub_72AC((int)this, *(v12 - 2));
      sub_72AC((int)this, *(v12 - 1));
      sub_72AC((int)this, *v12);
      ++v13;
      v12 += 9;
      result = 0;
    }
    while ( v13 < v7 );
  }
  return result;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 31F4: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;

//----- (000080A0) --------------------------------------------------------
int __fastcall sub_80A0(android::Parcel *this, __int64 *a2)
{
  __int64 v4; // kr00_8
  const char *v5; // r0
  unsigned int v6; // r1
  int Inplace; // r0
  int v9[6]; // [sp+8h] [bp-18h] BYREF

  if ( android::Parcel::readInt32(this, v9) )
  {
    v4 = *a2;
    v5 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v4, v5);
  }
  else
  {
    v6 = v9[0];
    if ( v9[0] == -1 )
    {
      v6 = 0;
      v9[0] = 0;
    }
    Inplace = android::Parcel::readInplace(this, v6);
    dword_137FC(**((_DWORD **)a2 + 1), Inplace, v9[0]);
  }
  return _stack_chk_guard - v9[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00008130) --------------------------------------------------------
int __fastcall sub_8130(android::Parcel *this, const void *a2, unsigned int a3)
{
  if ( a2 || !a3 )
  {
    if ( a2 )
    {
      android::Parcel::writeInt32(this, a3);
      android::Parcel::write(this, a2, a3);
    }
    else
    {
      android::Parcel::writeInt32(this, -1);
    }
    return 0;
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL with responselen != 0");
    return -1;
  }
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00008180) --------------------------------------------------------
unsigned int __fastcall sub_8180(android::Parcel *this, __int64 *a2)
{
  int v4; // r6
  int String16Inplace; // r0
  void *v6; // r0
  int v7; // r0
  void *v8; // r0
  __int64 v9; // kr00_8
  const char *v10; // r0
  int v12; // [sp+Ch] [bp-2Ch] BYREF
  int v13; // [sp+10h] [bp-28h] BYREF
  void *ptr; // [sp+14h] [bp-24h]
  int v15; // [sp+18h] [bp-20h]
  unsigned int v16[6]; // [sp+20h] [bp-18h] BYREF

  v13 = 0;
  ptr = 0;
  v15 = 0;
  v4 = android::Parcel::readInt32(this, &v12);
  v13 = v12;
  String16Inplace = android::Parcel::readString16Inplace(this, v16);
  v6 = (void *)strndup16to8(String16Inplace, v16[0]);
  ptr = v6;
  if ( v4 || !v6 )
  {
    v9 = *a2;
    v10 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v9, v10);
  }
  else
  {
    v7 = android::Parcel::readString16Inplace(this, v16);
    v15 = strndup16to8(v7, v16[0]);
    dword_137FC(**((_DWORD **)a2 + 1), &v13, 12);
    v8 = 0;
    if ( ptr )
    {
      memset(ptr, 0, _strlen_chk(ptr, -1));
      v8 = ptr;
    }
    free(v8);
    v13 = 0;
    ptr = 0;
    v15 = 0;
  }
  return _stack_chk_guard - v16[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00008254) --------------------------------------------------------
int __fastcall sub_8254(android::Parcel *this, int **a2, unsigned int a3)
{
  int **v3; // r4
  int result; // r0
  unsigned int v7; // r6
  int *v8; // t1

  v3 = a2;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( (a3 & 3) != 0 )
  {
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "responseCellList: invalid response length %d expected multiple of %d\n",
      a3,
      4);
    return -1;
  }
  v7 = a3 >> 2;
  android::Parcel::writeInt32(this, a3 >> 2);
  result = 0;
  if ( a3 >> 2 )
  {
    do
    {
      v8 = *v3++;
      android::Parcel::writeInt32(this, v8[1]);
      sub_72AC((int)this, *v8);
      --v7;
    }
    while ( v7 );
    return 0;
  }
  return result;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000082D0) --------------------------------------------------------
int __fastcall sub_82D0(android::Parcel *a1, int *a2)
{
  int v3; // r1
  int v4; // r0
  int v5; // r4
  const char *v6; // r0
  int v8[98]; // [sp+8h] [bp-188h] BYREF

  v3 = sub_9CF0(a1, v8);
  v4 = *(_DWORD *)a2[1];
  if ( v3 )
  {
    v5 = *a2;
    v6 = j_requestToString(v4);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v5, v6);
  }
  else
  {
    dword_137FC(v4, v8, "Android");
    memset(v8, 0, 0x174u);
  }
  return _stack_chk_guard - v8[93];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00008358) --------------------------------------------------------
int __fastcall sub_8358(android::Parcel *this, int *a2)
{
  int v4; // r1
  int v5; // r0
  int v6; // r4
  const char *v7; // r0
  int v9; // [sp+Ch] [bp-24h] BYREF
  int v10; // [sp+10h] [bp-20h] BYREF
  int v11; // [sp+14h] [bp-1Ch]
  int v12; // [sp+18h] [bp-18h]

  v10 = 0;
  v11 = 0;
  android::Parcel::readInt32(this, &v9);
  v10 = v9;
  v4 = android::Parcel::readInt32(this, &v9);
  v11 = v9;
  v5 = *(_DWORD *)a2[1];
  if ( v4 )
  {
    v6 = *a2;
    v7 = j_requestToString(v5);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v6, v7);
  }
  else
  {
    dword_137FC(v5, &v10, 8);
    v10 = 0;
    v11 = 0;
  }
  return _stack_chk_guard - v12;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (000083F4) --------------------------------------------------------
int __fastcall sub_83F4(android::Parcel *a1, int **a2, unsigned int a3)
{
  unsigned int v5; // r6
  int *v7; // t1

  v5 = a3 >> 2;
  android::Parcel::writeInt32(a1, a3 >> 2);
  if ( a3 >> 2 )
  {
    do
    {
      android::Parcel::writeInt32(a1, **a2);
      android::Parcel::writeInt32(a1, (*a2)[1]);
      android::Parcel::writeInt32(a1, (*a2)[2]);
      android::Parcel::writeInt32(a1, (*a2)[3]);
      v7 = *a2++;
      android::Parcel::writeInt32(a1, *((unsigned __int8 *)v7 + 16));
      --v5;
    }
    while ( v5 );
  }
  return 0;
}

//----- (0000844C) --------------------------------------------------------
int __fastcall sub_844C(android::Parcel *this, __int64 *a2)
{
  char *v4; // r8
  int v5; // r1
  char *v6; // r11
  char *v7; // r6
  int v8; // r10
  int Int32; // r0
  __int64 v10; // kr00_8
  const char *v11; // r0
  int v12; // r4
  int *v14; // [sp+8h] [bp-20h] BYREF
  int v15; // [sp+Ch] [bp-1Ch] BYREF
  int v16[3]; // [sp+10h] [bp-18h] BYREF

  if ( android::Parcel::readInt32(this, &v15) )
    goto LABEL_6;
  v4 = (char *)&v14 - ((20 * v15 + 7) & 0xFFFFFFF8);
  v5 = v15;
  v6 = (char *)&v14 - ((4 * v15 + 7) & 0xFFFFFFF8);
  if ( v15 < 1 )
    goto LABEL_7;
  v14 = (int *)&v14;
  v7 = v4 + 8;
  v8 = 0;
  do
  {
    *(_DWORD *)&v6[4 * v8] = v7 - 8;
    android::Parcel::readInt32(this, v16);
    *((_DWORD *)v7 - 2) = v16[0];
    android::Parcel::readInt32(this, v16);
    *((_DWORD *)v7 - 1) = v16[0];
    android::Parcel::readInt32(this, v16);
    *(_DWORD *)v7 = v16[0];
    android::Parcel::readInt32(this, v16);
    *((_DWORD *)v7 + 1) = v16[0];
    Int32 = android::Parcel::readInt32(this, v16);
    ++v8;
    v7[8] = v16[0];
    v7 += 20;
    v5 = v15;
  }
  while ( v8 < v15 );
  if ( Int32 )
  {
LABEL_6:
    v10 = *a2;
    v11 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v10, v11);
  }
  else
  {
LABEL_7:
    dword_137FC(**((_DWORD **)a2 + 1), v6, 4 * v5);
    v12 = v15;
    memset(v4, 0, 20 * v15);
    memset(v6, 0, 4 * v12);
  }
  return _stack_chk_guard - v16[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (000085A8) --------------------------------------------------------
int __fastcall sub_85A8(android::Parcel *a1, int **a2, unsigned int a3)
{
  unsigned int v5; // r6
  int *v7; // t1

  v5 = a3 >> 2;
  android::Parcel::writeInt32(a1, a3 >> 2);
  if ( a3 >> 2 )
  {
    do
    {
      android::Parcel::writeInt32(a1, **a2);
      android::Parcel::writeInt32(a1, (*a2)[1]);
      v7 = *a2++;
      android::Parcel::writeInt32(a1, *((unsigned __int8 *)v7 + 8));
      --v5;
    }
    while ( v5 );
  }
  return 0;
}

//----- (000085EC) --------------------------------------------------------
int __fastcall sub_85EC(android::Parcel *this, __int64 *a2)
{
  char *v4; // r10
  int v5; // r1
  char *v6; // r11
  int v7; // r6
  char *v8; // r8
  int Int32; // r0
  __int64 v10; // kr00_8
  const char *v11; // r0
  int v12; // r4
  int *v14; // [sp+8h] [bp-20h] BYREF
  int v15; // [sp+Ch] [bp-1Ch] BYREF
  int v16[3]; // [sp+10h] [bp-18h] BYREF

  if ( android::Parcel::readInt32(this, &v15) )
    goto LABEL_6;
  v4 = (char *)&v14 - ((12 * v15 + 7) & 0xFFFFFFF8);
  v5 = v15;
  v6 = (char *)&v14 - ((4 * v15 + 7) & 0xFFFFFFF8);
  if ( v15 <= 0 )
    goto LABEL_7;
  v14 = (int *)&v14;
  v7 = 0;
  v8 = (char *)&v14 - ((12 * v15 + 7) & 0xFFFFFFF8);
  do
  {
    *(_DWORD *)&v6[4 * v7] = v8;
    android::Parcel::readInt32(this, v16);
    *(_DWORD *)v8 = v16[0];
    android::Parcel::readInt32(this, v16);
    *((_DWORD *)v8 + 1) = v16[0];
    Int32 = android::Parcel::readInt32(this, v16);
    ++v7;
    v8[8] = v16[0];
    v8 += 12;
    v5 = v15;
  }
  while ( v7 < v15 );
  if ( Int32 )
  {
LABEL_6:
    v10 = *a2;
    v11 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v10, v11);
  }
  else
  {
LABEL_7:
    dword_137FC(**((_DWORD **)a2 + 1), v6, 4 * v5);
    v12 = v15;
    memset(v4, 0, 12 * v15);
    memset(v6, 0, 4 * v12);
  }
  return _stack_chk_guard - v16[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00008728) --------------------------------------------------------
int __fastcall sub_8728(android::Parcel *a1, int *a2)
{
  int v4; // r4
  int v5; // r10
  int i; // r6
  int j; // r7
  int v8; // r0
  int v9; // r4
  int k; // r6
  int v11; // r4
  const char *v12; // r0
  unsigned __int8 v14; // [sp+Bh] [bp-1A5h] BYREF
  int v15; // [sp+Ch] [bp-1A4h] BYREF
  int v16[104]; // [sp+10h] [bp-1A0h] BYREF

  memset(v16, 0, 0x178u);
  android::Parcel::readInt32(a1, &v15);
  v16[0] = v15;
  android::Parcel::readInt32(a1, &v15);
  v16[1] = v15;
  android::Parcel::read(a1, &v14, 1u);
  LOBYTE(v16[2]) = v14;
  android::Parcel::readInt32(a1, &v15);
  v16[3] = v15;
  android::Parcel::readInt32(a1, &v15);
  v16[4] = v15;
  android::Parcel::readInt32(a1, &v15);
  v16[5] = v15;
  android::Parcel::readInt32(a1, &v15);
  v16[6] = v15;
  android::Parcel::readInt32(a1, &v15);
  v16[7] = v15;
  android::Parcel::read(a1, &v14, 1u);
  v4 = v14;
  v5 = 36;
  LOBYTE(v16[8]) = v14;
  if ( v14 >= 0x24u )
    v4 = 36;
  if ( v4 >= 1 )
  {
    for ( i = 0; i < v4; ++i )
    {
      android::Parcel::read(a1, &v14, 1u);
      *((_BYTE *)&v16[8] + i + 1) = v14;
    }
  }
  android::Parcel::readInt32(a1, &v15);
  v16[18] = v15;
  android::Parcel::read(a1, &v14, 1u);
  LOBYTE(v16[19]) = v14;
  android::Parcel::read(a1, &v14, 1u);
  BYTE1(v16[19]) = v14;
  if ( v14 < 0x24u )
    v5 = v14;
  if ( v5 >= 1 )
  {
    for ( j = 0; j < v5; ++j )
    {
      android::Parcel::read(a1, &v14, 1u);
      *((_BYTE *)&v16[19] + j + 2) = v14;
    }
  }
  v8 = android::Parcel::readInt32(a1, &v15);
  v9 = v15;
  v16[29] = v15;
  if ( v15 >= 255 )
    v9 = 255;
  if ( v9 >= 1 )
  {
    for ( k = 0; k < v9; ++k )
    {
      v8 = android::Parcel::read(a1, &v14, 1u);
      *((_BYTE *)&v16[30] + k) = v14;
    }
  }
  if ( v8 )
  {
    v11 = *a2;
    v12 = j_requestToString(*(_DWORD *)a2[1]);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v11, v12);
  }
  else
  {
    dword_137FC(*(_DWORD *)a2[1], v16, 376);
    memset(v16, 0, 0x178u);
  }
  return _stack_chk_guard - v16[94];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00008910) --------------------------------------------------------
int __fastcall sub_8910(int a1, int a2)
{
  int v3; // r5
  int v5; // r3
  int *v6; // r2
  int v7; // r1
  int v8; // r0

  v3 = dword_13800(*(_DWORD *)(a2 + 16));
  if ( (v3 | 1) == 1 )
    j_RIL_onRequestComplete(a2, 1, 0, 0);
  if ( v3 == 10 )
    return dword_137FC(**(_DWORD **)(a2 + 4), 0, 0);
  if ( (unsigned int)(v3 - 2) >= 8 )
  {
    _android_log_buf_print(1, 6, "RILC", "decodeCdmaSubscriptionSource: Invoked with incorrect RadioState");
    v6 = 0;
    v5 = 0;
    android::cdmaSubscriptionSource = -1;
    v8 = a2;
    v7 = 2;
  }
  else
  {
    v5 = 4;
    v6 = &android::cdmaSubscriptionSource;
    v7 = 0;
    android::cdmaSubscriptionSource = dword_11230[v3 - 2];
    v8 = a2;
  }
  return j_j_RIL_onRequestComplete(v8, v7, (int)v6, v5);
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 11230: using guessed type _DWORD dword_11230[8];
// 13010: using guessed type int android::cdmaSubscriptionSource;
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);
// 13800: using guessed type int (__fastcall *dword_13800)(_DWORD);

//----- (000089C0) --------------------------------------------------------
int __fastcall sub_89C0(int a1, int a2)
{
  int v3; // r5
  int v5; // r3
  int *v6; // r2
  int v7; // r1
  int v8; // r0

  v3 = dword_13800(*(_DWORD *)(a2 + 16));
  if ( (v3 | 1) == 1 )
    j_RIL_onRequestComplete(a2, 1, 0, 0);
  if ( v3 == 10 )
    return dword_137FC(**(_DWORD **)(a2 + 4), 0, 0);
  if ( (unsigned int)(v3 - 2) >= 8 )
  {
    _android_log_buf_print(1, 6, "RILC", "decodeVoiceRadioTechnology: Invoked with incorrect RadioState");
    v6 = 0;
    v5 = 0;
    android::voiceRadioTech = -1;
    v8 = a2;
    v7 = 2;
  }
  else
  {
    v5 = 4;
    v6 = &android::voiceRadioTech;
    v7 = 0;
    android::voiceRadioTech = dword_11250[v3 - 2];
    v8 = a2;
  }
  return j_j_RIL_onRequestComplete(v8, v7, (int)v6, v5);
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 11250: using guessed type _DWORD dword_11250[8];
// 1300C: using guessed type int android::voiceRadioTech;
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);
// 13800: using guessed type int (__fastcall *dword_13800)(_DWORD);

//----- (00008A70) --------------------------------------------------------
int __fastcall sub_8A70(android::Parcel *this, int a2, unsigned int a3)
{
  int result; // r0
  signed int v7; // r5
  int *v8; // r6
  signed int v9; // r7
  int v10; // r1
  int v11; // r1
  char v12[92]; // [sp+Ch] [bp-74h] BYREF

  if ( android::s_callbacks > 12 )
  {
    if ( !(a3 % 0x48) )
      return sub_9E78(this, a2, a3);
    _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CellInfo_v12");
    property_get("ro.debuggable", v12, "0");
    if ( !strcmp(v12, "1") )
      return sub_9E78(this, a2, a3);
    return -1;
  }
  if ( android::s_callbacks > 11 )
  {
    _android_log_buf_print(1, 3, "RILC", "responseCellInfoList: v12");
    return sub_9E78(this, a2, a3);
  }
  _android_log_buf_print(1, 3, "RILC", "responseCellInfoList: v6");
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  v7 = a3 / 0x48;
  if ( a3 % 0x48 )
  {
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "responseCellInfoList: invalid response length %d expected multiple of %d",
      a3,
      72);
    return -1;
  }
  android::Parcel::writeInt32(this, a3 / 0x48);
  if ( a3 < 0x48 )
    return 0;
  v8 = (int *)(a2 + 32);
  v9 = 0;
  do
  {
    android::Parcel::writeInt32(this, *(v8 - 8));
    android::Parcel::writeInt32(this, *(v8 - 7));
    android::Parcel::writeInt32(this, *(v8 - 6));
    android::Parcel::writeInt64(this, *((_QWORD *)v8 - 2));
    switch ( *(v8 - 8) )
    {
      case 1:
      case 5:
        android::Parcel::writeInt32(this, *(v8 - 2));
        android::Parcel::writeInt32(this, *(v8 - 1));
        android::Parcel::writeInt32(this, *v8);
        android::Parcel::writeInt32(this, v8[1]);
        android::Parcel::writeInt32(this, v8[2]);
        v10 = v8[3];
        goto LABEL_21;
      case 2:
        android::Parcel::writeInt32(this, *(v8 - 2));
        android::Parcel::writeInt32(this, *(v8 - 1));
        android::Parcel::writeInt32(this, *v8);
        android::Parcel::writeInt32(this, v8[1]);
        android::Parcel::writeInt32(this, v8[2]);
        android::Parcel::writeInt32(this, v8[3]);
        v11 = v8[4];
        goto LABEL_19;
      case 3:
        android::Parcel::writeInt32(this, *(v8 - 2));
        android::Parcel::writeInt32(this, *(v8 - 1));
        android::Parcel::writeInt32(this, *v8);
        android::Parcel::writeInt32(this, v8[1]);
        android::Parcel::writeInt32(this, v8[2]);
        android::Parcel::writeInt32(this, v8[3]);
        android::Parcel::writeInt32(this, v8[4]);
        v11 = v8[5];
LABEL_19:
        android::Parcel::writeInt32(this, v11);
        android::Parcel::writeInt32(this, v8[6]);
        android::Parcel::writeInt32(this, v8[7]);
        v10 = v8[8];
        goto LABEL_21;
      case 4:
        android::Parcel::writeInt32(this, *(v8 - 2));
        android::Parcel::writeInt32(this, *(v8 - 1));
        android::Parcel::writeInt32(this, *v8);
        android::Parcel::writeInt32(this, v8[1]);
        android::Parcel::writeInt32(this, v8[2]);
        android::Parcel::writeInt32(this, v8[3]);
        v10 = v8[4];
LABEL_21:
        android::Parcel::writeInt32(this, v10);
        break;
      default:
        break;
    }
    ++v9;
    v8 += 18;
    result = 0;
  }
  while ( v9 < v7 );
  return result;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 31F4: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;

//----- (00008D24) --------------------------------------------------------
unsigned int __fastcall sub_8D24(android::Parcel *this, __int64 *a2)
{
  int String16Inplace; // r0
  int v5; // r0
  int v6; // r6
  int v7; // r0
  int v8; // r0
  __int64 v9; // kr00_8
  const char *v10; // r0
  int v12; // [sp+Ch] [bp-4h] BYREF
  __int64 ptr; // [sp+10h] [bp+0h] BYREF
  __int64 v14; // [sp+18h] [bp+8h]
  void *v15; // [sp+20h] [bp+10h]
  unsigned int v16[7]; // [sp+28h] [bp+18h] BYREF

  v14 = 0LL;
  String16Inplace = android::Parcel::readString16Inplace(this, v16);
  LODWORD(ptr) = strndup16to8(String16Inplace, v16[0]);
  v5 = android::Parcel::readString16Inplace(this, v16);
  HIDWORD(ptr) = strndup16to8(v5, v16[0]);
  v6 = android::Parcel::readInt32(this, &v12);
  LODWORD(v14) = v12;
  v7 = android::Parcel::readString16Inplace(this, v16);
  HIDWORD(v14) = strndup16to8(v7, v16[0]);
  v8 = android::Parcel::readString16Inplace(this, v16);
  v15 = (void *)strndup16to8(v8, v16[0]);
  if ( v6 )
  {
    v9 = *a2;
    v10 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v9, v10);
  }
  else
  {
    dword_137FC(**((_DWORD **)a2 + 1), &ptr, 20);
    if ( (_DWORD)ptr )
      memset((void *)ptr, 0, _strlen_chk(ptr, -1));
    if ( HIDWORD(ptr) )
      memset((void *)HIDWORD(ptr), 0, _strlen_chk(HIDWORD(ptr), -1));
    if ( HIDWORD(v14) )
      memset((void *)HIDWORD(v14), 0, _strlen_chk(HIDWORD(v14), -1));
    if ( v15 )
      memset(v15, 0, _strlen_chk(v15, -1));
    free((void *)ptr);
    free((void *)HIDWORD(ptr));
    free((void *)HIDWORD(v14));
    free(v15);
    ptr = 0LL;
    v14 = 0LL;
    v15 = 0;
  }
  return _stack_chk_guard - v16[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00008E78) --------------------------------------------------------
int __fastcall sub_8E78(android::Parcel *this, __int64 *a2)
{
  int v4; // r5
  const char *v5; // r3
  unsigned __int8 v7; // r5
  int v8; // r7
  __int64 v9; // kr00_8
  const char *v10; // r0
  unsigned __int8 v11; // r7
  int v12; // r5
  int v13; // r0
  int *v14; // r1
  size_t v15; // r7
  _DWORD *v16; // r5
  int v17; // r2
  int v18; // r8
  signed int v19; // r7
  int String16Inplace; // r0
  signed int i; // r7
  void *v22; // r4
  void *v23; // r0
  const char *v24; // [sp+0h] [bp-1D0h]
  const char *v25; // [sp+4h] [bp-1CCh]
  int v26; // [sp+8h] [bp-1C8h] BYREF
  unsigned __int8 v27; // [sp+Fh] [bp-1C1h] BYREF
  int v28; // [sp+10h] [bp-1C0h] BYREF
  size_t nmemb; // [sp+14h] [bp-1BCh] BYREF
  __int64 v30; // [sp+18h] [bp-1B8h] BYREF
  unsigned __int64 v31; // [sp+20h] [bp-1B0h]
  int v32[106]; // [sp+28h] [bp-1A8h] BYREF

  if ( android::Parcel::readInt32(this, &v28)
    || (v4 = v28, android::Parcel::read(this, &v27, 1u))
    || android::Parcel::read(this, &v26, 4u) )
  {
    v24 = *(const char **)a2;
    v25 = j_requestToString(**((_DWORD **)a2 + 1));
    v5 = "invalid command block for token %d request %s";
LABEL_5:
    _android_log_buf_print(1, 6, "RILC", v5, v24, v25);
    return _stack_chk_guard - v32[93];
  }
  if ( v4 == 2 )
  {
    v11 = v27;
    v12 = v26;
    v13 = sub_9CF0(this, v32);
    v14 = (int *)*((_DWORD *)a2 + 1);
    if ( !v13 )
    {
      LODWORD(v30) = 2;
      HIDWORD(v30) = v11;
      v31 = __PAIR64__(v32, v12);
      dword_137FC(*v14, &v30, 381);
      memset(v32, 0, 0x174u);
      v30 = 0LL;
      v31 = 0LL;
      return _stack_chk_guard - v32[93];
    }
    v24 = *(const char **)a2;
    v25 = j_requestToString(*v14);
    v5 = "invalid command block for token %d request %s";
    goto LABEL_5;
  }
  if ( v4 != 1 )
  {
    _android_log_print(6, "RILC", "requestImsSendSMS invalid format value =%d", v4);
    return _stack_chk_guard - v32[93];
  }
  v7 = v27;
  v8 = v26;
  if ( android::Parcel::readInt32(this, (int *)&nmemb) )
  {
    _android_log_print(6, "RILC", "dispatchImsGsmSms invalid block");
    v9 = *a2;
    v10 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v9, v10);
    return _stack_chk_guard - v32[93];
  }
  v32[3] = 0;
  v32[0] = 1;
  v32[1] = v7;
  v32[2] = v8;
  v15 = nmemb;
  if ( nmemb )
  {
    if ( (nmemb & 0x80000000) == 0 )
    {
      if ( nmemb >= 0x20000000 )
      {
        v5 = "Invalid value of countStrings: \n";
        goto LABEL_5;
      }
      v16 = calloc(nmemb, 4u);
      if ( v16 )
      {
        v18 = 4 * v15;
        v19 = 0;
        do
        {
          String16Inplace = android::Parcel::readString16Inplace(this, (unsigned int *)&v30);
          v16[v19++] = strndup16to8(String16Inplace, v30);
        }
        while ( v19 < (int)nmemb );
        v17 = v18 + 9;
        goto LABEL_27;
      }
LABEL_20:
      v24 = j_requestToString(**((_DWORD **)a2 + 1));
      v5 = "Memory allocation failed for request %s";
      goto LABEL_5;
    }
    v16 = 0;
  }
  else
  {
    v16 = calloc(1u, 4u);
    if ( !v16 )
      goto LABEL_20;
  }
  v17 = 9;
LABEL_27:
  v32[3] = (int)v16;
  dword_137FC(**((_DWORD **)a2 + 1), v32, v17);
  if ( v16 )
  {
    if ( (int)nmemb > 0 )
    {
      for ( i = 0; i < (int)nmemb; ++i )
      {
        v22 = (void *)v16[i];
        if ( v22 )
        {
          memset(v22, 0, _strlen_chk(v16[i], -1));
          v23 = (void *)v16[i];
        }
        else
        {
          v23 = 0;
        }
        free(v23);
      }
    }
    free(v16);
  }
  memset(v32, 0, 16);
  return _stack_chk_guard - v32[93];
}
// 8ED2: variable 'v24' is possibly undefined
// 8ED2: variable 'v25' is possibly undefined
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 3284: using guessed type int _android_log_print(_DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);
// 8E78: using guessed type int var_1C8;

//----- (000090FC) --------------------------------------------------------
unsigned int __fastcall sub_90FC(android::Parcel *this, __int64 *a2)
{
  int v4; // r6
  int String16Inplace; // r0
  __int64 v6; // kr00_8
  const char *v7; // r0
  void *v8; // r0
  __int64 v10; // [sp+8h] [bp+0h] BYREF
  __int64 v11; // [sp+10h] [bp+8h]
  int v12; // [sp+18h] [bp+10h]
  __int64 v13; // [sp+1Ch] [bp+14h]
  int v14; // [sp+24h] [bp+1Ch] BYREF
  unsigned int v15[7]; // [sp+28h] [bp+20h] BYREF

  android::Parcel::readInt32(this, &v14);
  LODWORD(v10) = v14;
  android::Parcel::readInt32(this, &v14);
  HIDWORD(v10) = v14;
  android::Parcel::readInt32(this, &v14);
  LODWORD(v11) = v14;
  android::Parcel::readInt32(this, &v14);
  HIDWORD(v11) = v14;
  android::Parcel::readInt32(this, &v14);
  v12 = v14;
  v4 = android::Parcel::readInt32(this, &v14);
  LODWORD(v13) = v14;
  String16Inplace = android::Parcel::readString16Inplace(this, v15);
  HIDWORD(v13) = strndup16to8(String16Inplace, v15[0]);
  if ( v4 )
  {
    v6 = *a2;
    v7 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v6, v7);
  }
  else
  {
    dword_137FC(**((_DWORD **)a2 + 1), &v10, 28);
    if ( HIDWORD(v13) )
    {
      memset((void *)HIDWORD(v13), 0, _strlen_chk(HIDWORD(v13), -1));
      v8 = (void *)HIDWORD(v13);
    }
    else
    {
      v8 = 0;
    }
    free(v8);
    v12 = 0;
    v13 = 0LL;
    v10 = 0LL;
    v11 = 0LL;
  }
  return _stack_chk_guard - v15[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00009218) --------------------------------------------------------
int __fastcall sub_9218(android::Parcel *a1, int *a2)
{
  int v3; // r1
  int v4; // r0
  int v5; // r4
  const char *v6; // r0
  int v8; // [sp+Ch] [bp-14h] BYREF
  int v9[4]; // [sp+10h] [bp-10h] BYREF

  v3 = android::Parcel::readInt32(a1, &v8);
  v9[0] = v8;
  v4 = *(_DWORD *)a2[1];
  if ( v3 )
  {
    v5 = *a2;
    v6 = j_requestToString(v4);
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", v5, v6);
  }
  else
  {
    dword_137FC(v4, v9, 4);
    v9[0] = 0;
  }
  return _stack_chk_guard - v9[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (0000929C) --------------------------------------------------------
unsigned int __fastcall sub_929C(android::Parcel *this, __int64 *a2)
{
  int v4; // r6
  int String16Inplace; // r0
  void *v6; // r0
  void *v7; // r0
  __int64 v8; // kr00_8
  const char *v9; // r0
  int v11; // [sp+Ch] [bp-24h] BYREF
  int v12; // [sp+10h] [bp-20h] BYREF
  void *ptr; // [sp+14h] [bp-1Ch]
  unsigned int v14[6]; // [sp+18h] [bp-18h] BYREF

  v12 = 0;
  ptr = 0;
  v4 = android::Parcel::readInt32(this, &v11);
  v12 = v11;
  String16Inplace = android::Parcel::readString16Inplace(this, v14);
  v6 = (void *)strndup16to8(String16Inplace, v14[0]);
  ptr = v6;
  if ( v4 || !v6 )
  {
    v8 = *a2;
    v9 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v8, v9);
  }
  else
  {
    dword_137FC(**((_DWORD **)a2 + 1), &v12, 8);
    v7 = 0;
    if ( ptr )
    {
      memset(ptr, 0, _strlen_chk(ptr, -1));
      v7 = ptr;
    }
    free(v7);
    v12 = 0;
    ptr = 0;
  }
  return _stack_chk_guard - v14[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (0000935C) --------------------------------------------------------
int __fastcall sub_935C(android::Parcel *this, __int64 *a2)
{
  __int64 v4; // kr00_8
  const char *v5; // r0
  int v7; // [sp+Ch] [bp-3Ch] BYREF
  __int64 v8; // [sp+10h] [bp-38h] BYREF
  __int64 v9; // [sp+18h] [bp-30h]
  int v10; // [sp+24h] [bp-24h]

  v8 = 0LL;
  v9 = 0LL;
  if ( android::Parcel::readInt32(this, &v7)
    || (LODWORD(v8) = v7, android::Parcel::readInt32(this, &v7))
    || (HIDWORD(v8) = v7, android::Parcel::readInt32(this, &v7))
    || (LODWORD(v9) = v7, android::Parcel::readInt32(this, &v7)) )
  {
    v4 = *a2;
    v5 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v4, v5);
  }
  else
  {
    HIDWORD(v9) = v7;
    dword_137FC(**((_DWORD **)a2 + 1), &v8, 16);
    v8 = 0LL;
    v9 = 0LL;
  }
  return _stack_chk_guard - v10;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00009420) --------------------------------------------------------
int __fastcall sub_9420(android::Parcel *this, int a2, unsigned int a3)
{
  signed int v6; // r8
  int *v8; // r7
  signed int v9; // r5
  int v10; // r0

  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  v6 = a3 / 0x88;
  if ( a3 % 0x88 )
  {
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "responseHardwareConfig: invalid response length %d expected multiple of %d",
      a3,
      136);
    return -1;
  }
  android::Parcel::writeInt32(this, a3 / 0x88);
  if ( a3 >= 0x88 )
  {
    v8 = (int *)(a2 + 68);
    v9 = 0;
    do
    {
      v10 = *(v8 - 17);
      if ( v10 == 1 )
      {
        sub_72AC((int)this, (int)(v8 - 16));
        android::Parcel::writeInt32(this, *v8);
        sub_72AC((int)this, (int)(v8 + 1));
      }
      else if ( !v10 )
      {
        sub_72AC((int)this, (int)(v8 - 16));
        android::Parcel::writeInt32(this, *v8);
        android::Parcel::writeInt32(this, v8[2]);
        android::Parcel::writeInt32(this, v8[3]);
        android::Parcel::writeInt32(this, v8[4]);
        android::Parcel::writeInt32(this, v8[5]);
      }
      ++v9;
      v8 += 34;
    }
    while ( v9 < v6 );
  }
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000094FC) --------------------------------------------------------
unsigned int __fastcall sub_94FC(android::Parcel *this, __int64 *a2)
{
  int v4; // r6
  int String16Inplace; // r0
  int v6; // r0
  __int64 v7; // kr00_8
  const char *v8; // r0
  int v10; // [sp+Ch] [bp-2Ch] BYREF
  int v11; // [sp+10h] [bp-28h] BYREF
  void *ptr; // [sp+14h] [bp-24h]
  void *v13; // [sp+18h] [bp-20h]
  unsigned int v14[6]; // [sp+20h] [bp-18h] BYREF

  v11 = 0;
  ptr = 0;
  v4 = android::Parcel::readInt32(this, &v10);
  v11 = v10;
  String16Inplace = android::Parcel::readString16Inplace(this, v14);
  ptr = (void *)strndup16to8(String16Inplace, v14[0]);
  v6 = android::Parcel::readString16Inplace(this, v14);
  v13 = (void *)strndup16to8(v6, v14[0]);
  if ( v4 )
  {
    v7 = *a2;
    v8 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v7, v8);
  }
  else
  {
    dword_137FC(**((_DWORD **)a2 + 1), &v11, 12);
    if ( ptr )
      memset(ptr, 0, _strlen_chk(ptr, -1));
    if ( v13 )
      memset(v13, 0, _strlen_chk(v13, -1));
    free(ptr);
    free(v13);
    v11 = 0;
    ptr = 0;
    v13 = 0;
  }
  return _stack_chk_guard - v14[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F9C: using guessed type int __fastcall _strlen_chk(_DWORD, _DWORD);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (000095E8) --------------------------------------------------------
int __fastcall sub_95E8(android::Parcel *this, int a2, int a3)
{
  if ( a3 == 16 )
  {
    android::Parcel::writeInt64(this, *(_QWORD *)a2);
    android::Parcel::writeInt32(this, *(_DWORD *)(a2 + 8));
    return 0;
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "responseDcRtInfo: invalid response length %d expected multiple of %d", a3, 16);
    return -1;
  }
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009630) --------------------------------------------------------
unsigned int __fastcall sub_9630(android::Parcel *this, __int64 *a2)
{
  int v4; // r5
  char *v5; // r10
  _DWORD *v6; // r9
  int v7; // r6
  signed int v8; // r8
  char *v9; // r5
  int String16Inplace; // r0
  int v11; // r0
  int v12; // r0
  int v13; // r0
  int v14; // r0
  __int64 v15; // kr00_8
  const char *v16; // r0
  const char *v18; // r0
  const char *v19; // [sp+0h] [bp-40h]
  __int64 *v20; // [sp+8h] [bp-38h]
  size_t nmemb; // [sp+Ch] [bp-34h] BYREF
  int v22; // [sp+10h] [bp-30h] BYREF
  unsigned int v23[11]; // [sp+14h] [bp-2Ch] BYREF

  if ( !android::Parcel::readInt32(this, (int *)&nmemb) )
  {
    v4 = nmemb;
    if ( (nmemb & 0x80000000) == 0 )
    {
      v5 = (char *)calloc(nmemb, 0x2Cu);
      if ( !v5 )
      {
        v19 = j_requestToString(**((_DWORD **)a2 + 1));
        _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v19);
        return _stack_chk_guard - v23[1];
      }
      v6 = calloc(v4, 4u);
      if ( !v6 )
      {
        v18 = j_requestToString(**((_DWORD **)a2 + 1));
        _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v18);
        free(v5);
        return _stack_chk_guard - v23[1];
      }
      if ( v4 < 1 )
        goto LABEL_14;
      v20 = a2;
      v7 = 0;
      v8 = 0;
      do
      {
        v9 = &v5[v7];
        v6[v8] = &v5[v7];
        android::Parcel::readInt32(this, &v22);
        *(_DWORD *)&v5[v7] = v22;
        String16Inplace = android::Parcel::readString16Inplace(this, v23);
        *((_DWORD *)v9 + 1) = strndup16to8(String16Inplace, v23[0]);
        v11 = android::Parcel::readString16Inplace(this, v23);
        *((_DWORD *)v9 + 2) = strndup16to8(v11, v23[0]);
        android::Parcel::readInt32(this, &v22);
        *((_DWORD *)v9 + 3) = v22;
        v12 = android::Parcel::readString16Inplace(this, v23);
        *((_DWORD *)v9 + 4) = strndup16to8(v12, v23[0]);
        v13 = android::Parcel::readString16Inplace(this, v23);
        *((_DWORD *)v9 + 5) = strndup16to8(v13, v23[0]);
        android::Parcel::readInt32(this, &v22);
        *((_DWORD *)v9 + 6) = v22;
        android::Parcel::readInt32(this, &v22);
        *((_DWORD *)v9 + 7) = v22;
        android::Parcel::readInt32(this, &v22);
        *((_DWORD *)v9 + 8) = v22;
        android::Parcel::readInt32(this, &v22);
        *((_DWORD *)v9 + 9) = v22;
        v14 = android::Parcel::readInt32(this, &v22);
        v7 += 44;
        ++v8;
        *((_DWORD *)v9 + 10) = v22;
        v4 = nmemb;
      }
      while ( v8 < (int)nmemb );
      a2 = v20;
      if ( !v14 )
      {
LABEL_14:
        dword_137FC(**((_DWORD **)a2 + 1), v6, 4 * v4);
        memset(v6, 0, 4 * nmemb);
        free(v5);
        free(v6);
        return _stack_chk_guard - v23[1];
      }
      free(v5);
      free(v6);
    }
  }
  v15 = *a2;
  v16 = j_requestToString(**((_DWORD **)a2 + 1));
  _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v15, v16);
  return _stack_chk_guard - v23[1];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 31D0: using guessed type int __fastcall strndup16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (00009808) --------------------------------------------------------
int __fastcall sub_9808(android::Parcel *this, int *a2, int a3)
{
  if ( a2 )
  {
    if ( a3 == 84 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(this, a2[1]);
      android::Parcel::writeInt32(this, a2[2]);
      android::Parcel::writeInt32(this, a2[3]);
      sub_72AC((int)this, (int)(a2 + 4));
      android::Parcel::writeInt32(this, a2[20]);
      return 0;
    }
    _android_log_buf_print(1, 6, "RILC", "invalid response length was %d expected %d", a3, 12);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
  }
  return -1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009884) --------------------------------------------------------
int __fastcall sub_9884(android::Parcel *a1, __int64 *a2)
{
  int v4; // r0
  int v5; // r0
  int v6; // r0
  int v7; // r0
  int v8; // r0
  int v9; // r7
  int v10; // r0
  __int64 v11; // kr00_8
  const char *v12; // r0
  int v14; // [sp+8h] [bp-78h] BYREF
  unsigned int v15; // [sp+Ch] [bp-74h] BYREF
  int v16[28]; // [sp+10h] [bp-70h] BYREF

  memset(v16, 0, 0x54u);
  v4 = android::Parcel::readInt32(a1, &v14);
  v16[0] = v14;
  if ( v4 )
    goto LABEL_9;
  v5 = android::Parcel::readInt32(a1, &v14);
  v16[1] = v14;
  if ( v5 )
    goto LABEL_9;
  v6 = android::Parcel::readInt32(a1, &v14);
  v16[2] = v14;
  if ( v6
    || (v7 = android::Parcel::readInt32(a1, &v14), v16[3] = v14, v7)
    || (v8 = android::Parcel::readString16Inplace(a1, &v15), (v9 = v8) == 0)
    || (unsigned int)(strnlen16to8(v8, v15) + 1) > 0x40
    || !strncpy16to8(&v16[4], v9)
    || (v10 = android::Parcel::readInt32(a1, &v14), v16[20] = v14, v10) )
  {
LABEL_9:
    v11 = *a2;
    v12 = j_requestToString(**((_DWORD **)a2 + 1));
    _android_log_buf_print(1, 6, "RILC", "invalid command block for token %d request %s", (_DWORD)v11, v12);
  }
  else
  {
    dword_137FC(**((_DWORD **)a2 + 1), v16, 84);
  }
  return _stack_chk_guard - v16[22];
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 3290: using guessed type int __fastcall strnlen16to8(_DWORD, _DWORD);
// 329C: using guessed type int __fastcall strncpy16to8(_DWORD, _DWORD);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);

//----- (0000997C) --------------------------------------------------------
int __fastcall sub_997C(android::Parcel *this, void *a2, int a3)
{
  if ( a2 && a3 == 8 )
  {
    android::Parcel::write(this, a2, 1u);
    android::Parcel::writeInt32(this, *((_DWORD *)a2 + 1));
    return 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseLceStatus: invalid response length %d expecting len: d%", 8, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (000099DC) --------------------------------------------------------
int __fastcall sub_99DC(android::Parcel *this, int *a2, int a3)
{
  if ( a2 && a3 == 8 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::write(this, a2 + 1, 1u);
    android::Parcel::write(this, (char *)a2 + 5, 1u);
    return 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseLceData: invalid response length %d expecting len: d%", 8, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009A48) --------------------------------------------------------
int __fastcall sub_9A48(android::Parcel *this, int *a2, int a3)
{
  int i; // r6

  if ( a2 && a3 == 32 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::writeInt32(this, a2[1]);
    for ( i = 2; i != 7; ++i )
      android::Parcel::writeInt32(this, a2[i]);
    android::Parcel::writeInt32(this, a2[7]);
    return 0;
  }
  else
  {
    if ( a2 )
      _android_log_buf_print(1, 6, "RILC", "responseActivityData: invalid response length %d expecting len: d%", 32, a3);
    else
      _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009AC0) --------------------------------------------------------
int __fastcall sub_9AC0(android::Parcel *a1, int *a2)
{
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(a1, a2[1]);
  android::Parcel::writeInt32(a1, a2[2]);
  android::Parcel::writeInt32(a1, a2[3]);
  android::Parcel::writeInt32(a1, a2[4]);
  return sub_9AFC(a1, a2[5], (int)(a2 + 6));
}

//----- (00009AFC) --------------------------------------------------------
int __fastcall sub_9AFC(android::Parcel *a1, int a2, int a3)
{
  int v4; // r4
  int result; // r0
  int *v7; // r6

  v4 = a2;
  result = android::Parcel::writeInt32(a1, a2);
  if ( v4 >= 1 )
  {
    v7 = (int *)(a3 + 16);
    do
    {
      android::Parcel::writeInt32(a1, *(v7 - 4));
      android::Parcel::writeInt32(a1, *(v7 - 3));
      android::Parcel::writeInt32(a1, *(v7 - 2));
      sub_72AC((int)a1, *(v7 - 1));
      sub_72AC((int)a1, *v7);
      android::Parcel::writeInt32(a1, v7[1]);
      android::Parcel::writeInt32(a1, v7[2]);
      result = android::Parcel::writeInt32(a1, v7[3]);
      v7 += 8;
      --v4;
    }
    while ( v4 );
  }
  return result;
}

//----- (00009B5E) --------------------------------------------------------
int __fastcall sub_9B5E(android::Parcel *a1, int *a2)
{
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(a1, a2[1]);
  android::Parcel::writeInt32(a1, a2[2]);
  android::Parcel::writeInt32(a1, a2[3]);
  android::Parcel::writeInt32(a1, a2[5]);
  android::Parcel::writeInt32(a1, a2[6]);
  return android::Parcel::writeInt32(a1, a2[7]);
}

//----- (00009B9E) --------------------------------------------------------
int __fastcall sub_9B9E(android::Parcel *this, _DWORD *a2)
{
  int v4; // r1
  int v5; // r0
  int v6; // r0

  v4 = a2[8];
  if ( v4 == -1 )
  {
    v4 = 99;
    a2[8] = 99;
  }
  v5 = a2[9];
  if ( v5 == -1 )
  {
    v6 = 0x7FFFFFFF;
  }
  else
  {
    if ( v5 >= -1 )
      goto LABEL_8;
    v6 = -v5;
  }
  a2[9] = v6;
LABEL_8:
  if ( a2[10] == -1 )
    a2[10] = 0x7FFFFFFF;
  if ( a2[12] == -1 )
    a2[12] = 0x7FFFFFFF;
  android::Parcel::writeInt32(this, v4);
  android::Parcel::writeInt32(this, a2[9]);
  android::Parcel::writeInt32(this, a2[10]);
  android::Parcel::writeInt32(this, a2[11]);
  return android::Parcel::writeInt32(this, a2[12]);
}

//----- (00009C0C) --------------------------------------------------------
int __fastcall sub_9C0C(android::Parcel *this, int a2, unsigned int a3)
{
  signed int v6; // r5
  int *v8; // r6
  signed int v9; // r7

  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  v6 = a3 / 0x2C;
  if ( a3 % 0x2C )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response length %d expected multiple of %d", a3, 44);
    return -1;
  }
  android::Parcel::writeInt32(this, 11);
  android::Parcel::writeInt32(this, a3 / 0x2C);
  if ( a3 >= 0x2C )
  {
    v8 = (int *)(a2 + 20);
    v9 = 0;
    do
    {
      android::Parcel::writeInt32(this, *(v8 - 5));
      android::Parcel::writeInt32(this, *(v8 - 4));
      android::Parcel::writeInt32(this, *(v8 - 3));
      android::Parcel::writeInt32(this, *(v8 - 2));
      sub_72AC((int)this, *(v8 - 1));
      sub_72AC((int)this, *v8);
      sub_72AC((int)this, v8[1]);
      sub_72AC((int)this, v8[2]);
      sub_72AC((int)this, v8[3]);
      sub_72AC((int)this, v8[4]);
      android::Parcel::writeInt32(this, v8[5]);
      ++v9;
      v8 += 11;
    }
    while ( v9 < v6 );
  }
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (00009CF0) --------------------------------------------------------
int __fastcall sub_9CF0(android::Parcel *a1, int *a2)
{
  int v4; // r5
  int v5; // r9
  bool v6; // cf
  int i; // r6
  int v8; // r0
  int j; // r7
  int result; // r0
  int v11; // r6
  bool v12; // cc
  int k; // r5
  unsigned __int8 v14; // [sp+7h] [bp-29h] BYREF
  int v15; // [sp+8h] [bp-28h] BYREF

  memset(a2, 0, 0x174u);
  android::Parcel::readInt32(a1, &v15);
  *a2 = v15;
  android::Parcel::read(a1, &v14, 1u);
  *((_BYTE *)a2 + 4) = v14;
  android::Parcel::readInt32(a1, &v15);
  a2[2] = v15;
  android::Parcel::readInt32(a1, &v15);
  a2[3] = v15;
  android::Parcel::readInt32(a1, &v15);
  a2[4] = v15;
  android::Parcel::readInt32(a1, &v15);
  a2[5] = v15;
  android::Parcel::readInt32(a1, &v15);
  a2[6] = v15;
  android::Parcel::read(a1, &v14, 1u);
  v4 = v14;
  v5 = 36;
  v6 = v14 >= 0x24u;
  *((_BYTE *)a2 + 28) = v14;
  if ( v6 )
    v4 = 36;
  if ( v4 )
  {
    for ( i = 0; i < v4; ++i )
    {
      android::Parcel::read(a1, &v14, 1u);
      *((_BYTE *)a2 + i + 29) = v14;
    }
  }
  android::Parcel::readInt32(a1, &v15);
  a2[17] = v15;
  android::Parcel::read(a1, &v14, 1u);
  *((_BYTE *)a2 + 72) = v14;
  android::Parcel::read(a1, &v14, 1u);
  v8 = v14;
  v6 = v14 >= 0x24u;
  *((_BYTE *)a2 + 73) = v14;
  if ( !v6 )
    v5 = v8;
  if ( v5 )
  {
    for ( j = 0; j < v5; ++j )
    {
      android::Parcel::read(a1, &v14, 1u);
      *((_BYTE *)a2 + j + 74) = v14;
    }
  }
  result = android::Parcel::readInt32(a1, &v15);
  v11 = v15;
  v12 = v15 < 255;
  a2[28] = v15;
  if ( !v12 )
    v11 = 255;
  if ( v11 >= 1 )
  {
    for ( k = 0; k < v11; ++k )
    {
      result = android::Parcel::read(a1, &v14, 1u);
      *((_BYTE *)a2 + k + 116) = v14;
    }
  }
  return result;
}

//----- (00009E78) --------------------------------------------------------
int __fastcall sub_9E78(android::Parcel *this, int a2, unsigned int a3)
{
  int v3; // r6
  signed int v6; // r8
  signed int v8; // r7
  int v9; // r1

  v3 = a2;
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  v6 = a3 / 0x48;
  if ( a3 % 0x48 )
  {
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "responseCellInfoList: invalid response length %d expected multiple of %d",
      a3,
      72);
    return -1;
  }
  android::Parcel::writeInt32(this, a3 / 0x48);
  if ( a3 >= 0x48 )
  {
    v8 = 0;
    do
    {
      android::Parcel::writeInt32(this, *(_DWORD *)v3);
      android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 4));
      android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 8));
      android::Parcel::writeInt64(this, *(_QWORD *)(v3 + 16));
      switch ( *(_DWORD *)v3 )
      {
        case 1:
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 24));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 28));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 32));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 36));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 40));
          android::Parcel::writeInt32(this, *(unsigned __int8 *)(v3 + 44));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 48));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 52));
          v9 = *(_DWORD *)(v3 + 56);
          goto LABEL_15;
        case 2:
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 24));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 28));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 32));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 36));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 40));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 44));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 48));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 56));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 60));
          v9 = *(_DWORD *)(v3 + 64);
          goto LABEL_15;
        case 3:
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 24));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 28));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 32));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 36));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 40));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 44));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 48));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 52));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 56));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 60));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 64));
          v9 = *(_DWORD *)(v3 + 68);
          goto LABEL_15;
        case 4:
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 24));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 28));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 32));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 36));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 40));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 44));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 48));
          v9 = *(_DWORD *)(v3 + 52);
          goto LABEL_15;
        case 5:
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 24));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 28));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 32));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 36));
          android::Parcel::writeInt32(this, *(_DWORD *)(v3 + 40));
          v9 = *(_DWORD *)(v3 + 44);
LABEL_15:
          android::Parcel::writeInt32(this, v9);
          break;
        default:
          break;
      }
      ++v8;
      v3 += 72;
    }
    while ( v8 < v6 );
  }
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A090) --------------------------------------------------------
void __fastcall sub_A090(int a1, void **a2)
{
  int v2; // r5
  void **v4; // r6

  v2 = a1;
  if ( a1 > 0 )
  {
    v4 = a2;
    do
    {
      if ( *v4 )
        free(*v4);
      --v2;
      ++v4;
    }
    while ( v2 );
  }
  j_free(a2);
}

//----- (0000A0B8) --------------------------------------------------------
int __fastcall sub_A0B8(int a1, int a2, int a3, int a4)
{
  int *v6; // r5
  pthread_mutex_t *v7; // r6
  _DWORD *v10; // r0
  _DWORD *v11; // r7
  char *v12; // r0
  const char *v13; // r0
  int v15; // r0

  v6 = (int *)&unk_13964;
  if ( a4 == 1 )
    v6 = &dword_1396C;
  v7 = (pthread_mutex_t *)&unk_13960;
  if ( a4 == 1 )
    v7 = (pthread_mutex_t *)&unk_13968;
  v10 = calloc(1u, 0x18u);
  v11 = v10;
  if ( v10 )
  {
    *((_BYTE *)v10 + 13) = 1;
    *v10 = -1;
    if ( a1 < 5000 )
      v12 = (char *)&unk_13180 + 12 * a1;
    else
      v12 = (char *)&unk_13024 + 12 * a1 - 60000;
    v11[1] = v12;
    v11[4] = a4;
    pthread_mutex_lock(v7);
    v15 = *v6;
    *v6 = (int)v11;
    v11[2] = v15;
    pthread_mutex_unlock(v7);
    return dword_137FC(a1, a2, a3);
  }
  else
  {
    v13 = j_requestToString(a1);
    return _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for request %s", v13);
  }
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 137FC: using guessed type int (__fastcall *dword_137FC)(_DWORD, _DWORD, _DWORD);
// 1396C: using guessed type int dword_1396C;

//----- (0000A19C) --------------------------------------------------------
int sub_A19C()
{
  pthread_t v0; // r0
  int result; // r0

  v0 = pthread_self();
  result = pthread_equal(v0, dword_1381C);
  if ( !result )
  {
    do
    {
      result = _write_chk(dword_13938, " ", 1, 2);
      if ( result > -1 )
        break;
      result = *(_DWORD *)_errno();
    }
    while ( result == 4 );
  }
  return result;
}
// 2F78: using guessed type int _errno(void);
// 311C: using guessed type int __fastcall _write_chk(_DWORD, _DWORD, _DWORD, _DWORD);
// 1381C: using guessed type int dword_1381C;
// 13938: using guessed type int dword_13938;

//----- (0000A1E0) --------------------------------------------------------
int __fastcall sub_A1E0(void *a1, unsigned int a2, int a3)
{
  pthread_mutex_t *v5; // r5
  int v6; // r6
  int v7; // r7
  int v8; // r4
  unsigned int v10; // [sp+8h] [bp-20h] BYREF

  v5 = (pthread_mutex_t *)&unk_13970;
  if ( a3 == 1 )
    v5 = (pthread_mutex_t *)&unk_13974;
  v6 = dword_1389C;
  if ( a3 != 1 )
    v6 = dword_13830;
  if ( v6 < 0 )
    return -1;
  if ( a2 > 0x2000 )
  {
    _android_log_buf_print(1, 6, "RILC", "RIL: packet larger than %u (%u)", 0x2000, a2);
    return -1;
  }
  pthread_mutex_lock(v5);
  v10 = bswap32(a2);
  v7 = blockingWrite_helper(v6, &v10, 4u);
  if ( v7 <= -1 )
  {
    pthread_mutex_unlock(v5);
  }
  else
  {
    v8 = blockingWrite_helper(v6, a1, a2);
    pthread_mutex_unlock(v5);
    return v8 & (v8 >> 31);
  }
  return v7;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 13830: using guessed type int dword_13830;
// 1389C: using guessed type int dword_1389C;

//----- (0000A2B0) --------------------------------------------------------
int __fastcall sub_A2B0(int a1, int a2, unsigned int a3)
{
  int v5; // r5
  unsigned int v6; // r8
  int v7; // r4
  _DWORD *v8; // r7

  v5 = 0;
  if ( a3 )
  {
    v6 = 0;
    while ( 1 )
    {
      v7 = _recvfrom_chk(a1, a2 + v6, a3 - v6, -1, 0, 0, 0);
      if ( v7 <= 0 )
        break;
LABEL_8:
      v6 += v7;
      if ( v6 >= a3 )
        return 0;
    }
    v8 = (_DWORD *)_errno();
    while ( *v8 == 4 || *v8 == 11 )
    {
      v7 = _recvfrom_chk(a1, a2 + v6, a3 - v6, -1, 0, 0, 0);
      if ( v7 >= 1 )
        goto LABEL_8;
    }
    _android_log_buf_print(1, 6, "RILC", "[blockingRead] reader:%d, errno:%d", v7, *v8);
    close(a1);
    return -1;
  }
  return v5;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int _errno(void);
// 30A4: using guessed type int __fastcall _recvfrom_chk(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (0000A354) --------------------------------------------------------
int __fastcall sub_A354(android::Parcel *this, int *a2, int a3)
{
  if ( a2 )
  {
    if ( a3 == 20 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(this, a2[1]);
      android::Parcel::writeInt32(this, a2[2]);
      android::Parcel::writeInt32(this, a2[3]);
      sub_72AC((int)this, a2[4]);
      return 0;
    }
    _android_log_buf_print(1, 6, "RILC", "invalid response length was %d expected %d", a3, 20);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
  }
  return -1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A3C8) --------------------------------------------------------
int __fastcall sub_A3C8(android::Parcel *this, int *a2, unsigned int a3)
{
  int v5; // r5
  char v7[92]; // [sp+0h] [bp-70h] BYREF

  if ( a2 || !a3 )
  {
    if ( android::s_callbacks > 12 )
    {
      if ( a3 % 0xC )
      {
        _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_SimRefreshResponse_v7");
        property_get("ro.debuggable", v7, "0");
        if ( strcmp(v7, "1") )
          return -1;
      }
    }
    else if ( android::s_callbacks < 7 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(this, a2[1]);
      v5 = 0;
      sub_72AC((int)this, 0);
      return v5;
    }
    sub_AC04(this, a2);
    return 0;
  }
  _android_log_buf_print(1, 6, "RILC", "responseSimRefresh: invalid response: NULL");
  return -1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 31F4: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;

//----- (0000A4B4) --------------------------------------------------------
int __fastcall sub_A4B4(android::Parcel *a1, unsigned __int8 *a2, int a3)
{
  int result; // r0

  result = 0;
  if ( a2 && a3 )
  {
    if ( a3 == 4 )
    {
      sub_AC24(a1, a2);
      return 0;
    }
    else
    {
      _android_log_buf_print(
        1,
        6,
        "RILC",
        "invalid response length %d expected sizeof (RIL_CDMA_SignalInfoRecord) of %d\n",
        a3,
        4);
      return -1;
    }
  }
  return result;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A4F4) --------------------------------------------------------
int __fastcall sub_A4F4(android::Parcel *a1, int *a2, int a3)
{
  int v6; // r7
  int v7; // r9
  int i; // r6
  int j; // r6
  int v10; // r6
  int k; // r7

  _android_log_buf_print(1, 4, "RILC", "Inside responseCdmaSms");
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( a3 != 372 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response length was %d expected %d", a3, 372);
    return -1;
  }
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::write(a1, a2 + 1, 1u);
  android::Parcel::writeInt32(a1, a2[2]);
  android::Parcel::writeInt32(a1, a2[3]);
  android::Parcel::writeInt32(a1, a2[4]);
  android::Parcel::writeInt32(a1, a2[5]);
  android::Parcel::writeInt32(a1, a2[6]);
  android::Parcel::write(a1, a2 + 7, 1u);
  v6 = *((unsigned __int8 *)a2 + 28);
  v7 = 36;
  if ( (unsigned int)v6 >= 0x24 )
    v6 = 36;
  if ( v6 )
  {
    for ( i = 0; i < v6; ++i )
      android::Parcel::write(a1, (char *)a2 + i + 29, 1u);
  }
  android::Parcel::writeInt32(a1, a2[17]);
  android::Parcel::write(a1, a2 + 18, 1u);
  android::Parcel::write(a1, (char *)a2 + 73, 1u);
  if ( *((unsigned __int8 *)a2 + 73) < 0x24u )
    v7 = *((unsigned __int8 *)a2 + 73);
  if ( v7 )
  {
    for ( j = 0; j < v7; ++j )
      android::Parcel::write(a1, (char *)a2 + j + 74, 1u);
  }
  v10 = a2[28];
  android::Parcel::writeInt32(a1, v10);
  if ( v10 >= 255 )
    v10 = 255;
  if ( v10 >= 1 )
  {
    for ( k = 0; k < v10; ++k )
      android::Parcel::write(a1, (char *)a2 + k + 116, 1u);
  }
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000A654) --------------------------------------------------------
int __fastcall sub_A654(android::Parcel *a1, int a2, unsigned int a3)
{
  int v6; // r5
  char v8[92]; // [sp+8h] [bp-70h] BYREF

  if ( a2 || !a3 )
  {
    if ( a3 <= 0x17 )
      _android_log_buf_print(1, 5, "RILC", "Upgrade to ril version %d\n", 12);
    sub_72AC((int)a1, *(_DWORD *)a2);
    android::Parcel::writeInt32(a1, *(_DWORD *)(a2 + 4));
    sub_72AC((int)a1, *(_DWORD *)(a2 + 8));
    sub_AC24(a1, (unsigned __int8 *)(a2 + 12));
    if ( android::s_callbacks > 12 )
    {
      if ( a3 % 0x18 )
      {
        _android_log_buf_print(1, 6, "RILC", "Data structure expected is RIL_CDMA_CallWaiting_v6");
        property_get("ro.debuggable", v8, "0");
        if ( strcmp(v8, "1") )
          return -1;
      }
    }
    else if ( a3 < 0x18 )
    {
      v6 = 0;
      android::Parcel::writeInt32(a1, 0);
      android::Parcel::writeInt32(a1, 0);
      return v6;
    }
    android::Parcel::writeInt32(a1, *(_DWORD *)(a2 + 16));
    android::Parcel::writeInt32(a1, *(_DWORD *)(a2 + 20));
    return 0;
  }
  _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
  return -1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 31F4: using guessed type int __fastcall property_get(_DWORD, _DWORD, _DWORD);
// 137F8: using guessed type int android::s_callbacks;

//----- (0000A784) --------------------------------------------------------
int __fastcall sub_A784(android::Parcel *this, unsigned __int8 *a2, int a3)
{
  int v5; // r9
  int v6; // r10
  int *v7; // r6
  int v8; // r8
  unsigned int v9; // r5
  char *v10; // r4
  size_t v11; // r2
  int v12; // r1
  unsigned int v13; // r10
  char *v14; // r4
  size_t v15; // r2
  unsigned int v16; // r5
  char *v17; // r4
  size_t v18; // r2

  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
  if ( a3 != 964 )
  {
    _android_log_buf_print(
      1,
      6,
      "RILC",
      "responseCdmaInformationRecords: invalid response length %d expected multiple of %d\n",
      a3,
      4);
    return -1;
  }
  v5 = *a2;
  if ( (unsigned int)v5 >= 0xA )
    v5 = 10;
  android::Parcel::writeInt32(this, v5);
  v6 = 0;
  if ( v5 )
  {
    v7 = (int *)(a2 + 96);
    v8 = 0;
    while ( 1 )
    {
      android::Parcel::writeInt32(this, *(v7 - 23));
      switch ( *(v7 - 23) )
      {
        case 0:
        case 7:
          v13 = *((unsigned __int8 *)v7 - 88);
          if ( v13 >= 0x41 )
          {
            _android_log_buf_print(
              1,
              6,
              "RILC",
              "invalid display info response length %d                           expected not more than %d\n",
              *((unsigned __int8 *)v7 - 88),
              64);
            return -1;
          }
          v14 = (char *)calloc(v13 + 1, 1u);
          if ( !v14 )
            goto LABEL_47;
          if ( v13 )
          {
            v15 = v13;
            if ( v13 <= 1 )
              v15 = 1;
            qmemcpy(v14, (char *)v7 - 87, v15);
          }
          v14[v13] = 0;
          sub_72AC((int)this, (int)v14);
          free(v14);
          goto LABEL_35;
        case 1:
        case 2:
        case 3:
          v9 = *((unsigned __int8 *)v7 - 88);
          if ( v9 >= 0x52 )
            goto LABEL_42;
          v10 = (char *)calloc(v9 + 1, 1u);
          if ( !v10 )
            goto LABEL_47;
          if ( v9 )
          {
            v11 = v9;
            if ( v9 <= 1 )
              v11 = 1;
            qmemcpy(v10, (char *)v7 - 87, v11);
          }
          v10[v9] = 0;
          sub_72AC((int)this, (int)v10);
          free(v10);
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 6));
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 5));
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 4));
          v12 = *((unsigned __int8 *)v7 - 3);
          goto LABEL_34;
        case 4:
        case 6:
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 88));
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 87));
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 86));
          v12 = *((unsigned __int8 *)v7 - 85);
          goto LABEL_34;
        case 5:
          v16 = *((unsigned __int8 *)v7 - 88);
          if ( v16 >= 0x52 )
          {
LABEL_42:
            _android_log_buf_print(
              1,
              6,
              "RILC",
              "invalid display info response length %d                           expected not more than %d\n",
              *((unsigned __int8 *)v7 - 88),
              81);
            return -1;
          }
          v17 = (char *)calloc(v16 + 1, 1u);
          if ( !v17 )
          {
LABEL_47:
            _android_log_buf_print(1, 6, "RILC", "Memory allocation failed for responseCdmaInformationRecords");
            return -12;
          }
          if ( v16 )
          {
            v18 = v16;
            if ( v16 <= 1 )
              v18 = 1;
            qmemcpy(v17, (char *)v7 - 87, v18);
          }
          v17[v16] = 0;
          sub_72AC((int)this, (int)v17);
          free(v17);
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 6));
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 5));
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 4));
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 3));
          v12 = *v7;
LABEL_34:
          android::Parcel::writeInt32(this, v12);
LABEL_35:
          ++v8;
          v7 += 24;
          if ( v8 >= v5 )
            return 0;
          break;
        case 8:
          v12 = *((unsigned __int8 *)v7 - 88);
          goto LABEL_34;
        case 9:
          _android_log_buf_print(1, 6, "RILC", "RIL_CDMA_T53_RELEASE_INFO_REC: return INVALID_RESPONSE");
          return -1;
        case 10:
          android::Parcel::writeInt32(this, *((unsigned __int8 *)v7 - 88));
          v12 = *((unsigned __int8 *)v7 - 87);
          goto LABEL_34;
        default:
          _android_log_buf_print(1, 6, "RILC", "Incorrect name value");
          return -1;
      }
    }
  }
  return v6;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000AA44) --------------------------------------------------------
int __fastcall sub_AA44(android::Parcel *a1, int *a2, int a3)
{
  int v6; // r5
  int *v7; // r10
  int v8; // r5
  __int64 v9; // kr00_8
  __int64 v10; // kr08_8
  int v11; // r8
  int *v13; // r7
  int i; // r5
  int v16; // [sp+1Ch] [bp-2Ch]
  int v17; // [sp+20h] [bp-28h]

  _android_log_buf_print(1, 3, "RILC", "In responseSSData");
  if ( !a2 && a3 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response length was %d expected %d", a3, 12);
    return -1;
  }
  if ( a3 != 192 )
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response length %d, expected %d", a3, 192);
    return -1;
  }
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(a1, a2[1]);
  android::Parcel::writeInt32(a1, a2[2]);
  android::Parcel::writeInt32(a1, a2[3]);
  android::Parcel::writeInt32(a1, a2[4]);
  if ( a2[1] == 2 && (*a2 | 1u) - 1 <= 4 )
  {
    _android_log_buf_print(1, 3, "RILC", "responseSSData CF type, num of Cf elements %d", a2[5]);
    v6 = a2[5];
    if ( v6 >= 8 )
    {
      v6 = 7;
      _android_log_buf_print(
        1,
        6,
        "RILC",
        "numValidIndexes is greater than max value %d, truncating it to max value",
        7);
      a2[5] = 7;
    }
    android::Parcel::writeInt32(a1, v6);
    if ( a2[5] >= 1 )
    {
      v7 = a2 + 11;
      v8 = 0;
      do
      {
        v17 = *(v7 - 5);
        v9 = *((_QWORD *)v7 - 2);
        v16 = *(v7 - 3);
        v10 = *((_QWORD *)v7 - 1);
        v11 = *v7;
        android::Parcel::writeInt32(a1, v17);
        android::Parcel::writeInt32(a1, v9);
        android::Parcel::writeInt32(a1, SHIDWORD(v9));
        android::Parcel::writeInt32(a1, v10);
        sub_72AC((int)a1, SHIDWORD(v10));
        android::Parcel::writeInt32(a1, v11);
        _android_log_buf_print(
          1,
          3,
          "RILC",
          "Data: %d,reason=%d,cls=%d,toa=%d,num=%s,tout=%d],",
          v17,
          (_DWORD)v9,
          v16,
          (_DWORD)v10,
          (const char *)HIDWORD(v10),
          v11);
        ++v8;
        v7 += 6;
      }
      while ( v8 < a2[5] );
    }
  }
  else
  {
    android::Parcel::writeInt32(a1, 4);
    v13 = a2 + 5;
    for ( i = 0; i != 4; ++i )
    {
      _android_log_buf_print(1, 3, "RILC", "Data: %d", v13[i]);
      android::Parcel::writeInt32(a1, v13[i]);
    }
  }
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000AC04) --------------------------------------------------------
int __fastcall sub_AC04(android::Parcel *a1, int *a2)
{
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(a1, a2[1]);
  return sub_72AC((int)a1, a2[2]);
}

//----- (0000AC24) --------------------------------------------------------
int __fastcall sub_AC24(android::Parcel *a1, unsigned __int8 *a2)
{
  android::Parcel::writeInt32(a1, *a2);
  android::Parcel::writeInt32(a1, a2[1]);
  android::Parcel::writeInt32(a1, a2[2]);
  return android::Parcel::writeInt32(a1, a2[3]);
}

//----- (0000AC4C) --------------------------------------------------------
int __fastcall sub_AC4C(android::Parcel *this, int *a2, int a3)
{
  if ( a2 )
  {
    if ( a3 == 20 )
    {
      android::Parcel::writeInt32(this, *a2);
      android::Parcel::writeInt32(this, a2[1]);
      android::Parcel::writeInt32(this, a2[2]);
      android::Parcel::writeInt32(this, a2[3]);
      sub_72AC((int)this, a2[4]);
      return 0;
    }
    _android_log_buf_print(1, 6, "RILC", "invalid response length was %d expected %d", a3, 20);
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
  }
  return -1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000ACC0) --------------------------------------------------------
int __fastcall sub_ACC0(android::Parcel *this, int *a2)
{
  if ( a2 )
  {
    android::Parcel::writeInt32(this, *a2);
    android::Parcel::writeInt32(this, a2[1]);
    android::Parcel::writeInt32(this, a2[2]);
    sub_72AC((int)this, a2[3]);
    return 0;
  }
  else
  {
    _android_log_buf_print(1, 6, "RILC", "invalid response: NULL");
    return -1;
  }
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000AD0C) --------------------------------------------------------
void __fastcall sub_AD0C(int a1, int a2, _DWORD *a3)
{
  ((void (__fastcall *)(_DWORD))*a3)(a3[1]);
  if ( dword_13928 && (_DWORD *)dword_13928 == a3 )
    dword_13928 = 0;
  j_free(a3);
}
// 13928: using guessed type int dword_13928;

//----- (0000AD3C) --------------------------------------------------------
_QWORD *ril_event_init(void)
{
  _QWORD *result; // r0

  pthread_mutex_init((pthread_mutex_t *)&unk_13980, 0);
  memset(&unk_13988, 0, 0x80u);
  dword_13A28 = 0;
  *(_QWORD *)&dword_13A10 = 0xFFFFFFFFLL;
  unk_13A18 = 0LL;
  unk_13A20 = 0LL;
  dword_13A08 = (int)&dword_13A08;
  *(_DWORD *)algn_13A0C = &dword_13A08;
  dword_13A50 = 0;
  *(_QWORD *)&dword_13A30 = 0x13A3000013A30LL;
  *(_QWORD *)&dword_13A38 = 0xFFFFFFFFLL;
  unk_13A40 = 0LL;
  unk_13A48 = 0LL;
  unk_13A58 = 0LL;
  unk_13A60 = 0LL;
  result = qword_13A68;
  qword_13A68[0] = 0LL;
  qword_13A68[1] = 0LL;
  return result;
}
// 13A08: using guessed type int dword_13A08;
// 13A10: using guessed type int dword_13A10;
// 13A28: using guessed type int dword_13A28;
// 13A30: using guessed type int dword_13A30;
// 13A38: using guessed type int dword_13A38;
// 13A50: using guessed type int dword_13A50;
// 13A68: using guessed type _QWORD[2];

//----- (0000ADAC) --------------------------------------------------------
int __fastcall ril_event_set(int a1, int fd, char a3, int a4, int a5)
{
  *(_QWORD *)a1 = 0LL;
  *(_QWORD *)(a1 + 8) = 0LL;
  *(_QWORD *)(a1 + 16) = 0LL;
  *(_QWORD *)(a1 + 24) = 0LL;
  *(_DWORD *)(a1 + 8) = fd;
  *(_DWORD *)(a1 + 12) = -1;
  *(_BYTE *)(a1 + 16) = a3;
  *(_DWORD *)(a1 + 28) = a4;
  *(_DWORD *)(a1 + 32) = a5;
  return fcntl(fd, 4, 2048);
}

//----- (0000ADE0) --------------------------------------------------------
int __fastcall ril_event_add(int a1)
{
  int v2; // r0
  int v3; // r0

  pthread_mutex_lock((pthread_mutex_t *)&unk_13980);
  v2 = 0;
  while ( dword_13A58[v2] )
  {
    if ( ++v2 >= 8 )
      return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_13980);
  }
  dword_13A58[v2] = a1;
  *(_DWORD *)(a1 + 12) = v2;
  _FD_SET_chk(*(_DWORD *)(a1 + 8), &unk_13988, 128);
  v3 = *(_DWORD *)(a1 + 8);
  if ( v3 >= dword_13A78 )
    dword_13A78 = v3 + 1;
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_13980);
}
// 32CC: using guessed type int __fastcall _FD_SET_chk(_DWORD, _DWORD, _DWORD);
// 13A58: using guessed type _DWORD dword_13A58[2];
// 13A78: using guessed type int dword_13A78;

//----- (0000AE54) --------------------------------------------------------
int __fastcall ril_timer_add(int **a1, _DWORD *a2)
{
  int *v4; // r6
  __int64 v5; // r0
  int v6; // r3
  int *v7; // r0
  struct timeval tv; // [sp+4h] [bp-1Ch] BYREF

  pthread_mutex_lock((pthread_mutex_t *)&unk_13980);
  if ( a2 )
  {
    v4 = (int *)dword_13A08;
    a1[2] = (int *)-1;
    gettimeofday(&tv, 0);
    LODWORD(v5) = *a2 + tv.tv_sec;
    a1[5] = (int *)v5;
    HIDWORD(v5) = a2[1] + tv.tv_usec;
    a1[6] = (int *)HIDWORD(v5);
    if ( SHIDWORD(v5) >= 1000000 )
    {
      LODWORD(v5) = v5 + 1;
      HIDWORD(v5) -= 1000000;
      *(_QWORD *)(a1 + 5) = v5;
    }
    while ( 1 )
    {
      v6 = v4[5];
      if ( v6 == (_DWORD)v5 )
      {
        if ( v4 == &dword_13A08 || v4[6] >= SHIDWORD(v5) )
          goto LABEL_12;
      }
      else if ( v4 == &dword_13A08 || v6 >= (int)v5 )
      {
LABEL_12:
        *a1 = v4;
        v7 = (int *)v4[1];
        a1[1] = v7;
        *v7 = (int)a1;
        v4[1] = (int)a1;
        return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_13980);
      }
      v4 = (int *)*v4;
    }
  }
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_13980);
}
// 13A08: using guessed type int dword_13A08;

//----- (0000AF14) --------------------------------------------------------
int __fastcall ril_event_del(int a1)
{
  unsigned int v2; // r1

  pthread_mutex_lock((pthread_mutex_t *)&unk_13980);
  v2 = *(_DWORD *)(a1 + 12);
  if ( v2 < 8 )
    sub_AF50(a1, v2);
  return j_pthread_mutex_unlock((pthread_mutex_t *)&unk_13980);
}

//----- (0000AF50) --------------------------------------------------------
int __fastcall sub_AF50(int a1, int a2)
{
  int v3; // r5
  int result; // r0
  int i; // r1
  int v6; // r2
  int v7; // r2

  v3 = 0;
  dword_13A58[a2] = 0;
  *(_DWORD *)(a1 + 12) = -1;
  _FD_CLR_chk(*(_DWORD *)(a1 + 8), &unk_13988, 128);
  result = *(_DWORD *)(a1 + 8) + 1;
  if ( result == dword_13A78 )
  {
    for ( i = 0; i != 8; ++i )
    {
      v6 = dword_13A58[i];
      if ( v6 )
      {
        v7 = *(_DWORD *)(v6 + 8);
        if ( v7 > v3 )
          v3 = v7;
      }
    }
    result = v3 + 1;
    dword_13A78 = v3 + 1;
  }
  return result;
}
// 32E4: using guessed type int __fastcall _FD_CLR_chk(_DWORD, _DWORD, _DWORD);
// 13A58: using guessed type _DWORD dword_13A58[2];
// 13A78: using guessed type int dword_13A78;

//----- (0000AFB8) --------------------------------------------------------
int ril_event_loop(void)
{
  int *v0; // r4
  struct timeval *timeout; // r5
  int v2; // r1
  __suseconds_t tv_usec; // r2
  _DWORD *v4; // r4
  __suseconds_t v5; // t1
  int v6; // r0
  int v7; // r1
  int v8; // r5
  int v9; // r4
  __time_t tv_sec; // r0
  __suseconds_t v11; // r1
  __time_t v12; // r2
  bool v13; // cc
  __int64 v14; // r2
  bool v15; // zf
  int v16; // r7
  int v17; // r4
  int *v18; // r0
  int v19; // r1
  __int64 v20; // kr00_8
  _DWORD *v22; // [sp+Ch] [bp-BCh]
  int v23; // [sp+10h] [bp-B8h] BYREF
  int v24; // [sp+14h] [bp-B4h]
  struct timeval v25; // [sp+18h] [bp-B0h] BYREF
  fd_set v26; // [sp+20h] [bp-A8h] BYREF
  int v27; // [sp+A0h] [bp-28h]

  v22 = (_DWORD *)_errno();
  do
  {
    while ( 1 )
    {
      qmemcpy(&v26, &unk_13988, sizeof(v26));
      v0 = (int *)dword_13A08;
      timeout = 0;
      gettimeofday(&v25, 0);
      if ( v0 == &dword_13A08 )
        goto LABEL_12;
      v2 = v0[5];
      if ( v2 == v25.tv_sec )
      {
        tv_usec = v25.tv_usec;
        v5 = v0[6];
        v4 = v0 + 6;
        if ( v5 > v25.tv_usec )
          goto LABEL_8;
      }
      else if ( v2 > v25.tv_sec )
      {
        tv_usec = v25.tv_usec;
        v4 = v0 + 6;
LABEL_8:
        v6 = v2 - v25.tv_sec;
        v23 = v2 - v25.tv_sec;
        v7 = *v4 - tv_usec;
        v24 = v7;
        if ( v7 <= -1 )
        {
          v24 = v7 + 1000000;
          v23 = v6 - 1;
        }
        goto LABEL_11;
      }
      v23 = 0;
      v24 = 0;
LABEL_11:
      timeout = (struct timeval *)&v23;
LABEL_12:
      v8 = select(dword_13A78, &v26, 0, 0, timeout);
      if ( v8 <= -1 )
        break;
      pthread_mutex_lock((pthread_mutex_t *)&unk_13980);
      v9 = dword_13A08;
      gettimeofday(&v25, 0);
      if ( (int *)v9 != &dword_13A08 )
      {
        tv_sec = v25.tv_sec;
        v11 = v25.tv_usec;
        do
        {
          v12 = *(_DWORD *)(v9 + 20);
          v13 = tv_sec <= v12;
          if ( tv_sec == v12 )
            v13 = v11 <= *(_DWORD *)(v9 + 24);
          if ( v13 )
            break;
          v14 = *(_QWORD *)v9;
          v15 = *(_DWORD *)v9 == (_DWORD)&dword_13A08;
          *(_DWORD *)(v14 + 4) = HIDWORD(v14);
          **(_DWORD **)(v9 + 4) = *(_DWORD *)v9;
          *(_DWORD *)v9 = &dword_13A30;
          *(_DWORD *)(v9 + 4) = 0;
          HIDWORD(v14) = dword_13A34;
          *(_DWORD *)(v9 + 4) = dword_13A34;
          *(_DWORD *)HIDWORD(v14) = v9;
          dword_13A34 = v9;
          v9 = v14;
        }
        while ( !v15 );
      }
      pthread_mutex_unlock((pthread_mutex_t *)&unk_13980);
      pthread_mutex_lock((pthread_mutex_t *)&unk_13980);
      if ( v8 >= 1 )
      {
        v16 = 0;
        do
        {
          v17 = dword_13A58[v16];
          if ( v17 && _FD_ISSET_chk(*(_DWORD *)(v17 + 8), &v26, 128) )
          {
            *(_DWORD *)v17 = &dword_13A30;
            v18 = (int *)dword_13A34;
            *(_DWORD *)(v17 + 4) = dword_13A34;
            *v18 = v17;
            dword_13A34 = v17;
            if ( !*(_BYTE *)(v17 + 16) )
              sub_AF50(v17, v16);
            --v8;
          }
          ++v16;
        }
        while ( v16 <= 7 && v8 > 0 );
      }
      pthread_mutex_unlock((pthread_mutex_t *)&unk_13980);
      v19 = dword_13A30;
      if ( (int *)dword_13A30 != &dword_13A30 )
      {
        do
        {
          v20 = *(_QWORD *)v19;
          *(_DWORD *)(*(_DWORD *)v19 + 4) = *(_DWORD *)(v19 + 4);
          **(_DWORD **)(v19 + 4) = *(_DWORD *)v19;
          *(_DWORD *)v19 = 0;
          *(_DWORD *)(v19 + 4) = 0;
          (*(void (__fastcall **)(_DWORD, _DWORD, _DWORD))(v19 + 28))(*(_DWORD *)(v19 + 8), 0, *(_DWORD *)(v19 + 32));
          v19 = v20;
        }
        while ( (int *)v20 != &dword_13A30 );
      }
    }
  }
  while ( *v22 == 4 );
  _android_log_buf_print(1, 6, "RILC", "ril_event: select error (%d)", *v22);
  return _stack_chk_guard - v27;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);
// 2F78: using guessed type int _errno(void);
// 3308: using guessed type int __fastcall _FD_ISSET_chk(_DWORD, _DWORD, _DWORD);
// 13A08: using guessed type int dword_13A08;
// 13A30: using guessed type int dword_13A30;
// 13A34: using guessed type int dword_13A34;
// 13A58: using guessed type _DWORD dword_13A58[2];
// 13A78: using guessed type int dword_13A78;

//----- (0000B19C) --------------------------------------------------------
void __fastcall ProductFeature::ProductFeature(ProductFeature *this)
{
  *(_DWORD *)this = &off_12C00;
}
// 12C00: using guessed type void *;

//----- (0000B1B0) --------------------------------------------------------
int __fastcall ProductFeature::Init(ProductFeature *this, const char *a2)
{
  void *Instance; // r0

  Instance = ProductFeature::GetInstance(this);
  (*(void (__fastcall **)(void *, ProductFeature *))(*(_DWORD *)Instance + 8))(Instance, this);
  return 1;
}

//----- (0000B1C4) --------------------------------------------------------
int __fastcall ProductFeature::Custom_SupportOnly5Mode(ProductFeature *this)
{
  const char *v1; // r0

  v1 = (const char *)(*(int (__fastcall **)(ProductFeature *))(*(_DWORD *)this + 12))(this);
  _android_log_buf_print(1, 4, 0, "[%s]  ProductFeature::SupportOnly5Mode == %s", v1, "true");
  return 1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B1F4) --------------------------------------------------------
int __fastcall ProductFeature::Custom_SupportOnlyBasicPreferredNetworkType(ProductFeature *this)
{
  const char *v1; // r0

  v1 = (const char *)(*(int (__fastcall **)(ProductFeature *))(*(_DWORD *)this + 12))(this);
  _android_log_buf_print(1, 4, 0, "[%s]  ProductFeature::SupportOnlyBasicPreferredNetworkType == %s", v1, "true");
  return 1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B224) --------------------------------------------------------
int __fastcall ProductFeature::Function_SendDebugTraceOffAtBootup(ProductFeature *this)
{
  const char *v1; // r0

  v1 = (const char *)(*(int (__fastcall **)(ProductFeature *))(*(_DWORD *)this + 12))(this);
  _android_log_buf_print(1, 4, 0, "[%s]  ProductFeature::SendDebugTraceOffAtBootup == %s", v1, "false");
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B254) --------------------------------------------------------
int __fastcall ProductFeature::Function_GetFastDormancyInfo(
        ProductFeature *this,
        unsigned __int8 *a2,
        unsigned __int8 *a3,
        unsigned __int8 *a4,
        unsigned __int8 *a5)
{
  const char *v8; // r0

  *a2 = 0;
  *a3 = 0;
  *a4 = 0;
  *a5 = 0;
  v8 = (const char *)(*(int (__fastcall **)(ProductFeature *))(*(_DWORD *)this + 12))(this);
  _android_log_buf_print(
    1,
    4,
    0,
    "[%s]  ProductFeature::SupportFastDormancyInfo == %s(%d,%d,%d,%d [.5sec/unit]))",
    v8,
    "false",
    *a2,
    *a3,
    *a4,
    *a5);
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B2A0) --------------------------------------------------------
int __fastcall ProductFeature::Function_RilResetByCrashExitInUserMode(ProductFeature *this)
{
  const char *v1; // r0

  v1 = (const char *)(*(int (__fastcall **)(ProductFeature *))(*(_DWORD *)this + 12))(this);
  _android_log_buf_print(1, 4, 0, "[%s]  ProductFeature::RilResetByModemCrash == %s", v1, "false");
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B2D0) --------------------------------------------------------
int __fastcall ProductFeature::Function_DeviceBasedCwInCs(ProductFeature *this)
{
  const char *v1; // r0

  v1 = (const char *)(*(int (__fastcall **)(ProductFeature *))(*(_DWORD *)this + 12))(this);
  _android_log_buf_print(1, 4, 0, "[%s]  ProductFeature::DeviceBasedCWinCS == %s", v1, "true");
  return 1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B300) --------------------------------------------------------
const char *sub_B300()
{
  return "/efs/";
}

//----- (0000B30C) --------------------------------------------------------
const char *sub_B30C()
{
  return "/efs/backup/nv_protected";
}

//----- (0000B318) --------------------------------------------------------
void *__fastcall ProductFeature::GetInstance(ProductFeature *this)
{
  return &instance;
}

//----- (0000B324) --------------------------------------------------------
void __fastcall CustomProductFeature::CustomProductFeature(CustomProductFeature *this)
{
  _DWORD *v1; // r0

  ProductFeature::ProductFeature(this);
  *v1 = &off_12C2C;
}
// B332: variable 'v1' is possibly undefined
// 12C2C: using guessed type void *;

//----- (0000B340) --------------------------------------------------------
void __fastcall CustomProductFeature::~CustomProductFeature(
        CustomProductFeature *this,
        const unsigned __int8 *a2,
        unsigned int a3,
        const unsigned int *a4)
{
  void *v4; // r0
  unsigned int v5; // [sp+0h] [bp-8h]
  void *v6; // [sp+4h] [bp-4h]

  v4 = (void *)android::nullParcelReleaseFunction(this, a2, a3, a4, v5, v6);
  operator delete(v4);
}
// B342: variable 'v5' is possibly undefined
// B342: variable 'v6' is possibly undefined

//----- (0000B350) --------------------------------------------------------
int __fastcall CustomProductFeature::CustomInit(CustomProductFeature *this, const char *a2)
{
  const char *v2; // r0

  v2 = "unknown";
  if ( a2 )
    v2 = a2;
  _android_log_buf_print(1, 4, 0, "<%s> [%s] CustomProductFeature::Init", v2, "m86");
  return 1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B388) --------------------------------------------------------
const char *__fastcall CustomProductFeature::GetProductName(CustomProductFeature *this)
{
  return "m86";
}

//----- (0000B394) --------------------------------------------------------
int __fastcall CustomProductFeature::Custom_SaveImeiToProperty(CustomProductFeature *this)
{
  _android_log_buf_print(1, 4, 0, "[%s] CustomProductFeature::SaveImeiToProperty == %s", "m86", "true");
  return 1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B3C4) --------------------------------------------------------
int __fastcall CustomProductFeature::Custom_ReturnCurrentPlmn(CustomProductFeature *this)
{
  _android_log_buf_print(1, 4, 0, "[%s] CustomProductFeature::ReturnCurrentPlmn == %s", "m86", "false");
  return 0;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B3F4) --------------------------------------------------------
int __fastcall CustomProductFeature::ModuleAudio_VolumeStartFrom1(CustomProductFeature *this)
{
  _android_log_buf_print(1, 4, 0, "[%s] CustomProductFeature::VolumeStartFrom1 == %s", "m86", "true");
  return 1;
}
// 2EF4: using guessed type int _android_log_buf_print(_DWORD, _DWORD, _DWORD, const char *, ...);

//----- (0000B424) --------------------------------------------------------
const char *sub_B424()
{
  return "/efs/nv_data/";
}

//----- (0000B430) --------------------------------------------------------
const char *sub_B430()
{
  return "/mnv/bak/nv_protected";
}

//----- (0000B43C) --------------------------------------------------------
unsigned int *__fastcall sub_B43C(unsigned int *result, int *a2, int *a3)
{
  unsigned int v3; // r3
  unsigned int v4; // t1
  int v5; // r12
  bool v6; // zf
  int v7; // r3
  int v8; // r12

  v3 = *result;
  if ( (*result & 0x80000000) == 0 )
  {
    *a2 = 1;
    v4 = result[1];
    ++result;
    *a3 = 4 * HIBYTE(v4) + 4;
    return result;
  }
  v5 = HIBYTE(v3) & 0xF;
  if ( v5 )
  {
    v6 = v5 == 3;
    if ( v5 != 3 )
      v6 = v5 == 1;
    if ( !v6 )
      return 0;
    v7 = 4 * BYTE2(v3) + 4;
    v8 = 2;
  }
  else
  {
    v8 = 1;
    v7 = 4;
  }
  *a3 = v7;
  *a2 = v8;
  return result;
}

//----- (0000B490) --------------------------------------------------------
int __fastcall sub_B490(int a1, int a2, unsigned int a3, unsigned int a4)
{
  unsigned int v6; // r11
  unsigned int v8; // r7
  int v9; // r10
  int v10; // r2
  unsigned int v11; // r1
  int result; // r0
  int v13; // r3
  int v14; // r2
  int v15; // r0
  int v16; // r1
  int v17; // r2
  int v18; // r1
  int v19; // r6
  int v20; // r2
  int v21; // r0
  int v22; // r1
  int v23; // r3
  int v24; // r0
  int v25; // r2
  int v26; // r0
  unsigned int v33; // r1
  unsigned int v34; // r0
  int v35; // r1
  unsigned int v36; // r0
  int v37; // [sp+0h] [bp-30h]
  int v38; // [sp+4h] [bp-2Ch] BYREF

  v6 = a3;
  if ( a3 >= a4 )
  {
LABEL_54:
    sub_BD80(a1, 14, &v38);
    sub_BDAE(a1, 15, v38);
    return 8;
  }
  v37 = 0;
  do
  {
    v8 = v6 + 1;
    v9 = *(unsigned __int8 *)(a2 + (v6 ^ 3));
    if ( (v9 & 0x80) == 0 )
    {
      sub_BD80(a1, 13, &v38);
      if ( (v9 & 0x40) != 0 )
        v10 = -4 - (unsigned __int8)(4 * v9) + v38;
      else
        v10 = 4 * v9 + v38 + 4;
LABEL_12:
      v38 = v10;
LABEL_13:
      sub_BDAE(a1, 13, v10);
LABEL_36:
      v6 = v8;
      continue;
    }
    v11 = v9 & 0xF0;
    result = 9;
    if ( v11 > 0xAF )
    {
      if ( v11 == 176 )
      {
        result = 9;
        v18 = 0;
        v19 = 0;
        switch ( *(_BYTE *)(a2 + (v6 ^ 3)) )
        {
          case 0xB0:
            goto LABEL_53;
          case 0xB1:
            if ( v8 >= a4 )
              return 9;
            v20 = *(unsigned __int8 *)(a2 + (v8 ^ 3));
            result = 9;
            if ( !*(_BYTE *)(a2 + (v8 ^ 3)) || (v20 & 0xF0) != 0 )
              return result;
            v21 = a1;
            v22 = 0;
            v23 = 0;
            goto LABEL_48;
          case 0xB2:
            break;
          case 0xB3:
            v23 = 1;
            v26 = *(unsigned __int8 *)(a2 + (v8 ^ 3));
            _R1 = v26 << 12;
            __asm { UXTB16.W        R1, R1 }
            v20 = ((v26 & 0xF) + 1) | _R1;
            v21 = a1;
            v22 = 1;
            goto LABEL_48;
          case 0xB4:
          case 0xB5:
          case 0xB6:
          case 0xB7:
            return result;
          default:
            v16 = 1;
            v13 = 1;
            v14 = ((v9 & 7) + 1) | 0x80000;
            v15 = a1;
            goto LABEL_35;
        }
        while ( v8 < a4 )
        {
          v24 = v8++ ^ 3;
          LOBYTE(v24) = *(_BYTE *)(a2 + v24);
          v25 = (v24 & 0x7F) << v18;
          v18 += 7;
          v19 |= v25;
          if ( (v24 & 0x80) == 0 )
          {
            sub_BD80(a1, 13, &v38);
            v10 = v38 + 4 * v19 + 516;
            goto LABEL_12;
          }
        }
        return 9;
      }
      if ( v11 != 192 )
      {
        if ( v11 != 208 )
          return result;
        if ( (v9 & 8) != 0 )
          return 9;
        v16 = 1;
        v14 = ((v9 & 7) + 1) | 0x80000;
        v15 = a1;
LABEL_34:
        v13 = 5;
        goto LABEL_35;
      }
      switch ( *(_BYTE *)(a2 + (v6 ^ 3)) )
      {
        case 0xC0:
        case 0xC1:
        case 0xC2:
        case 0xC3:
        case 0xC4:
        case 0xC5:
          v16 = 3;
          v14 = ((v9 & 7) + 1) | 0xA0000;
          v15 = a1;
          goto LABEL_34;
        case 0xC6:
          v36 = *(unsigned __int8 *)(a2 + (v8 ^ 3));
          if ( (v36 & 0xF) + (v36 >> 4) > 0xF )
            return 9;
          v20 = ((v36 & 0xF) + 1) | (v36 >> 4 << 16);
          v21 = a1;
          v22 = 3;
          break;
        case 0xC7:
          if ( !*(_BYTE *)(a2 + (v8 ^ 3)) || *(unsigned __int8 *)(a2 + (v8 ^ 3)) >= 0x10u )
            return 9;
          goto LABEL_49;
        case 0xC8:
        case 0xC9:
          v33 = *(unsigned __int8 *)(a2 + (v8 ^ 3));
          v34 = v33 >> 4;
          if ( v9 == 200 )
            v34 = (v33 >> 4) | 0x10;
          v35 = v33 & 0xF;
          if ( v34 + v35 > 0x1F )
            return 9;
          v20 = (v35 + 1) | (v34 << 16);
          v21 = a1;
          v22 = 1;
          break;
        default:
          return 9;
      }
      v23 = 5;
LABEL_48:
      sub_B870(v21, v22, v20, v23);
    }
    else
    {
      if ( v11 != 128 )
      {
        if ( v11 == 144 )
        {
          if ( (v9 & 0xD | 2) == 15 )
            return 9;
          sub_BD80(a1, v9 & 0xF, &v38);
          v10 = v38;
          goto LABEL_13;
        }
        if ( v11 != 160 )
          return result;
        v13 = 0;
        v14 = ((16 << ((v9 & 7) + 1)) - 16) | (v9 << 11) & 0x4000;
        v15 = a1;
        v16 = 0;
LABEL_35:
        sub_B870(v15, v16, v14, v13);
        goto LABEL_36;
      }
      if ( v8 >= a4 )
        return 9;
      v17 = (unsigned __int16)((_WORD)v9 << 12) | (16 * *(unsigned __int8 *)(a2 + (v8 ^ 3)));
      if ( !v17 )
        return 9;
      sub_B870(a1, 0, v17, 0);
      v37 |= (unsigned __int16)(((_WORD)v9 << 12) & 0x8000) >> 15;
    }
LABEL_49:
    v6 += 2;
  }
  while ( v6 < a4 );
LABEL_53:
  if ( (v37 & 1) == 0 )
    goto LABEL_54;
  return 8;
}

//----- (0000B7D4) --------------------------------------------------------
int __fastcall sub_B7D4(int a1, int a2, unsigned int a3, int a4, int *a5)
{
  int result; // r0
  int v8; // r2
  int v9; // r0
  int v10; // r1
  __int64 v11; // r2
  int v12; // r1

  switch ( a2 )
  {
    case 0:
      result = 2;
      if ( a3 > 0xF || a4 )
        return result;
      v8 = *a5;
      v9 = a1;
      v10 = a3;
      goto LABEL_11;
    case 1:
      if ( a4 == 5 )
      {
        if ( a3 <= 0x1F )
          goto LABEL_19;
        return 2;
      }
      if ( a4 != 1 || a3 > 0xF )
        return 2;
      sub_BE90(a1);
LABEL_19:
      v11 = *(_QWORD *)a5;
      v12 = a3 + 256;
LABEL_20:
      result = sub_BE22(a1, v12, v11, SHIDWORD(v11));
LABEL_21:
      if ( result )
        return 2;
      return result;
    case 3:
      result = 2;
      if ( a3 > 0x1F || a4 != 5 )
        return result;
      v11 = *(_QWORD *)a5;
      v12 = a3 + 112;
      goto LABEL_20;
    case 4:
      result = 2;
      if ( a3 > 3 || a4 )
        return result;
      v8 = *a5;
      v10 = a3 + 192;
      v9 = a1;
LABEL_11:
      result = sub_BDAE(v9, v10, v8);
      goto LABEL_21;
    default:
      sub_BBEC(
        "_Unwind_VRS_Result _Unwind_VRS_Set(_Unwind_Context *, _Unwind_VRS_RegClass, uint32_t, _Unwind_VRS_DataRepresentation, void *)",
        837,
        "unsupported register class");
  }
}

//----- (0000B870) --------------------------------------------------------
int __fastcall sub_B870(int a1, int a2, unsigned int a3, int a4)
{
  char v8; // r4
  unsigned int i; // r7
  int *v10; // r0
  int v11; // r0
  char v12; // r1
  char v13; // r2
  int result; // r0
  unsigned int v15; // r4
  unsigned int v16; // r6
  int *v17; // r0
  int v18; // r2
  int v19; // r0
  int v20; // r2
  int v21[2]; // [sp+8h] [bp-30h] BYREF
  int *v22; // [sp+10h] [bp-28h] BYREF

  switch ( a2 )
  {
    case 0:
    case 4:
      if ( a4 || sub_BD80(a1, 13, v21) )
        return 2;
      v8 = 0;
      for ( i = 0; i < 0x10; ++i )
      {
        if ( ((1 << i) & a3) != 0 )
        {
          v10 = (int *)v21[0];
          v21[0] += 4;
          v22 = (int *)*v10;
          v11 = sub_B7D4(a1, a2, i, 0, (int *)&v22);
          v12 = 0;
          v13 = 0;
          if ( i == 13 )
            v12 = 1;
          if ( !a2 )
            v13 = 1;
          if ( v11 )
            return 2;
          v8 |= v13 & v12;
        }
      }
      if ( (v8 & 1) != 0 )
        return 0;
      v20 = v21[0];
      goto LABEL_26;
    case 1:
    case 3:
      if ( (a4 | 4) != 5 || sub_BD80(a1, 13, &v22) )
        return 2;
      if ( !(_WORD)a3 )
        goto LABEL_21;
      v15 = HIWORD(a3);
      v16 = HIWORD(a3) + (unsigned __int16)a3;
      break;
    default:
      sub_BBEC(
        "_Unwind_VRS_Result _Unwind_VRS_Pop(_Unwind_Context *, _Unwind_VRS_RegClass, uint32_t, _Unwind_VRS_DataRepresentation)",
        971,
        "unsupported register class");
  }
  do
  {
    v17 = v22++;
    v18 = *v17;
    v22 = v17 + 2;
    v19 = v17[1];
    v21[0] = v18;
    v21[1] = v19;
    if ( sub_B7D4(a1, a2, v15, a4, v21) )
      return 2;
    ++v15;
  }
  while ( v15 < v16 );
LABEL_21:
  if ( a4 == 1 )
    v20 = (int)++v22;
  else
    v20 = (int)v22;
LABEL_26:
  result = sub_BDAE(a1, 13, v20);
  if ( result )
    return 2;
  return result;
}

//----- (0000B9AC) --------------------------------------------------------
int __fastcall sub_B9AC(int a1, int a2, int a3)
{
  return sub_B9B4(a2, a3);
}

//----- (0000B9B4) --------------------------------------------------------
int __fastcall sub_B9B4(int a1, int a2)
{
  int result; // r0
  int v5; // r1
  char v6[8]; // [sp+4h] [bp-3Ch] BYREF
  _DWORD *v7; // [sp+Ch] [bp-34h]

  sub_BE60(a2, (int)v6);
  if ( (*(_BYTE *)(a1 + 80) & 1) == 0 && *v7 )
    return 9;
  v5 = sub_BE5A(a2);
  result = 9;
  if ( v5 == 1 )
    return 8;
  return result;
}
// B9B4: using guessed type char var_3C[8];

//----- (0000BA10) --------------------------------------------------------
int __fastcall sub_BA10(int a1, int a2, int a3)
{
  return sub_B9B4(a2, a3);
}

//----- (0000BA18) --------------------------------------------------------
int __fastcall sub_BA18(int a1, int a2, int a3)
{
  return sub_B9B4(a2, a3);
}

//----- (0000BA20) --------------------------------------------------------
int __fastcall sub_BA20(int *a1, int a2, int a3, int a4)
{
  int v5; // r5
  int (__fastcall *v6)(_DWORD, int *, char *); // r3
  int v7; // r0
  int v9[3]; // [sp+0h] [bp-8A0h] BYREF
  int (__fastcall *v10)(_DWORD, int *, char *); // [sp+Ch] [bp-894h]
  int v11; // [sp+14h] [bp-88Ch]
  int v12; // [sp+20h] [bp-880h]
  _DWORD v13[256]; // [sp+28h] [bp-878h] BYREF
  char v14[1120]; // [sp+428h] [bp-478h] BYREF

  sub_BCB4(v13, a2, a3, a4, v9[0]);
  a1[3] = 0;
  sub_BD3C((int)v14, v13);
  if ( sub_BE60((int)v14, (int)v9) )
    return 3;
  v5 = 3;
  while ( 1 )
  {
    v6 = v10;
    if ( v10 )
    {
      a1[18] = v9[0];
      a1[19] = v12;
      a1[20] = v11;
      v7 = v6(0, a1, v14);
      if ( v7 != 8 )
        break;
    }
    if ( sub_BE60((int)v14, (int)v9) )
      return 3;
  }
  if ( v7 == 6 )
  {
    sub_BACC(v13, a1, 0);
    return 2;
  }
  else if ( v7 == 9 )
  {
    return 9;
  }
  return v5;
}
// BA20: using guessed type _DWORD var_878[256];

//----- (0000BACC) --------------------------------------------------------
int __fastcall sub_BACC(const void *a1, int *a2, char a3)
{
  int i; // r6
  int v6; // r7
  int (__fastcall *v7)(int, int *, char *); // r3
  int v8; // r0
  int v10; // [sp+0h] [bp-4B8h] BYREF
  int v11[3]; // [sp+4h] [bp-4B4h] BYREF
  int (__fastcall *v12)(int, int *, char *); // [sp+10h] [bp-4A8h]
  int v13; // [sp+18h] [bp-4A0h]
  int v14; // [sp+24h] [bp-494h]
  int v15; // [sp+2Ch] [bp-48Ch] BYREF
  char v16[1124]; // [sp+30h] [bp-488h] BYREF
  int v17; // [sp+494h] [bp-24h]

  sub_BD3C((int)v16, a1);
  for ( i = 1; ; --i )
  {
    v6 = 1;
    if ( (a3 & 1) != 0 )
    {
      v6 = 2;
      if ( !i )
      {
        sub_BDAE((int)v16, -1, a2[4]);
        a3 = 0;
      }
    }
    sub_BD80((int)v16, -2, &v15);
    if ( sub_BE60((int)v16, (int)v11) )
      break;
    v7 = v12;
    if ( v12 )
    {
      a2[18] = v11[0];
      a2[19] = v14;
      a2[20] = v13;
      v8 = v7(v6, a2, v16);
      if ( v8 == 7 )
      {
        sub_BD80((int)v16, -1, &v10);
        a2[4] = v10;
        sub_BE7E((int)v16);
        return _stack_chk_guard - v17;
      }
      if ( v8 != 8 )
      {
        if ( v8 == 9 )
          abort();
        return _stack_chk_guard - v17;
      }
      if ( v15 == a2[8] )
        sub_BBEC(
          "_Unwind_Reason_Code unwind_phase2(unw_context_t *, _Unwind_Exception *, bool)",
          653,
          "during phase1 personality function said it would stop here, but now in phase2 it did not stop here");
    }
  }
  return _stack_chk_guard - v17;
}
// BACC: using guessed type int var_4B4[3];

//----- (0000BBB8) --------------------------------------------------------
void __fastcall __noreturn sub_BBB8(int *a1, int a2, int a3, int a4)
{
  int v5[260]; // [sp+0h] [bp-410h] BYREF

  sub_BCB4(v5, a2, a3, a4, v5[0]);
  sub_BACC(v5, a1, 1);
  sub_BBEC("void _Unwind_Resume(_Unwind_Exception *)", 753, "_Unwind_Resume() can't return");
}

//----- (0000BBEC) --------------------------------------------------------
void __fastcall __noreturn sub_BBEC(const char *a1, int a2, const char *a3)
{
  fprintf(stderr, "libunwind: %s %s:%d - %s\n", a1, "external/libunwind_llvm/src/Unwind-EHABI.cpp", a2, a3);
  abort();
}

//----- (0000BC1C) --------------------------------------------------------
int __fastcall sub_BC1C(int a1)
{
  int v1; // r1
  int result; // r0
  char v3[8]; // [sp+4h] [bp-34h] BYREF
  int v4; // [sp+Ch] [bp-2Ch]

  v1 = sub_BE60(a1, (int)v3);
  result = v4;
  if ( v1 )
    return 0;
  return result;
}
// BC1C: using guessed type char var_34[8];

//----- (0000BC58) --------------------------------------------------------
int __fastcall sub_BC58(int a1)
{
  int v1; // r1
  int result; // r0
  int v3[10]; // [sp+4h] [bp-34h] BYREF

  v1 = sub_BE60(a1, (int)v3);
  result = v3[0];
  if ( v1 )
    return 0;
  return result;
}
// BC58: using guessed type int var_34[10];

//----- (0000BCA0) --------------------------------------------------------
int __fastcall sub_BCA0(int a1, int a2)
{
  int v2; // r0
  int v3; // r1

  v2 = sub_BE5A(a2);
  v3 = 9;
  if ( v2 == 1 )
    return 0;
  return v3;
}

//----- (0000BCB4) --------------------------------------------------------
int __fastcall sub_BCB4(_DWORD *a1, int a2, int a3, int a4, int a5)
{
  int v5; // r4
  int v6; // r5
  int v7; // r6
  int v8; // r7
  int v9; // r8
  int v10; // r9
  int v11; // r10
  int v12; // r11
  int v13; // r12
  int v14; // lr

  *a1 = a1;
  a1[1] = a2;
  a1[2] = a3;
  a1[3] = a4;
  a1[4] = v5;
  a1[5] = v6;
  a1[6] = v7;
  a1[7] = v8;
  a1[8] = v9;
  a1[9] = v10;
  a1[10] = v11;
  a1[11] = v12;
  a1[12] = v13;
  a1[13] = &a5;
  a1[14] = v14;
  a1[15] = v14;
  return 0;
}
// BCB4: variable 'v5' is possibly undefined
// BCB4: variable 'v6' is possibly undefined
// BCB4: variable 'v7' is possibly undefined
// BCB4: variable 'v8' is possibly undefined
// BCB4: variable 'v9' is possibly undefined
// BCB4: variable 'v10' is possibly undefined
// BCB4: variable 'v11' is possibly undefined
// BCB4: variable 'v12' is possibly undefined
// BCB4: variable 'v13' is possibly undefined
// BCBC: variable 'v14' is possibly undefined

//----- (0000BCCC) --------------------------------------------------------
_QWORD *__fastcall sub_BCCC(_QWORD *result)
{
  __int64 v1; // d0
  __int64 v2; // d1
  __int64 v3; // d2
  __int64 v4; // d3
  __int64 v5; // d4
  __int64 v6; // d5
  __int64 v7; // d6
  __int64 v8; // d7
  __int64 v9; // d8
  __int64 v10; // d9
  __int64 v11; // d10
  __int64 v12; // d11
  __int64 v13; // d12
  __int64 v14; // d13
  __int64 v15; // d14
  __int64 v16; // d15

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}
// BCCC: variable 'v1' is possibly undefined
// BCCC: variable 'v2' is possibly undefined
// BCCC: variable 'v3' is possibly undefined
// BCCC: variable 'v4' is possibly undefined
// BCCC: variable 'v5' is possibly undefined
// BCCC: variable 'v6' is possibly undefined
// BCCC: variable 'v7' is possibly undefined
// BCCC: variable 'v8' is possibly undefined
// BCCC: variable 'v9' is possibly undefined
// BCCC: variable 'v10' is possibly undefined
// BCCC: variable 'v11' is possibly undefined
// BCCC: variable 'v12' is possibly undefined
// BCCC: variable 'v13' is possibly undefined
// BCCC: variable 'v14' is possibly undefined
// BCCC: variable 'v15' is possibly undefined
// BCCC: variable 'v16' is possibly undefined

//----- (0000BCD4) --------------------------------------------------------
_QWORD *__fastcall sub_BCD4(_QWORD *result)
{
  __int64 v1; // d0
  __int64 v2; // d1
  __int64 v3; // d2
  __int64 v4; // d3
  __int64 v5; // d4
  __int64 v6; // d5
  __int64 v7; // d6
  __int64 v8; // d7
  __int64 v9; // d8
  __int64 v10; // d9
  __int64 v11; // d10
  __int64 v12; // d11
  __int64 v13; // d12
  __int64 v14; // d13
  __int64 v15; // d14
  __int64 v16; // d15

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}
// BCD4: variable 'v1' is possibly undefined
// BCD4: variable 'v2' is possibly undefined
// BCD4: variable 'v3' is possibly undefined
// BCD4: variable 'v4' is possibly undefined
// BCD4: variable 'v5' is possibly undefined
// BCD4: variable 'v6' is possibly undefined
// BCD4: variable 'v7' is possibly undefined
// BCD4: variable 'v8' is possibly undefined
// BCD4: variable 'v9' is possibly undefined
// BCD4: variable 'v10' is possibly undefined
// BCD4: variable 'v11' is possibly undefined
// BCD4: variable 'v12' is possibly undefined
// BCD4: variable 'v13' is possibly undefined
// BCD4: variable 'v14' is possibly undefined
// BCD4: variable 'v15' is possibly undefined
// BCD4: variable 'v16' is possibly undefined

//----- (0000BCDC) --------------------------------------------------------
_QWORD *__fastcall sub_BCDC(_QWORD *result)
{
  __int64 v1; // d16
  __int64 v2; // d17
  __int64 v3; // d18
  __int64 v4; // d19
  __int64 v5; // d20
  __int64 v6; // d21
  __int64 v7; // d22
  __int64 v8; // d23
  __int64 v9; // d24
  __int64 v10; // d25
  __int64 v11; // d26
  __int64 v12; // d27
  __int64 v13; // d28
  __int64 v14; // d29
  __int64 v15; // d30
  __int64 v16; // d31

  *result = v1;
  result[1] = v2;
  result[2] = v3;
  result[3] = v4;
  result[4] = v5;
  result[5] = v6;
  result[6] = v7;
  result[7] = v8;
  result[8] = v9;
  result[9] = v10;
  result[10] = v11;
  result[11] = v12;
  result[12] = v13;
  result[13] = v14;
  result[14] = v15;
  result[15] = v16;
  return result;
}
// BCDC: variable 'v1' is possibly undefined
// BCDC: variable 'v2' is possibly undefined
// BCDC: variable 'v3' is possibly undefined
// BCDC: variable 'v4' is possibly undefined
// BCDC: variable 'v5' is possibly undefined
// BCDC: variable 'v6' is possibly undefined
// BCDC: variable 'v7' is possibly undefined
// BCDC: variable 'v8' is possibly undefined
// BCDC: variable 'v9' is possibly undefined
// BCDC: variable 'v10' is possibly undefined
// BCDC: variable 'v11' is possibly undefined
// BCDC: variable 'v12' is possibly undefined
// BCDC: variable 'v13' is possibly undefined
// BCDC: variable 'v14' is possibly undefined
// BCDC: variable 'v15' is possibly undefined
// BCDC: variable 'v16' is possibly undefined

//----- (0000BCE4) --------------------------------------------------------
void sub_BCE4()
{
  __asm
  {
    STCL            p1, c0, [R0],#8
    STCL            p1, c1, [R0],#8
    STCL            p1, c2, [R0],#8
    STCL            p1, c3, [R0],#8
    STCL            p1, c4, [R0],#8
    STCL            p1, c5, [R0],#8
    STCL            p1, c6, [R0],#8
    STCL            p1, c7, [R0],#8
    STCL            p1, c8, [R0],#8
    STCL            p1, c9, [R0],#8
    STCL            p1, c10, [R0],#8
    STCL            p1, c11, [R0],#8
    STCL            p1, c12, [R0],#8
    STCL            p1, c13, [R0],#8
    STCL            p1, c14, [R0],#8
    STCL            p1, c15, [R0],#8
  }
}

//----- (0000BD28) --------------------------------------------------------
void sub_BD28()
{
  __asm
  {
    STC2            p1, c8, [R0],#4
    STC2            p1, c9, [R0],#4
    STC2            p1, c10, [R0],#4
    STC2            p1, c11, [R0],#4
  }
}

//----- (0000BD3C) --------------------------------------------------------
int __fastcall sub_BD3C(int a1, const void *a2)
{
  *(_DWORD *)a1 = &off_12C58;
  *(_DWORD *)(a1 + 4) = &unk_13A80;
  *(_BYTE *)(a1 + 76) = 0;
  *(_DWORD *)(a1 + 72) = 0;
  qmemcpy((void *)(a1 + 8), a2, 0x40u);
  memset((void *)(a1 + 80), 0, 0x1C2u);
  sub_C258((int *)a1, 0);
  return 0;
}
// 12C58: using guessed type void *;

//----- (0000BD80) --------------------------------------------------------
int __fastcall sub_BD80(int a1, int a2, _DWORD *a3)
{
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 8))(a1) != 1 )
    return -6542;
  *a3 = (*(int (__fastcall **)(int, int))(*(_DWORD *)a1 + 12))(a1, a2);
  return 0;
}

//----- (0000BDAE) --------------------------------------------------------
int __fastcall sub_BDAE(int a1, int a2, int a3)
{
  int v6; // r5

  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 8))(a1) != 1 )
    return -6542;
  (*(void (__fastcall **)(int, int, int))(*(_DWORD *)a1 + 16))(a1, a2, a3);
  if ( a2 != -1 )
    return 0;
  v6 = 0;
  (*(void (__fastcall **)(int, _DWORD))(*(_DWORD *)a1 + 52))(a1, 0);
  return v6;
}

//----- (0000BDF2) --------------------------------------------------------
int __fastcall sub_BDF2(int a1, int a2, _QWORD *a3)
{
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 20))(a1) != 1 )
    return -6542;
  *a3 = ((__int64 (__fastcall *)(int, int))*(_DWORD *)(*(_DWORD *)a1 + 24))(a1, a2);
  return 0;
}

//----- (0000BE22) --------------------------------------------------------
int __fastcall sub_BE22(int a1, int a2, int a3, int a4)
{
  if ( (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 20))(a1) != 1 )
    return -6542;
  (*(void (__fastcall **)(int, int, int, int))(*(_DWORD *)a1 + 28))(a1, a2, a3, a4);
  return 0;
}

//----- (0000BE5A) --------------------------------------------------------
int __fastcall sub_BE5A(int a1)
{
  return (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 32))(a1);
}

//----- (0000BE60) --------------------------------------------------------
int __fastcall sub_BE60(int a1, int a2)
{
  int result; // r0

  (*(void (__fastcall **)(int, int))(*(_DWORD *)a1 + 36))(a1, a2);
  result = 0;
  if ( !*(_DWORD *)(a2 + 4) )
    return -6549;
  return result;
}

//----- (0000BE7E) --------------------------------------------------------
int __fastcall sub_BE7E(int a1)
{
  (*(void (__fastcall **)(int))(*(_DWORD *)a1 + 40))(a1);
  return -6540;
}

//----- (0000BE90) --------------------------------------------------------
int __fastcall sub_BE90(int a1)
{
  return (*(int (__fastcall **)(int))(*(_DWORD *)a1 + 60))(a1);
}

//----- (0000BE96) --------------------------------------------------------
int __fastcall sub_BE96(int a1, int a2)
{
  int v2; // r2
  bool v3; // zf
  int v4; // r0
  unsigned int v5; // r1

  v2 = 0;
  v3 = (a2 & 0xFFFFFFFC) == 192;
  v4 = 0;
  v5 = a2 - 16;
  if ( v3 )
    v4 = 1;
  if ( v5 > 0xFFFFFFED )
    v2 = 1;
  return v4 | v2;
}

//----- (0000BEB8) --------------------------------------------------------
int __fastcall sub_BEB8(int a1, int a2)
{
  int v4; // r0

  if ( a2 > 12 )
  {
    if ( a2 != 15 )
    {
      if ( a2 == 14 )
      {
        v4 = a1 + 64;
        return *(_DWORD *)v4;
      }
      if ( a2 != 13 )
        goto LABEL_11;
LABEL_9:
      v4 = a1 + 60;
      return *(_DWORD *)v4;
    }
    goto LABEL_8;
  }
  if ( a2 == -2 )
    goto LABEL_9;
  if ( a2 == -1 )
  {
LABEL_8:
    v4 = a1 + 68;
    return *(_DWORD *)v4;
  }
LABEL_11:
  if ( (unsigned int)a2 > 0xC )
  {
    if ( (a2 & 0xFFFFFFFC) != 192 )
      sub_C2D8(
        "uint32_t libunwind::Registers_arm::getRegister(int)",
        "external/libunwind_llvm/src/Registers.hpp",
        1452,
        "unsupported arm register");
    if ( !*(_BYTE *)(a1 + 76) )
    {
      *(_BYTE *)(a1 + 76) = 1;
      sub_BD28();
    }
    v4 = a1 + 4 * a2 - 296;
  }
  else
  {
    v4 = a1 + 4 * a2 + 8;
  }
  return *(_DWORD *)v4;
}

//----- (0000BF44) --------------------------------------------------------
int __fastcall sub_BF44(int result, int a2, int a3)
{
  int v5; // r5

  v5 = result;
  if ( a2 <= 12 )
  {
    if ( a2 == -2 )
      goto LABEL_9;
    if ( a2 != -1 )
      goto LABEL_11;
LABEL_8:
    *(_DWORD *)(result + 68) = a3;
    return result;
  }
  switch ( a2 )
  {
    case 15:
      goto LABEL_8;
    case 14:
      *(_DWORD *)(result + 64) = a3;
      return result;
    case 13:
LABEL_9:
      *(_DWORD *)(result + 60) = a3;
      return result;
  }
LABEL_11:
  if ( (unsigned int)a2 > 0xC )
  {
    if ( (a2 & 0xFFFFFFFC) != 192 )
      sub_C2D8(
        "void libunwind::Registers_arm::setRegister(int, uint32_t)",
        "external/libunwind_llvm/src/Registers.hpp",
        1471,
        "unsupported arm register");
    if ( !*(_BYTE *)(result + 76) )
    {
      *(_BYTE *)(result + 76) = 1;
      sub_BD28();
    }
    result = v5 + 4 * a2;
    *(_DWORD *)(result - 296) = a3;
  }
  else
  {
    result += 4 * a2;
    *(_DWORD *)(result + 8) = a3;
  }
  return result;
}

//----- (0000BFD0) --------------------------------------------------------
int __fastcall sub_BFD0(int a1, int a2)
{
  int v2; // r2
  bool v3; // zf
  int v4; // r0
  unsigned int v5; // r1

  v2 = 0;
  v3 = (a2 & 0xFFFFFFF0) == 112;
  v4 = 0;
  v5 = a2 & 0xFFFFFFE0;
  if ( v3 )
    v4 = 1;
  if ( v5 == 256 )
    v2 = 1;
  return v4 | v2;
}

//----- (0000BFF4) --------------------------------------------------------
__int64 __fastcall sub_BFF4(int a1, int a2)
{
  unsigned int v4; // r0
  _QWORD *v5; // r0
  int v6; // r0

  v4 = a2 & 0xFFFFFFF0;
  if ( (a2 & 0xFFFFFFF0) == 112 )
  {
    if ( !*(_BYTE *)(a1 + 75) )
    {
      *(_BYTE *)(a1 + 75) = 1;
      sub_BCE4();
    }
    v6 = a1 + 8 * a2 - 552;
  }
  else if ( v4 == 272 )
  {
    if ( !*(_BYTE *)(a1 + 74) )
    {
      *(_BYTE *)(a1 + 74) = 1;
      sub_BCDC((_QWORD *)(a1 + 216));
    }
    v6 = a1 + 8 * a2 - 1960;
  }
  else
  {
    if ( v4 != 256 )
      sub_C2D8(
        "unw_fpreg_t libunwind::Registers_arm::getFloatRegister(int)",
        "external/libunwind_llvm/src/Registers.hpp",
        1673,
        "Unknown ARM float register");
    if ( !*(_BYTE *)(a1 + 73) )
    {
      *(_BYTE *)(a1 + 73) = 1;
      v5 = (_QWORD *)(a1 + 80);
      if ( *(_BYTE *)(a1 + 72) )
        sub_BCD4(v5);
      else
        sub_BCCC(v5);
    }
    v6 = a1 + 8 * a2 - 1968;
  }
  return *(_QWORD *)v6;
}

//----- (0000C098) --------------------------------------------------------
int __fastcall sub_C098(int a1, int a2, int a3, int a4)
{
  unsigned int v6; // r0
  _QWORD *v9; // r0
  int result; // r0
  int v11; // r1

  v6 = a2 & 0xFFFFFFF0;
  if ( (a2 & 0xFFFFFFF0) == 112 )
  {
    if ( !*(_BYTE *)(a1 + 75) )
    {
      *(_BYTE *)(a1 + 75) = 1;
      sub_BCE4();
    }
    result = a1 + 8 * a2;
    *(_DWORD *)(result - 548) = a4;
    LOWORD(v11) = -552;
  }
  else if ( v6 == 272 )
  {
    if ( !*(_BYTE *)(a1 + 74) )
    {
      *(_BYTE *)(a1 + 74) = 1;
      sub_BCDC((_QWORD *)(a1 + 216));
    }
    result = a1 + 8 * a2;
    *(_DWORD *)(result - 1956) = a4;
    LOWORD(v11) = -1960;
  }
  else
  {
    if ( v6 != 256 )
      sub_C2D8(
        "void libunwind::Registers_arm::setFloatRegister(int, unw_fpreg_t)",
        "external/libunwind_llvm/src/Registers.hpp",
        1700,
        "Unknown ARM float register");
    if ( !*(_BYTE *)(a1 + 73) )
    {
      *(_BYTE *)(a1 + 73) = 1;
      v9 = (_QWORD *)(a1 + 80);
      if ( *(_BYTE *)(a1 + 72) )
        sub_BCD4(v9);
      else
        sub_BCCC(v9);
    }
    result = a1 + 8 * a2;
    *(_DWORD *)(result - 1964) = a4;
    LOWORD(v11) = -1968;
  }
  HIWORD(v11) = -1;
  *(_DWORD *)(result + v11) = a3;
  return result;
}

//----- (0000C164) --------------------------------------------------------
int __fastcall sub_C164(_DWORD *a1)
{
  int result; // r0
  __int64 v3; // kr00_8
  int v4; // r0

  if ( *((_BYTE *)a1 + 528) )
    return 0;
  result = sub_C304((int)a1);
  if ( result != 1 )
    return result;
  (*(void (__fastcall **)(_DWORD *, int))(*a1 + 52))(a1, 1);
  if ( *((_BYTE *)a1 + 528) )
    return 0;
  if ( a1[126] )
  {
    v3 = *(_QWORD *)(*a1 + 12);
    v4 = ((int (__fastcall *)(_DWORD *, int))v3)(a1, -2);
    ((void (__fastcall *)(_DWORD *, int, int))HIDWORD(v3))(a1, -2, a1[126] + v4);
  }
  return 1;
}

//----- (0000C1B4) --------------------------------------------------------
_DWORD *__fastcall sub_C1B4(int a1, _DWORD *a2)
{
  int *v2; // r0
  _DWORD *result; // r0
  int v4; // r2
  int v5; // r3
  int v6; // r4
  int v7; // r12
  int v8; // lr
  _DWORD *v9; // r1
  int v10; // r3
  int v11; // r4
  int v12; // r12
  int v13; // lr

  v2 = (int *)(a1 + 488);
  v4 = *v2;
  v5 = v2[1];
  v6 = v2[2];
  v7 = v2[3];
  v8 = v2[4];
  result = v2 + 5;
  *a2 = v4;
  a2[1] = v5;
  a2[2] = v6;
  a2[3] = v7;
  a2[4] = v8;
  v9 = a2 + 5;
  v10 = result[1];
  v11 = result[2];
  v12 = result[3];
  v13 = result[4];
  *v9 = *result;
  v9[1] = v10;
  v9[2] = v11;
  v9[3] = v12;
  v9[4] = v13;
  return result;
}

//----- (0000C1CC) --------------------------------------------------------
int __fastcall sub_C1CC(int a1)
{
  int v1; // r4

  v1 = a1 + 8;
  sub_C358(a1 + 8);
  return sub_CB18(v1);
}

//----- (0000C1E2) --------------------------------------------------------
int __fastcall sub_C1E2(int a1)
{
  return *(unsigned __int8 *)(a1 + 529);
}

//----- (0000C1E8) --------------------------------------------------------
int __fastcall sub_C1E8(int a1, int a2, int a3, _DWORD *a4)
{
  int v7; // r7
  char v9[8]; // [sp+8h] [bp-28h] BYREF
  const char *v10; // [sp+10h] [bp-20h]
  int v11; // [sp+14h] [bp-1Ch]

  v7 = (*(int (__fastcall **)(int, int))(*(_DWORD *)a1 + 12))(a1, -1);
  if ( !dladdr(v7, v9) || !v10 )
    return 0;
  _snprintf_chk(a2, a3, 0, -1, "%s", v10);
  *a4 = v7 - v11;
  return 1;
}
// 2FB4: using guessed type int _snprintf_chk(_DWORD, _DWORD, _DWORD, _DWORD, const char *, ...);
// 33C8: using guessed type int __fastcall dladdr(_DWORD, _DWORD);
// C1E8: using guessed type char var_28[8];

//----- (0000C258) --------------------------------------------------------
int __fastcall sub_C258(int *a1, int a2)
{
  int v4; // r5
  int v6[2]; // [sp+0h] [bp-20h] BYREF
  int v7[6]; // [sp+8h] [bp-18h] BYREF

  v4 = (*(int (__fastcall **)(int *, int))(*a1 + 12))(a1, -1) & 0xFFFFFFFE;
  v7[0] = 0;
  if ( a2 )
    --v4;
  v6[0] = _gnu_Unwind_Find_exidx(v4, v7);
  v6[1] = v7[0];
  if ( !v6[0] || !v7[0] || !sub_C3B0(a1, v4, v6) )
    *((_BYTE *)a1 + 528) = 1;
  return _stack_chk_guard - v7[1];
}
// 33D4: using guessed type int __fastcall _gnu_Unwind_Find_exidx(_DWORD, _DWORD);

//----- (0000C2CE) --------------------------------------------------------
int __fastcall sub_C2CE(int result)
{
  *(_BYTE *)(result + 72) = 1;
  return result;
}

//----- (0000C2D8) --------------------------------------------------------
void __fastcall __noreturn sub_C2D8(const char *a1, const char *a2, int a3, const char *a4)
{
  fprintf(stderr, "libunwind: %s %s:%d - %s\n", a1, a2, a3, a4);
  abort();
}

//----- (0000C304) --------------------------------------------------------
int __fastcall sub_C304(int a1)
{
  int v2; // r4
  unsigned int *v3; // r0
  unsigned int v5; // [sp+4h] [bp-1Ch] BYREF
  unsigned int v6; // [sp+8h] [bp-18h] BYREF

  v2 = 0;
  v5 = 0;
  v6 = 0;
  v3 = sub_B43C(*(unsigned int **)(a1 + 520), (int *)&v5, (int *)&v6);
  if ( sub_B490(a1, (int)v3, v5, v6) == 8 )
    return 1;
  return v2;
}

//----- (0000C358) --------------------------------------------------------
_DWORD *__fastcall sub_C358(int a1)
{
  int v2; // r0
  _DWORD *result; // r0

  if ( *(_BYTE *)(a1 + 65) )
  {
    if ( *(_BYTE *)(a1 + 64) )
      sub_CA00();
    else
      sub_C9F8();
  }
  if ( (unsigned __int8)*(_WORD *)(a1 + 66) )
  {
    sub_CA08();
    v2 = *(unsigned __int8 *)(a1 + 67);
  }
  else
  {
    v2 = HIBYTE(*(unsigned __int16 *)(a1 + 66));
  }
  if ( v2 )
    sub_CA10((int *)(a1 + 336));
  result = (_DWORD *)*(unsigned __int8 *)(a1 + 68);
  if ( *(_BYTE *)(a1 + 68) )
    return sub_CB28((int *)(a1 + 464));
  return result;
}

//----- (0000C3B0) --------------------------------------------------------
int __fastcall sub_C3B0(int *a1, int a2, _DWORD *a3)
{
  int v4; // r5
  int v5; // r6
  char *v6; // r1
  int *v7; // r0
  int v8; // r5
  int v9; // r7
  unsigned int v10; // r6
  int v11; // r12
  int (__fastcall *v12)(int, int, int); // lr
  int v13; // r9
  int v14; // r6
  int v15; // r6
  int v16; // r3
  int v17; // r7
  int v19[3]; // [sp+14h] [bp-34h] BYREF
  int v20; // [sp+20h] [bp-28h] BYREF

  v4 = 0;
  v20 = a2;
  v5 = a3[1];
  sub_C554(v19, 0, a1[1], a3, v5, a1[1], (int)a3, &v20);
  if ( !v19[0] || v19[0] == v5 )
    return v4;
  v6 = (char *)(*(_DWORD *)v19[2] + 8 * v19[0]);
  v7 = (int *)(v6 - 4);
  v8 = *(_DWORD *)v6;
  if ( v6 == &byte_4 )
    return 0;
  v9 = *v7;
  if ( *v7 == 1 )
    return 0;
  if ( v9 < 0 )
  {
    v11 = 1;
    goto LABEL_11;
  }
  v10 = (2 * v9) & 0x80000000 | v9;
  v9 = *(int *)((char *)v7 + v10);
  v7 = (int *)((char *)v7 + v10);
  if ( v9 <= -1 )
  {
    v11 = 0;
LABEL_11:
    v14 = HIBYTE(v9) & 0xF;
    if ( v14 == 2 )
    {
      v12 = sub_BA18;
      v15 = 1;
    }
    else
    {
      if ( v14 != 1 )
      {
        if ( v14 )
          sub_C2D8(
            "bool libunwind::UnwindCursor<libunwind::LocalAddressSpace, libunwind::Registers_arm>::getInfoFromEHABISectio"
            "n(pint_t, const libunwind::UnwindInfoSections &) [A = libunwind::LocalAddressSpace, R = libunwind::Registers_arm]",
            "external/libunwind_llvm/src/UnwindCursor.hpp",
            776,
            "unknown personality routine");
        v13 = (int)(v7 + 1);
        if ( v11 )
          v13 = 0;
        v12 = sub_B9AC;
        goto LABEL_17;
      }
      v12 = sub_BA10;
      v15 = 0;
    }
    v16 = BYTE2(v9);
    v17 = v16;
    if ( v16 )
      v17 = 1;
    if ( (v17 & v11) == 1 )
      sub_C2D8(
        "bool libunwind::UnwindCursor<libunwind::LocalAddressSpace, libunwind::Registers_arm>::getInfoFromEHABISection(pi"
        "nt_t, const libunwind::UnwindInfoSections &) [A = libunwind::LocalAddressSpace, R = libunwind::Registers_arm]",
        "external/libunwind_llvm/src/UnwindCursor.hpp",
        783,
        "index inlined table detected but pr function requires extra words");
    v13 = (int)&v7[v16 + 1];
    goto LABEL_24;
  }
  v11 = 0;
  v12 = (int (__fastcall *)(int, int, int))((char *)v7 + (v9 | (2 * v9) & 0x80000000));
  v13 = (int)&v7[HIBYTE(v7[1]) + 2];
LABEL_17:
  v15 = 0;
LABEL_24:
  a1[122] = (int)&v6[((2 * *((_DWORD *)v6 - 2)) & 0x80000000 | *((_DWORD *)v6 - 2)) - 8];
  a1[123] = (int)&v6[v8 | (2 * v8) & 0x80000000];
  v4 = 1;
  a1[130] = (int)v7;
  a1[124] = v13;
  a1[125] = (int)v12;
  if ( v15 )
    v15 = 2;
  if ( v11 )
    v15 = 1;
  a1[127] = v15;
  return v4;
}
// 4: using guessed type char byte_4;

//----- (0000C554) --------------------------------------------------------
_DWORD *__fastcall sub_C554(_DWORD *a1, int a2, int a3, _DWORD *a4, int a5, int a6, int a7, _DWORD *a8)
{
  unsigned int v8; // r4
  unsigned int v9; // r5
  int v10; // r6

  v8 = a5 - a2;
  while ( 1 )
  {
    v9 = v8;
    if ( !v8 )
      break;
    v10 = a2 + (v8 >> 1);
    v8 >>= 1;
    if ( *a8 >= *a4 + 8 * v10 + ((2 * *(_DWORD *)(*a4 + 8 * v10)) & 0x80000000 | *(_DWORD *)(*a4 + 8 * v10)) )
    {
      v8 = v9 - 1 - v8;
      a2 = v10 + 1;
    }
  }
  *a1 = a2;
  a1[1] = a3;
  a1[2] = a4;
  return a1 + 3;
}

//----- (0000C9E4) --------------------------------------------------------
int __fastcall sub_C9E4(int a1)
{
  return (*(int (__fastcall **)(_DWORD, _DWORD, _DWORD, _DWORD))(a1 + 60))(
           *(_DWORD *)a1,
           *(_DWORD *)(a1 + 4),
           *(_DWORD *)(a1 + 8),
           *(_DWORD *)(a1 + 12));
}

//----- (0000C9F8) --------------------------------------------------------
void sub_C9F8()
{
  ;
}

//----- (0000CA00) --------------------------------------------------------
void sub_CA00()
{
  ;
}

//----- (0000CA08) --------------------------------------------------------
void sub_CA08()
{
  ;
}

//----- (0000CA10) --------------------------------------------------------
_DWORD *__fastcall sub_CA10(int *a1)
{
  int *v5; // r0
  _DWORD *result; // r0

  _T1 = *a1;
  v5 = a1 + 2;
  __asm { LDCL            p1, c0, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c1, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c2, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c3, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c4, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c5, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c6, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c7, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c8, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c9, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c10, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c11, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c12, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c13, [R0],#8 }
  _T1 = *v5;
  v5 += 2;
  __asm { LDCL            p1, c14, [R0],#8 }
  _T1 = *v5;
  result = v5 + 2;
  __asm { LDCL            p1, c15, [R0],#8 }
  return result;
}

//----- (0000CA54) --------------------------------------------------------
_DWORD *__fastcall sub_CA54(int *a1)
{
  int *v5; // r0
  _DWORD *result; // r0

  _T1 = *a1;
  v5 = a1 + 1;
  __asm { LDC2            p1, c8, [R0],#4 }
  _T1 = *v5++;
  __asm { LDC2            p1, c9, [R0],#4 }
  _T1 = *v5++;
  __asm { LDC2            p1, c10, [R0],#4 }
  _T1 = *v5;
  result = v5 + 1;
  __asm { LDC2            p1, c11, [R0],#4 }
  return result;
}

//----- (0000CA68) --------------------------------------------------------
// attributes: thunk
char *__fastcall j_strncpy(char *dest, const char *src, size_t n)
{
  return strncpy(dest, src, n);
}

//----- (0000CA78) --------------------------------------------------------
// attributes: thunk
int j_acquire_wake_lock()
{
  return acquire_wake_lock();
}
// 3128: using guessed type int acquire_wake_lock(void);

//----- (0000CA88) --------------------------------------------------------
// attributes: thunk
int __fastcall j_pthread_mutex_unlock(pthread_mutex_t *mutex)
{
  return pthread_mutex_unlock(mutex);
}

//----- (0000CA98) --------------------------------------------------------
// attributes: thunk
int __fastcall j_android::RIL_onExtUnsolicitedResponse(int a1, int a2, int a3, int a4)
{
  return android::RIL_onExtUnsolicitedResponse(a1, a2, a3, a4);
}

//----- (0000CAA8) --------------------------------------------------------
// attributes: thunk
int j_release_wake_lock()
{
  return release_wake_lock();
}
// 3134: using guessed type int release_wake_lock(void);

//----- (0000CAB8) --------------------------------------------------------
// attributes: thunk
int __fastcall j_j_RIL_onRequestComplete(int a1, int a2, int a3, int a4)
{
  return j_RIL_onRequestComplete(a1, a2, a3, a4);
}

//----- (0000CAC8) --------------------------------------------------------
// attributes: thunk
int __fastcall android::Parcel::writeInt32(android::Parcel *this, int a2)
{
  return _ZN7android6Parcel10writeInt32Ei(this, a2);
}

//----- (0000CAD8) --------------------------------------------------------
// attributes: thunk
void __fastcall j_free(void *ptr)
{
  free(ptr);
}

//----- (0000CAE8) --------------------------------------------------------
// attributes: thunk
void __fastcall operator delete(void *a1)
{
  _ZdlPv(a1);
}

//----- (0000CAF8) --------------------------------------------------------
// attributes: thunk
int __fastcall j_android::nullParcelReleaseFunction(
        android *this,
        const unsigned __int8 *a2,
        unsigned int a3,
        const unsigned int *a4,
        unsigned int a5,
        void *a6)
{
  return android::nullParcelReleaseFunction(this, a2, a3, a4, a5, a6);
}

//----- (0000CB08) --------------------------------------------------------
// attributes: thunk
int __fastcall j___cxa_atexit(void (__fastcall *lpfunc)(void *), void *obj, void *lpdso_handle)
{
  return _cxa_atexit(lpfunc, obj, lpdso_handle);
}

//----- (0000CB18) --------------------------------------------------------
// attributes: thunk
int __fastcall sub_CB18(int a1)
{
  return sub_C9E4(a1);
}

//----- (0000CB28) --------------------------------------------------------
// attributes: thunk
_DWORD *__fastcall sub_CB28(int *a1)
{
  return sub_CA54(a1);
}

// nfuncs=417 queued=227 decompiled=227 lumina nreq=0 worse=0 better=0
// ALL OK, 227 function(s) have been successfully decompiled
